var wijmo;(function(e){(function(e){var t=function(){function t(){}return t.getBounds=function(t){if(!t||t.length===0)return null;var n=Number.MAX_VALUE,r=n,i=-Number.MAX_VALUE,s=i;return $.each(t,function(e,t){t.x<n&&(n=t.x),t.x>i&&(i=t.x),t.y<r&&(r=t.y),t.y>s&&(s=t.y)}),new e.Rectangle(new e.Point(n,r),new e.Size(i-n,s-r))},t.getListBounds=function(e){var n,r;return $.each(e,function(e,i){r=t.getBounds(i),r&&(n=r.union(n))}),n},t.getPoints=function(t){if(!t)return null;var n=[],r=t.length;r-=r%2;for(var i=0;i<r;i++){var s=new e.Point(t[i],t[++i]);n.push(s)}return n},t.sinh=function(e){return(Math.exp(e)-Math.exp(-e))/2},t.createListPath=function(e,n){var r="",i;return $.each(e,function(e,n){i=t.createPath(n),i&&(r+=i)}),r},t.createPath=function(e,t){if(!e)return null;var n=e.length,r,i=null,s;if(n>0){s=e[0],i="M"+s.x+" "+s.y;for(var o=1;o<n;o++)r=e[o],i+="L"+r.x+" "+r.y;t&&(i+="Z")}return i},t.getPointData=function(t){var n=null;return t&&t.length>0&&(n=new e.Point(t[0],t[1])),n},t.getLineData=function(e){var n=null;return e&&e.length>0&&(n=[],$.each(e,function(e,r){n.push(t.getPointData(r))})),n},t.getPolygonData=function(e){var n=null;return e&&e.length>0&&(n=[],$.each(e,function(e,r){n.push(t.getLineData(r))})),n},t}();e.Utils=t})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(e){var t=function(){function e(e,t){var n=this;if(typeof e=="number")n.x=e,n.y=t;else{var r=e;n.x=r.x,n.y=r.y}}return e.prototype.offset=function(t,n){return new e(this.x+t,this.y+n)},e.prototype.scale=function(t,n){return new e(this.x*t,this.y*n)},e.empty=new e(0,0),e}();e.Point=t;var n=function(){function e(e,t){var n=this;if(typeof e=="number")n.width=e,n.height=t;else{var r=e;n.width=r.width,n.height=r.height}}return e.prototype.scale=function(t,n){return new e(this.width*t,this.height*n)},e.empty=new e(0,0),e}();e.Size=n;var r=function(){function e(e,t){this.location=e,this.size=t}return e.prototype.intersect=function(r){var i=this,s=Math.max(i.location.x,r.location.x),o=Math.min(i.location.x+i.size.width,r.location.x+r.size.width),u=Math.max(i.location.y,r.location.y),a=Math.min(i.location.y+i.size.height,r.location.y+r.size.height);return o>=s&&a>=u?new e(new t(s,u),new n(o-s,a-u)):null},e.prototype.isEmpty=function(){var e=this;return e.size.width===0&&e.size.height===0&&e.location.x===0&&e.location.y===0},e.prototype.getRight=function(){return this.location.x+this.size.width},e.prototype.getBottom=function(){return this.location.y+this.size.height},e.prototype.intersectsWith=function(e){if(!e)return!1;var t=this;return t.location.x<=e.location.x+e.size.width&&t.location.x+t.size.width>=e.location.x&&t.location.y<=e.location.y+e.size.height&&t.location.y+t.size.height>=e.location.y},e.prototype.union=function(r){var i=this;if(!r)return $.extend(!0,{},i);var s=Math.min(i.location.x,r.location.x),o=Math.min(i.location.y,r.location.y),u=Math.max(i.location.x+i.size.width,r.location.x+r.size.width),a=Math.max(i.location.y+i.size.height,r.location.y+r.size.height);return new e(new t(s,o),new n(u-s,a-o))},e.empty=new e(t.empty,n.empty),e}();e.Rectangle=r;var i=function(){function e(){this.fill="transparent",this.fillOpacity=1,this.stroke="#000",this.strokeOpacity=1,this.strokeWidth=1,this.strokeDashArray="",this.strokeLineCap=0,this.strokeLineJoin=0,this.strokeMiterLimit=1}return e.prototype.createElement=function(e){return null},e.prototype._setElementAttributes=function(e){var t=this;e&&(e.attr({fill:t.fill,"fill-opacity":t.fillOpacity,stroke:t.stroke,"stroke-opacity":t.strokeOpacity,"stroke-width":t.strokeWidth,"stroke-dasharray":t.strokeDashArray,"stroke-linecap":f[t.strokeLineCap]||f[0],"stroke-linejoin":l[t.strokeLineJoin]||l[0],"stroke-miterlimit":t.strokeMiterLimit}),t.fill==="transparent"&&e.attr("fill","white").attr("fill-opacity","0"))},e}();e.Shape=i;var s=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.createElement=function(t){t.setStart();var n=this,r=e.Utils.createPath(n.points,!1),i;return r&&t.path(r),i=t.setFinish(),n._setElementAttributes(i),i},n}(i);e.Polyline=s;var o=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.createElement=function(t){t.setStart();var n=this,r,i;return n.points&&$.each(n.points,function(n,i){r=e.Utils.createPath(i,!1),r&&t.path(r)}),i=t.setFinish(),n._setElementAttributes(i),i},n}(i);e.MultiPolyline=o;var u=function(t){function n(){t.apply(this,arguments),this.fillRule=0,this.pointsList=[]}return __extends(n,t),n.prototype.createElement=function(t){t.setStart();var n=this,r=e.Utils.createListPath(n.pointsList,!0),i;return r&&t.path(r),i=t.setFinish(),n._setElementAttributes(i),i},n}(i);e.Polygon=u,function(e){e[e.evenOdd=0]="evenOdd",e[e.nonezero=1]="nonezero"}(e.FillRule||(e.FillRule={}));var a=e.FillRule;(function(e){e[e.butt=0]="butt",e[e.square=1]="square",e[e.round=2]="round"})(e.PenLineCap||(e.PenLineCap={}));var f=e.PenLineCap;(function(e){e[e.bevel=0]="bevel",e[e.round=1]="round",e[e.miter=2]="miter"})(e.PenLineJoin||(e.PenLineJoin={}));var l=e.PenLineJoin})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=function(){function t(){}return t.createClippedLines=function(e,n){var r=[],i=e.length;for(var s=1;s<i;s++){var o=t._clipSegmentCS(n,[e[s-1],e[s]]);o&&r.push(o)}return r},t._clipSegmentCS=function(e,n){var r=!1,i=n[0],s=n[1],o=t._csCode(e,i),u=t._csCode(e,s),a=s.x-i.x,f=s.y-i.y,l=0,c=0;if(a!==0)c=f/a;else if(f===0)return o===0&&u===0?[i,s]:null;f!==0&&(l=a/f);var h=4,p,d;do{if((o&u)>0)break;if(o===0&&u===0){r=!0;break}o===0&&(p=o,o=u,u=p,d=i.x,i.x=s.x,s.x=d,d=i.y,i.y=s.y,s.y=d);if((o&1)>0){var v=e.location.x;i.y+=c*(v-i.x),i.x=v}else if((o&2)>0){var m=e.location.x+e.size.width;i.y+=c*(m-i.x),i.x=m}else if((o&4)>0){var g=e.location.y+e.size.height;i.x+=l*(g-i.y),i.y=g}else if((o&8)>0){var y=e.location.y;i.x+=l*(y-i.y),i.y=y}o=t._csCode(e,i)}while(--h>=0);return r?[i,s]:null},t.clipPolygon=function(n,r){var i=n.length;if(i<2)return null;var s=[];for(var o=0;o<i;o++)s.push(n[o]);var u=r.location.x,a=r.location.y,f=u+r.size.width,l=a+r.size.height;return s=t._clipPolygonByLine(s,new e.Point(u,a),new e.Point(f,a)),s=t._clipPolygonByLine(s,new e.Point(f,a),new e.Point(f,l)),s=t._clipPolygonByLine(s,new e.Point(f,l),new e.Point(u,l)),s=t._clipPolygonByLine(s,new e.Point(u,l),new e.Point(u,a)),s},t.clipPolygonList=function(e,n){var r=[];return $.each(e,function(e,i){r.push(t.clipPolygon(i,n))}),r},t._clipPolygonByLine=function(e,t,n){var r=[],i=e.length;if(i>0){var s=e[i-1];for(var o=0;o<i;o++){var u=e[o];this._inside(u,t,n)?this._inside(s,t,n)?r.push(u):(r.push(this._intersect(s,u,t,n)),r.push(u)):this._inside(s,t,n)&&r.push(this._intersect(s,u,t,n)),s=u}}return r},t._inside=function(e,t,n){return n.x>t.x&&e.y>=t.y?!0:n.x<t.x&&e.y<=t.y?!0:n.y>t.y&&e.x<=n.x?!0:n.y<t.y&&e.x>=n.x?!0:!1},t._intersect=function(t,n,r,i){var s=new e.Point(0,0);return r.y===i.y?(s.y=r.y,s.x=t.x+(r.y-t.y)*(n.x-t.x)/(n.y-t.y)):(s.x=r.x,s.y=t.y+(r.x-t.x)*(n.y-t.y)/(n.x-t.x)),s},t._csCode=function(e,t){var n=0,r=e.location.x,i=e.location.y,s=r+e.size.width,o=i+e.size.height;return t.x<r?++n:t.x>s&&(n+=2),t.y>o?n+=4:t.y<i&&(n+=8),n},t}();e.ClippingEngine=t})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=function(){function t(){}return t.prototype.project=function(t){return new e.Point((t.x+180)/360,(1-Math.log(Math.tan(t.y*Math.PI/180)+1/Math.cos(t.y*Math.PI/180))/Math.PI)/2)},t.prototype.unproject=function(t){var n=Math.PI-2*Math.PI*t.y;return new e.Point(t.x*360-180,180/Math.PI*Math.atan(.5*(Math.exp(n)-Math.exp(-n))))},t}();e.MercatorProjection=t})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=function(){function t(t,n,r,i,s){this.element=t,this.center=n,this.zoom=r,this.tileWidth=i,this.tileHeight=s;var o=this,u,a;o._updateSize(),o._projection=new e.MercatorProjection,u=o.logicToGeographic(new e.Point(0,0)),a=o.logicToGeographic(new e.Point(1,1)),o.minLongitude=u.x,o.maxLongitude=a.x,o.minLatitude=a.y,o.maxLatitude=u.y}return t.prototype._updateSize=function(){var t=this,n=t.element;t._size=new e.Size(n.width(),n.height())},t.prototype.viewToGeographic=function(e){var t=this;return t.logicToGeographic(t.viewToLogic(e))},t.prototype.geographicToView=function(e){var t=this;return t.logicToView(t.geographicToLogic(e))},t.prototype.viewToLogic=function(t){var n=this,r=n.getViewCenter(),i=n.getLogicCenter(),s=n.getFullMapSize(),o=(new e.Size(t.x-r.x,t.y-r.y)).scale(1/s.width,1/s.height);return n._rangeLogicPoint((new e.Point(i)).offset(o.width,o.height))},t.prototype.logicToView=function(t){var n=this,r=n._rangeLogicPoint(t),i=n.getViewCenter(),s=n.getLogicCenter(),o=n.getFullMapSize(),u=(new e.Size(r.x-s.x,r.y-s.y)).scale(o.width,o.height);return(new e.Point(i)).offset(u.width,u.height)},t.prototype.geographicToLogic=function(e){var t=this;return t._rangeLogicPoint(t._projection.project(e))},t.prototype.logicToGeographic=function(e){var t=this,n=t._rangeLogicPoint(e);return t._projection.unproject(n)},t.prototype.getViewSize=function(){return this._size},t.prototype.getLogicSize=function(){var t=this,n=t.getViewSize(),r=t.getFullMapSize();return(new e.Size(n)).scale(1/r.width,1/r.height)},t.prototype.getViewCenter=function(){var t=this,n=t._size;return(new e.Point(n.width,n.height)).scale(.5,.5)},t.prototype.getLogicCenter=function(){var e=this;return e.geographicToLogic(e.center)},t.prototype.getFullMapSize=function(){var t=this;return(new e.Size(t.tileWidth,t.tileHeight)).scale(Math.pow(2,t.zoom),Math.pow(2,t.zoom))},t.prototype.distance=function(e,t){var n=6371e3,r=(t.y-e.y)*(Math.PI/180),i=(t.x-e.x)*(Math.PI/180),s=Math.sin(r*.5)*Math.sin(r*.5)+Math.cos(e.y*(Math.PI/180))*Math.cos(t.y*(Math.PI/180))*Math.sin(i*.5)*Math.sin(i*.5),o=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return n*o},t.prototype._rangeLogicPoint=function(e){var t=0,n=.9999999999;return e.x<t&&(e.x=t),e.y<t&&(e.y=t),e.x>n&&(e.x=n),e.y>n&&(e.y=n),e},t}();e.CoordConverter=t})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery;t.cultureMapping={en:"en-US",zh:"zh-Hans",ja:"ja-JP"};var r=function(){function t(){this.tileWidth=256,this.tileHeight=256,this.minZoom=1,this.maxZoom=19,this._uriFormat="",this._subdomains=["0","1","2","3","4","5","6","7"]}return t.prototype.getUrl=function(e,t,n){var r=this,i=r._subdomains[(n*Math.pow(2,e)+t)%r._subdomains.length];return r._uriFormat.replace("{subdomain}",i).replace("{quadkey}",r._getQuadkey(e,t,n)).replace("{culture}",r._getCulture())},t.prototype._getQuadkey=function(e,t,n){var r="",i=[0,2,1,3];for(var s=e;s>0;--s)r+=i[t>>s-1<<1&2|n>>s-1&1];return r},t.prototype._getCulture=function(){var t=n("body").attr("lang"),r=n("html").attr("lang"),i=t||r||"en";return e.maps.cultureMapping[i]||"en-US"},t}(),i=function(e){function t(){e.apply(this,arguments),this._uriFormat="http://ecn.t{subdomain}.tiles.virtualearth.net/tiles/r{quadkey}.jpeg?g=2889&mkt={culture}&shading=hill"}return __extends(t,e),t}(r),s=function(e){function t(){e.apply(this,arguments),this._uriFormat="http://ecn.t{subdomain}.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=2889&mkt={culture}&shading=hill"}return __extends(t,e),t}(r),o=function(e){function t(){e.apply(this,arguments),this._uriFormat="http://ecn.t{subdomain}.tiles.virtualearth.net/tiles/h{quadkey}.jpeg?g=2889&mkt={culture}&shading=hill"}return __extends(t,e),t}(r),u=function(){function e(){}return e.bingMapsRoadSource=new i,e.bingMapsAerialSource=new s,e.bingMapsHybridSource=new o,e}();t.MapSource=u})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery;(function(e){e[e.vector=0]="vector",e[e.items=1]="items",e[e.virtual=2]="virtual",e[e.custom=3]="custom"})(t.LayerType||(t.LayerType={}));var r=t.LayerType,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){e.prototype._create.call(this);var t=this;t._updating=!1,t._needUpdate=!1},t.prototype._createPaper=function(e,t){var r,i=Raphael(e,1,1);return n(i.canvas).css("overflow","visible"),this._resizePaper(i,t),i},t.prototype._resizePaper=function(e,t){Raphael.svg?n(e.canvas).css("width",t.width+"px").css("height",t.height+"px"):n(e.canvas).css("clip","rect(0px,"+t.width+"px,"+t.height+"px,0px)")},t.prototype._setOption=function(t,n){var r=this,i=this.options;if(i[t]!==n)switch(t){case"center":r._setCenter(n);return;case"zoom":r._setZoom(n);return}e.prototype._setOption.call(this,t,n)},t.prototype._setCenter=function(e){var t=this,n=t.options;if(n.center.x!==e.x||n.center.y!==e.y)n.center=e,t.update()},t.prototype._setZoom=function(e){var t=this,n=t.options;n.zoom!==e&&(n.zoom=e,t.update())},t.prototype._render=function(){},t.prototype.update=function(){var e=this,t=e.options;if(e._updating){e._needUpdate=!0;return}e._render()},t.prototype.beginUpdate=function(){this._updating=!0},t.prototype.endUpdate=function(){var e=this;e._updating=!1,e._needUpdate&&e.update()},t.prototype.refresh=function(){this.update()},t}(e.wijmoWidget);t.wijlayer=i;var s=function(){function e(){}return e}();t.wijlayer_options=s,i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijlayer",i.prototype)})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r="wijmo-wijmaps-vectorlayer-canvas",i="wijmo-wijmaps-layercontainer",s="wijmo-wijmaps-vectorlayer-shape",o="wijmo-wijmaps-vectorlayer-mark",u="wijmo-wijmaps-vectorlayer-marklabel",a="wijmoWijvectorlayerData",f;(function(e){e[e.placemark=0]="placemark",e[e.polyline=1]="polyline",e[e.polygon=2]="polygon"})(f||(f={}));var l;(function(e){e[e.hidden=0]="hidden",e[e.autoHide=1]="autoHide",e[e.visible=2]="visible"})(l||(l={}));var c;(function(e){e[e.center=0]="center",e[e.left=1]="left",e[e.right=2]="right",e[e.top=3]="top",e[e.bottom=4]="bottom"})(c||(c={}));var h=function(){function e(e){this.minSize=0,this.maxSize=0,this.minZoom=0,this.maxZoom=0;if(!e)return;var t=this;t.minSize=e.minSize||0,t.maxSize=e.maxSize||0,t.minZoom=e.minZoom||0,t.maxZoom=e.maxZoom||0}return e.prototype.isDefault=function(){return this.minSize===0&&this.maxSize===0&&this.minZoom===0&&this.maxZoom===0},e}();t.LOD=h;var p=function(){function e(){}return e}(),d=function(){function e(e,t,n,r,i,s){var o=this;o._scaleX=e,o._scaleY=t,o._offsetX=n,o._offsetY=r,o._extraX=i,o._extraY=s}return e.prototype.init=function(t){var n=this,r=t.converter,i=r.getViewSize(),s=r.getLogicSize(),o=t.center,u=i.width/s.width,a=r.geographicToLogic(o),f=.5*i.width-a.x*u,l=.5*i.height-a.y*u;n._ax=e.toRad*n._scaleX*u,n._bx=n._offsetX*u+f+n._extraX,n._ay=.5*n._scaleY*u,n._by=n._offsetY*u+l+n._extraY,n._converter=r},e.prototype.project=function(n){var r=this,i=r._converter;i&&(n.y>i.maxLatitude&&(n.y=i.maxLatitude),n.y<i.minLatitude&&(n.y=i.minLatitude));var s=Math.sin(n.y*e.toRad),o=n.x*r._ax+r._bx,u=Math.log((1+s)/(1-s))*r._ay+r._by;return new t.Point(o,u)},e.prototype.unproject=function(n){var r=this,i=(n.x-r._offsetX)*e.toDeg/r._scaleX,s=Math.atan(t.Utils.sinh((n.y-r._offsetY)/r._scaleY))*e.toDeg;return new t.Point(i,s)},e.toRad=Math.PI/180,e.toDeg=180/Math.PI,e}(),v=function(e){function h(){e.apply(this,arguments)}return __extends(h,e),h.prototype._create=function(){var t=this,i="."+s;t._proj=new d(1/(Math.PI*2),-1/(Math.PI*2),.5,.5,-h._offsetX,-h._offsetY),t._cache=null,t._needFullUpdateShape=!1,t._needDrawMarkShape=!1,t._container=n('<div class="'+r+'"></div>').appendTo(t.element).on("click."+t.widgetName,i,function(e){t._onItemMouseEvent("click",e,this)}).on("mousedown."+t.widgetName,i,function(e){t._onItemMouseEvent("mouseDown",e,this)}).on("mouseup."+t.widgetName,i,function(e){t._onItemMouseEvent("mouseUp",e,this)}).on("mousemove."+t.widgetName,i,function(e){t._onItemMouseEvent("mouseMove",e,this)}).on("mouseenter."+t.widgetName,i,function(e){t._onItemMouseEvent("mouseEnter",e,this)}).on("mouseleave."+t.widgetName,i,function(e){t._onItemMouseEvent("mouseLeave",e,this)}),e.prototype._create.call(this),t._setData(t.options.data)},h.prototype._setOption=function(t,n){var r=this,i=this.options;if(i[t]!==n)switch(t){case"dataType":r._setDataType(n);return;case"data":r._setData(n);return}e.prototype._setOption.call(this,t,n)},h.prototype._setDataType=function(e){var t=this;t.options.dataType=e},h.prototype._setData=function(e){var t=this,r=t.options;r.data=e,typeof e=="string"?t._prepareDataFromUri(e):n.isFunction(e)?t._applyData(e()):t._applyData(e)},h.prototype._prepareDataFromUri=function(e){var t=this;n.ajax({url:e,data:null,context:null,success:function(e){t._uriLoaded(e)},error:null,dataType:"json"})},h.prototype._uriLoaded=function(e){var t=this;t._applyData(e)},h.prototype._applyData=function(e){var t=this;if(t._data===e)return;t._data=e,t._applyDataInternal(e)},h.prototype._applyDataInternal=function(e){var t=this,n=t.options;n.dataType===H.wijJson?t._applyWijJsonData(e):n.dataType===H.geoJson&&t._applyGeoJsonData(e),t._needFullUpdateShape=!0,t.update()},h.prototype._applyWijJsonData=function(e){this._createVectors(e)},h.prototype._applyGeoJsonData=function(e){var t=this,n=b.create(e);n&&n.applyData(e,{}),t._vectorObj=n},h.prototype._createVectors=function(e){var t=this,r=this,i=new g;e&&e.vectors&&n.each(e.vectors,function(e,n){var r=t._createVector(n);if(r){var s=new y(r);s.applyData(n),i.addChild(s)}}),r._vectorObj=i},h.prototype._createVector=function(e){switch(f[e.type]){case 2:return new D;case 0:return new M;case 1:return new _}return null},h.prototype._render=function(){var t=this;e.prototype._render.call(this),t._updateShape()},h.prototype._createContainer=function(){var e=this,r=h._clipRect;e._destroyContainer(),e._shapeContainer=n('<div class="'+i+'"></div>'),e._paper=e._createPaper(e._shapeContainer[0],new t.Size(r.getRight(),r.getBottom())),e._group=e._paper.group(),e._placemarkContainer=n('<div class="'+i+"\" style='visibility:hidden;'></div>")},h.prototype._destroyContainer=function(){var e=this;e._paper&&e._paper.remove(),e._shapeContainer&&e._shapeContainer.off("."+e.widgetName).remove(),e._placemarkContainer&&e._placemarkContainer.off("."+e.widgetName).remove()},h.prototype._refreshPaper=function(){var e=this;e._container.css("left",h._offsetX+"px").css("top",h._offsetY+"px"),e._createContainer(),e._marks=[],e._vectorObj&&e._drawVectorObj(e._vectorObj),e._container.append(e._shapeContainer),e._container.append(e._placemarkContainer),e._arrangeMarks(),e._arrangeLabels(),e._placemarkContainer.css("visibility","visible")},h.prototype._drawVectorObj=function(e){var t=this;t._drawSingleVectorObj(e),e&&e.children&&e.children.length>0&&n.each(e.children,function(e,n){t._drawVectorObj(n)})},h.prototype._drawSingleVectorObj=function(e){var t=this,r,i,o,u={vector:e,shape:null};e.vectorItems&&(n.each(e.vectorItems,function(e,n){n.visible&&(r=n.getShape(),r&&(o=r.createElement(t._paper),o&&(t._group.push(o),i?o.forEach(function(e){i.push(e)}):i=o)),n instanceof M&&t._drawPlacemark(n,u))}),i&&(u.shape=i,n.each(i,function(e,t){n.wijraphael.addClass(n(t.node),s),n(t.node).data(a,u)}),t._onShapeCreated("shapeCreated",u)))},h.prototype._drawPlacemark=function(e,t){var n=this,r={location:e.point};n._needDrawMarkShape||n._drawMark(e,t,r),n._drawLabel(e,r),(r.mark||r.label)&&n._marks.push(r)},h.prototype._drawMark=function(e,t,r){var i=this,s=i.options.placemark,u,f,l,c,h,p;if(s===null)return;s.render?f=s.render(t):s.image&&(f=n("<img src='"+s.image+"' />"));if(!f||!f.length)return;r.mark=f,f.addClass(o).data(a,t).appendTo(i._placemarkContainer)},h.prototype._arrangeMarks=function(){var e=this,r=e.options,i=r.placemark||{},s,o,u,a,f,l;e._marks&&n.each(e._marks,function(e,n){n.mark&&(o=n.mark,s=r.converter.geographicToView(n.location),u=n.markSize||i.size||new t.Size(o.width(),o.height()),a=i.pinPoint||new t.Point(u.width/2,u.height/2),s.x-=h._offsetX,s.y-=h._offsetY,l=s.x-a.x,f=s.y-a.y,n.markSize=u,o.css("position","absolute").css("left",l+"px").css("top",f+"px"))})},h.prototype._drawLabel=function(e,t){var r=this,i=r.options.placemark||{},s=l[i.labelVisibility]||0,o=e.label||e.name;if(s===0||!o)return;var a=e.getViewBounds().location,f=n("<span style='position:absolute;' class='"+u+"'>"+o+"</span>").appendTo(r._placemarkContainer);t.label=f},h.prototype._arrangeLabels=function(e){var t=this,r=t.options,i=r.placemark||{},s=[];e=e||l[i.labelVisibility]||0,n.each(t._marks,function(n,i){if(i.label){var o,u,a=!1,f=s.length,l;o=r.converter.geographicToView(i.location),o.x-=h._offsetX,o.y-=h._offsetY,u=t._calculateLabelBounds(o,i.label,i.labelSize);if(e===1)for(l=0;l<f;l++)if(u.intersectsWith(s[l])){a=!0;break}a?i.label.remove():(i.label.css("left",u.location.x+"px").css("top",u.location.y+"px"),i.labelSize=u.size,e===1&&s.push(u))}})},h.prototype._calculateLabelBounds=function(e,n,r){var i=this,s=i.options.placemark||{},o=c[s.labelPosition]||0,u=r?r.width:n.outerWidth(),a=r?r.height:n.outerHeight(),f,l;return o===1?(f=e.x-u,l=e.y-a/2):o===2?(f=e.x,l=e.y-a/2):o===3?(f=e.x-u/2,l=e.y-a):o===4?(f=e.x-u/2,l=e.y):(f=e.x-u/2,l=e.y-a/2),new t.Rectangle(new t.Point(f,l),new t.Size(u,a))},h.prototype._translatePaper=function(e,t){var n=this,r=h._offsetX+e,i=h._offsetY+t;n._container.css("left",r+"px").css("top",i+"px")},h.prototype._scalePaper=function(e,t,n,r){var i=this;if(Raphael.vml){i._container.empty();return}var s=i.options.converter.getViewSize(),o=h._offsetX,u=h._offsetY,a=s.width/2-h._offsetX,f=s.height/2-h._offsetY,l=Raphael.matrix(1,0,0,1,0,0);i._container.css("left",o+"px").css("top",u+"px"),i._arrangeMarks(),i._arrangeLabels(2),l.translate(n,r),l.scale(e,t,a,f),i._group.transform(l)},h.prototype._updateShape=function(){var e=this;if(!e._cache||e._needFullUpdateShape){e._fullUpdateShape();return}var t=e.options,n=t.converter,r=n.geographicToView(t.center),i=n.geographicToView(e._cache.center),s=i.x-r.x,o=i.y-r.y;if(t.zoom===t.targetZoom){var u=h._clipRect;if(t.zoom!==e._cache.zoom||e._needFullUpdateShape||Math.abs(s)>.4*u.size.width||Math.abs(o)>.4*u.size.height){e._fullUpdateShape();return}e._translatePaper(s,o)}else{var a=Math.pow(2,t.zoom)/Math.pow(2,e._cache.zoom);e._scalePaper(a,a,s,o)}return},h.prototype._updateVectorObj=function(e,t,r,i,s){var o=this;o._updateSingleVectorObj(e,t,r,i,s),e&&e.children&&e.children.length>0&&n.each(e.children,function(e,n){o._updateVectorObj(n,t,r,i,s)})},h.prototype._updateSingleVectorObj=function(e,t,r,i,s){var o=this;e.vectorItems&&n.each(e.vectorItems,function(e,n){o._updateVectorItem(n,t,r,i,s)})},h.prototype._updateVectorItem=function(e,t,n,r,i){e.visible=!1;if(!n.intersectsWith(e.getBounds()))return;e.getViewBounds(t),e.isVisible(r,i)&&(e.visible=!0,e.updateShape(t))},h.prototype._fullUpdateShape=function(){var e=this,n=e.options,r=n.placemark||{},i=n.minSize==null?3:n.minSize,s=n.converter,o=i*i;e._needDrawMarkShape=!r.image&&!r.render,e._needFullUpdateShape=!1;if(!e._vectorObj)return;e._cache={zoom:n.zoom,center:n.center};var u=function(t){return e._proj.project(t)};e._proj.init(n);var a=h._clipRect,f=a.location.x,l=a.location.y,c=f+a.size.width,p=l+a.size.height,d=s.viewToGeographic(new t.Point(f+h._offsetX,l+h._offsetY)),v=s.viewToGeographic(new t.Point(c+h._offsetX,p+h._offsetY)),m=t.Utils.getBounds([d,v]);e._updateVectorObj(e._vectorObj,u,m,o,n.zoom),e._refreshPaper()},h.prototype._onShapeCreated=function(e,t){this._trigger(e,null,t)},h.prototype._onItemMouseEvent=function(e,t,r){var i=this;if(i._isDisabled())return;i._trigger(e,t,n(r).data(a))},h.prototype.refresh=function(){var e=this;e._data=null,this._setData(e.options.data)},h.prototype.destroy=function(){var t=this;t._paper&&t._paper.remove(),t._container.off("."+t.widgetName).remove(),e.prototype.destroy.call(this)},h._offsetX=-2e3,h._offsetY=-2e3,h._clipRect=new t.Rectangle(new t.Point(-h._offsetX-1e3,-h._offsetY-1e3),new t.Size(3e3,3e3)),h}(t.wijlayer);t.wijvectorlayer=v;var m;(function(e){e[e.Point=0]="Point",e[e.MultiPoint=1]="MultiPoint",e[e.LineString=2]="LineString",e[e.MultiLineString=3]="MultiLineString",e[e.Polygon=4]="Polygon",e[e.MultiPolygon=5]="MultiPolygon",e[e.GeometryCollection=6]="GeometryCollection",e[e.Feature=7]="Feature",e[e.FeatureCollection=8]="FeatureCollection"})(m||(m={}));var g=function(){function e(){this.type="VectorCollection",this.parent=null,this.children=[],this.vectorItems=null}return e.prototype.applyData=function(e){},e.prototype.addChild=function(e){this.children.push(e),e.parent=this},e}(),y=function(){function e(e){this.item=e,this.type="Vector",this.vectorItems=[e]}return e.prototype.applyData=function(e){this.data=e,this.item.applyData(e)},e}(),b=function(){function e(){this.type="Object"}return e.prototype.applyData=function(e,t){this.data=e,this.properties=t},e.prototype._addChild=function(e){var t=this;t.children=t.children||[],t.children.push(e),e.parent=t},e.create=function(e){switch(e.type){case m[0]:return new E;case m[1]:return new S;case m[2]:return new x;case m[3]:return new T;case m[4]:return new N;case m[5]:return new C;case m[6]:return new k;case m[7]:return new L;case m[8]:return new A}return null},e}(),w=function(e){function t(){e.apply(this,arguments),this.type="Geometry"}return __extends(t,e),t.prototype._createVectorItem=function(e){switch(e){case 2:return new D;case 0:return new M;case 1:return new _}return null},t}(b),E=function(e){function t(){e.apply(this,arguments),this.type="Point"}return __extends(t,e),t.prototype.applyData=function(t,n){var r=this,i;e.prototype.applyData.call(this,t,n),r.data=t,t.coordinates&&(i=r._createVectorItem(0),i.applyGeoData(t.coordinates,n),r.vectorItems=[i])},t}(w),S=function(e){function t(){e.apply(this,arguments),this.type="MultiPoint"}return __extends(t,e),t.prototype.applyData=function(t,r){var i=this,s;e.prototype.applyData.call(this,t,r),i.data=t,t.coordinates&&(i.vectorItems=[],n.each(t.coordinates,function(e,t){s=i._createVectorItem(0),s.applyGeoData(t,r),i.vectorItems.push(s)}))},t}(w),x=function(e){function t(){e.apply(this,arguments),this.type="LineString"}return __extends(t,e),t.prototype.applyData=function(t,n){var r=this,i;e.prototype.applyData.call(this,t,n),r.data=t,t.coordinates&&(i=r._createVectorItem(1),i.applyGeoData(t.coordinates,n),r.vectorItems=[i])},t}(w),T=function(e){function t(){e.apply(this,arguments),this.type="MultiLineString"}return __extends(t,e),t.prototype.applyData=function(t,r){var i=this,s;e.prototype.applyData.call(this,t,r),i.data=t,t.coordinates&&(i.vectorItems=[],n.each(t.coordinates,function(e,t){s=i._createVectorItem(1),s.applyGeoData(t,r),i.vectorItems.push(s)}))},t}(w),N=function(e){function t(){e.apply(this,arguments),this.type="Polygon"}return __extends(t,e),t.prototype.applyData=function(t,n){var r=this,i;e.prototype.applyData.call(this,t,n),r.data=t,t.coordinates&&(i=r._createVectorItem(2),i.applyGeoData(t.coordinates,n),r.vectorItems=[i])},t}(w),C=function(e){function t(){e.apply(this,arguments),this.type="MultiPolygon"}return __extends(t,e),t.prototype.applyData=function(t,r){var i=this,s;e.prototype.applyData.call(this,t,r),i.data=t,t.coordinates&&(i.vectorItems=[],n.each(t.coordinates,function(e,t){s=i._createVectorItem(2),s.applyGeoData(t,r),i.vectorItems.push(s)}))},t}(w),k=function(e){function t(){e.apply(this,arguments),this.type="GeometryCollection"}return __extends(t,e),t.prototype.applyData=function(t,r){var i=this,s;e.prototype.applyData.call(this,t,r),t.geometries&&n.each(t.geometries,function(e,t){s=b.create(t),s.applyData(t,r),i._addChild(s)}),i.geometries=i.children},t}(w),L=function(e){function t(){e.apply(this,arguments),this.type="Feature"}return __extends(t,e),t.prototype.applyData=function(t){var n=this,r;e.prototype.applyData.call(this,t,t.properties),t.geometry&&(r=b.create(t.geometry),r.applyData(t.geometry,t.properties),n._addChild(r),n.geometry=r)},t}(b),A=function(e){function t(){e.apply(this,arguments),this.type="FeaturesCollectiton"}return __extends(t,e),t.prototype.applyData=function(t){var r=this,i;e.prototype.applyData.call(this,t,null),t.features&&n.each(t.features,function(e,t){i=b.create(t),i.applyData(t,null),r._addChild(i)}),r.features=r.children},t}(b),O=function(){function e(){this._lod=new h,this.visible=!0}return e.prototype.applyData=function(e){this._applyProperties(e)},e.prototype.applyGeoData=function(e,t){this._applyProperties(t)},e.prototype._applyProperties=function(e){var n=this;e&&(n.name=e.name,n.fill=e.fill,n.fillOpacity=e.fillOpacity,n.stroke=e.stroke,n.strokeOpacity=e.strokeOpacity,n.strokeWidth=e.strokeWidth,n.strokeDashArray=e.strokeDashArray,n.strokeLineCap=t.PenLineCap[e.strokeLineCap],n.strokeLineJoin=t.PenLineJoin[e.strokeLineJoin],n.strokeMiterLimit=e.strokeMiterLimit,n._lod=new h(e.lod))},e.prototype.getBounds=function(){return null},e.prototype.getViewBounds=function(e){return null},e.prototype.isVisible=function(e,t){var n=0,r=this.getViewBounds();r.isEmpty()||(n=r.size.width*r.size.width+r.size.height*r.size.height);var i=this._lod;if(i&&i.isDefault())return n>=e;var s=t>=i.minZoom&&t<=i.maxZoom;return s?i.maxSize===0?n>=i.minSize*i.minSize:this._lod.minSize===0?n<=i.maxSize*i.maxSize:n>=i.minSize*i.minSize&&n<=i.maxSize*i.maxSize:!1},e.prototype.getShape=function(){return null},e.prototype._initShape=function(e){var t=this;t.fill!=null&&(e.fill=t.fill),t.fillOpacity!=null&&(e.fillOpacity=t.fillOpacity),t.stroke!=null&&(e.stroke=t.stroke),t.strokeOpacity!=null&&(e.strokeOpacity=t.strokeOpacity),t.strokeWidth!=null&&(e.strokeWidth=t.strokeWidth),t.strokeDashArray&&(e.strokeDashArray=t.strokeDashArray),t.strokeLineCap!=null&&(e.strokeLineCap=t.strokeLineCap),t.strokeLineJoin&&(e.strokeLineJoin=t.strokeLineJoin),t.strokeMiterLimit&&(e.strokeMiterLimit=t.strokeMiterLimit)},e.prototype.updateShape=function(e){},e.convertPoints=function(t,n){var r=null;if(t!=null){var i=t.length,s=n(t[0]);r=[],r.push(s);for(var o=1;o<i;o++){var u=n(t[o]);if(Math.abs(u.x-s.x)>=e.optRad||Math.abs(u.y-s.y)>=e.optRad)r.push(u),s=u}}return r},e.convertPointsList=function(t,r){var i=null;return t!=null&&t.length>0&&(i=[],n.each(t,function(t,n){var s=e.convertPoints(n,r);s&&i.push(s)})),i},e.optRad=1.5,e}();t.VectorItem=O;var M=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.applyData=function(n){e.prototype.applyData.call(this,n),n.coordinates&&n.coordinates.length>1&&(this.point=new t.Point(n.coordinates[0],n.coordinates[1]))},n.prototype.applyGeoData=function(n,r){e.prototype.applyGeoData.call(this,n,r),this.point=t.Utils.getPointData(n)},n.prototype._applyProperties=function(t){var n=this;t&&(e.prototype._applyProperties.call(this,t),n.label=t.label)},n.prototype.getBounds=function(){var e=this;return new t.Rectangle(new t.Point(e.point.x,e.point.y),new t.Size(0,0))},n.prototype.getViewBounds=function(){return this._bnds},n.prototype.isVisible=function(e,t){var n=this._lod,r=!0;return n.isDefault()||(r=t>=n.minZoom&&t<=n.maxZoom),r},n.prototype.getShape=function(){return null},n.prototype.updateShape=function(e){var n=this,r=e(n.point),i=new t.Rectangle(new t.Point(r.x,r.y),new t.Size(0,0));n._bnds=i},n}(O),_=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.applyData=function(n){var r=this;e.prototype.applyData.call(this,n),r.points=t.Utils.getPoints(n.coordinates),r._gbnds=t.Utils.getBounds(r.points)},n.prototype.applyGeoData=function(n,r){e.prototype.applyGeoData.call(this,n,r);var i=this;i.points=t.Utils.getLineData(n),i._gbnds=t.Utils.getBounds(i.points)},n.prototype.getBounds=function(){return this._gbnds},n.prototype.getViewBounds=function(e){var n=this;if(e){var r=new t.Point(n._gbnds.location.x,n._gbnds.location.y),i=new t.Point(n._gbnds.getRight(),n._gbnds.getBottom());r=e(r),i=e(i),n._bnds=t.Utils.getBounds([r,i])}return n._bnds},n.prototype.getShape=function(){return this._plines},n.prototype.updateShape=function(e){var n=this,r=v._clipRect,i=O.convertPoints(n.points,e);return n._plines||(n._plines=new t.MultiPolyline,n._initShape(n._plines)),n._bnds=t.Utils.getBounds(i),n._bnds.size.width>r.size.width||n._bnds.size.height>r.size.height?(n._plines.points=t.ClippingEngine.createClippedLines(i,r),n._bnds=n._bnds.intersect(r)):n._plines.points=[i],this._bnds},n}(O),D=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.applyData=function(n){var r=this,i,s;e.prototype.applyData.call(this,n),r.pointsList=[t.Utils.getPoints(n.coordinates)],r._gbnds=t.Utils.getListBounds(r.pointsList)},n.prototype.applyGeoData=function(n,r){var i=this;e.prototype.applyGeoData.call(this,n,r),i.pointsList=t.Utils.getPolygonData(n),i._gbnds=t.Utils.getListBounds(i.pointsList)},n.prototype.getBounds=function(){return this._gbnds},n.prototype.getViewBounds=function(e){var n=this;if(e){var r=new t.Point(n._gbnds.location.x,n._gbnds.location.y),i=new t.Point(this._gbnds.getRight(),this._gbnds.getBottom());r=e(r),i=e(i),n._bnds=t.Utils.getBounds([r,i])}return n._bnds},n.prototype.getShape=function(){return this._polygon},n.prototype.updateShape=function(e){var n=this,r=v._clipRect,i=O.convertPointsList(n.pointsList,e);n._polygon||(n._polygon=new t.Polygon,n._initShape(n._polygon)),n._bnds=t.Utils.getListBounds(i);if(n._bnds.size.width>r.size.width||n._bnds.size.height>r.size.height)i=t.ClippingEngine.clipPolygonList(i,r),n._bnds=t.Utils.getListBounds(i);n._polygon.pointsList=i},n}(O),P=function(e){function t(){e.apply(this,arguments),this.dataType=H.wijJson,this.minSize=3,this.placemark=null,this.shapeCreated=null,this.mouseEnter=null,this.mouseLeave=null,this.mouseDown=null,this.mouseUp=null,this.mouseMove=null,this.click=null}return __extends(t,e),t}(t.wijlayer_options);t.wijvectorlayer_options=P;var H=function(){function e(){}return e.wijJson="wijJson",e.geoJson="geoJson",e}();v.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new P),n.wijmo.registerWidget("wijvectorlayer",n.wijmo.wijlayer,v.prototype)})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r="wijmo-wijmaps-layercontainer",i=function(e){function i(){e.apply(this,arguments),this._maxZoom=20}return __extends(i,e),i.prototype._create=function(){var t=this;t._container=n('<div class="'+r+'"></div>'),t.element.append(t._container),t._paper=t._createPaper(t._container[0],t.options.converter.getViewSize()),e.prototype._create.call(this),t._setRequest(t.options.request)},i.prototype._setOption=function(t,n){var r=this,i=this.options;if(i[t]!==n)switch(t){case"request":r._setRequest(n);return;case"slices":r._setSlices(n);return}e.prototype._setOption.call(this,t,n)},i.prototype._setRequest=function(e){var t=this;t.options.request=e,t._refreshLayer()},i.prototype._setSlices=function(e){var t=this;t.options.slices=e,t._refreshLayer()},i.prototype._refreshLayer=function(){var e=this,t=e.options;e._slices=e._sortSlices(t.slices),e._clear(),e.update()},i.prototype._render=function(){var e=this,r=e.options,i=e._getMatchedSlice();if(i===null){e._clear();return}e._resizePaper(e._paper,r.converter.getViewSize());var s=n.inArray(i,e._slices),o=s>0?e._slices[s-1].zoom:e._maxZoom,u=e._getLogicBounds(),a=u.location,f=new t.Point(u.getRight(),u.getBottom()),l=[];for(var c=Math.floor(a.x*i.longitudeSlices);c<f.x*i.longitudeSlices;c++)for(var h=Math.floor(a.y*i.latitudeSlices);h<f.y*i.latitudeSlices;h++)l.push(new t.Region(i,c,h));var p=n.grep(e._visibleRegions,function(e){for(var t=0;t<l.length;t++)if(e.equals(l[t]))return!1;return!0});n.each(p,function(t,n){e._removeRegion(n)});var d=n.grep(l,function(t){for(var n=0;n<e._visibleRegions.length;n++)if(t.equals(e._visibleRegions[n]))return!1;return!0}),v=n.grep(e._visibleRegions,function(e){return n.inArray(e,p)===-1});e._visibleRegions=v.concat(d),n.each(d,function(n,s){var u=r.converter.logicToGeographic(new t.Point(s.longitude/i.longitudeSlices,(s.latitude+1)/i.latitudeSlices)),a=r.converter.logicToGeographic(new t.Point((s.longitude+1)/i.longitudeSlices,s.latitude/i.latitudeSlices)),f=r.request(e._paper,e.options.zoom,o,u,a);f&&(s.items=f.items,f.items&&t.wijitemslayer._setItemsData(f.items))}),e._relayout()},i.prototype._relayout=function(){var e=this,n=e.options,r=n.converter;t.wijitemslayer._relayoutRegions(r,e._visibleRegions)},i.prototype._removeRegion=function(e){e.items&&n.each(e.items,function(e,t){t.elements.remove()})},i.prototype._clear=function(){var e=this;e._visibleRegions=[],e._paper&&e._paper.clear()},i.prototype._getMatchedSlice=function(){var e=this;if(!e._slices)return null;var t=e._slices.length,n,r;for(n=0;n<t;n++){r=e._slices[n];if(r.zoom<=e.options.zoom)return r}return null},i.prototype._sortSlices=function(e){return e?e.sort(function(e,t){return-(e.zoom-t.zoom)}):[]},i.prototype._getLogicBounds=function(){var e=this,n=e.options.converter,r=n.viewToLogic(new t.Point(0,0)),i=n.getLogicSize();return new t.Rectangle(r,i)},i.prototype.refresh=function(){this._refreshLayer(),e.prototype.refresh.call(this)},i.prototype.destroy=function(){var t=this;t._paper&&t._paper.remove(),t._container.remove(),e.prototype.destroy.call(this)},i}(t.wijlayer);t.wijvirtuallayer=i;var s=function(e){function t(){e.apply(this,arguments),this.slices=[]}return __extends(t,e),t}(t.wijlayer_options);t.wijvirtuallayer_options=s,i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijvirtuallayer",i.prototype)})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r="wijmo-wijmaps-layercontainer",i=function(){function e(e,t,n){this.latitudeSlices=e,this.longitudeSlices=t,this.zoom=n}return e}();t.MapSlice=i;var s=function(){function e(e,t,n){this.slice=e,this.longitude=t,this.latitude=n}return e.prototype.equals=function(e){var t=this;return t.slice===e.slice&&t.longitude===e.longitude&&t.latitude===e.latitude},e}();t.Region=s;var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var t=this;t._container=n('<div class="'+r+'"></div>'),t.element.append(t._container),t._paper=t._createPaper(t._container[0],t.options.converter.getViewSize()),e.prototype._create.call(this),t._setRequest(t.options.request)},t.prototype._setOption=function(t,n){var r=this,i=this.options;if(i[t]!==n)switch(t){case"request":r._setRequest(n);return}e.prototype._setOption.call(this,t,n)},t.prototype._setRequest=function(e){var n=this;n.options.request=e,n._clear();if(e){var r=e(n._paper);if(r){var o=new s(new i(1,1,0),0,0);o.items=r.items,t._setItemsData(r.items),n._visibleRegions=[o]}}n.update()},t.prototype._render=function(){var e=this,n=e.options.converter;e._resizePaper(e._paper,n.getViewSize()),t._relayoutRegions(e.options.converter,e._visibleRegions)},t.prototype._clear=function(){var e=this;e._visibleRegions=null,e._paper&&e._paper.clear()},t._relayoutRegions=function(e,t){if(!t)return;var r=e.getViewSize(),i=r.width/e.getLogicSize().width,s=e.getLogicCenter(),o=r.width/2-s.x*i,u=r.height/2-s.y*i;n.each(t,function(t,r){r.items&&n.each(r.items,function(t,r){if(r.elements){var s=e.geographicToLogic(r.location),a=s.x*i+o-(r.pinpoint?r.pinpoint.x:0),f=s.y*i+u-(r.pinpoint?r.pinpoint.y:0),l="t"+a+","+f;n.each(r.elements,function(e,t){t.transform(t.data("wijmo-transform")+l)})}})})},t._setItemsData=function(e){e&&n.each(e,function(e,t){t.elements&&n.each(t.elements,function(e,t){t.data("wijmo-transform",t.transform())})})},t.prototype.refresh=function(){var t=this;t._setRequest(t.options.request),e.prototype.refresh.call(this)},t.prototype.destroy=function(){var t=this;t._paper&&t._paper.remove(),t._container.remove(),e.prototype.destroy.call(this)},t}(t.wijlayer);t.wijitemslayer=o;var u=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t.wijlayer_options);t.wijitemslayer_options=u,o.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new u),n.wijmo.registerWidget("wijitemslayer",o.prototype)})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=.5,i=20,s=158,o={layerContainerCss:"wijmo-wijmaps-layercontainer",toolsLayerCss:"wijmo-wijmaps-toolslayer",panCss:"wijmo-wijmaps-pan",panpointCss:"wijmo-wijmaps-panpoint",zoomCss:"wijmo-wijmaps-zoomer",scaleCss:"wijmo-wijmaps-scaler",scaleLableCss:"wijmo-wijmaps-content",scaleValueCss:"wijmo-wijmaps-scalervalue"},u=function(e){function u(){e.apply(this,arguments)}return __extends(u,e),u.prototype._create=function(){var e=this;e.element.addClass(o.toolsLayerCss),e._on(e.element,{dblclick:function(e,t){e.stopPropagation()}}),e._speed=r,e._isPanning=!1,e._createPanPanel(),e._createZoomPanel(),e._createScalePanel()},u.prototype._innerDisable=function(){e.prototype._innerDisable.call(this),this._handleDisabledOption(!0)},u.prototype._innerEnable=function(){e.prototype._innerEnable.call(this),this._handleDisabledOption(!1)},u.prototype._handleDisabledOption=function(e){var t=this,n={disabled:e};t._zoomSlider&&t._zoomSlider.wijslider(n)},u.prototype._setOption=function(t,n){var r=this,i=this.options;if(i[t]!==n)switch(t){case"center":r._setCenter(n);return;case"zoom":r._setZoom(n);return}e.prototype._setOption.call(this,t,n)},u.prototype._setCenter=function(e){var t=this,n=t.options;n.center=e,t._updateScalePanel()},u.prototype._setZoom=function(e){var t=this,n=t.options;n.zoom=e,t._zoomSlider.wijslider({orientation:"vertical",range:!1,min:n.minZoom,max:n.maxZoom,step:1,value:n.zoom,values:null}),t._updateScalePanel()},u.prototype._createPanPanel=function(){var e=this,r=e.options,i=e.element,s,u,a,f,l,c,h,p;e._panPanel=n('<div class="'+o.panCss+" "+r.wijCSS.stateDefault+'"></div>').appendTo(i),e._on(e._panPanel,{mousedown:function(r,i){e._isPanning=!0,e._startPanning(e._panPanel,e._getPanPointOffset(e._panPanel,new t.Point(r.pageX,r.pageY))),n(document).disableSelection(),r.stopPropagation()},dragstart:function(e,t){e.preventDefault()},selectstart:function(e,t){e.preventDefault()}}),e._on(n(document),{mouseup:function(t,r){e._isPanning=!1,e._stopPanning(),n(document).enableSelection()},mousemove:function(n,r){e._isPanning&&e._startPanning(e._panPanel,e._getPanPointOffset(e._panPanel,new t.Point(n.pageX,n.pageY)))}}),e._panPoint=n('<div class="'+o.panpointCss+" "+r.wijCSS.content+" "+r.wijCSS.stateActive+'"></div>').hide().appendTo(i),a=n('<div class="'+r.wijCSS.icon+" "+r.wijCSS.iconArrowLeft+'"></div>'),f=n('<div class="'+r.wijCSS.icon+" "+r.wijCSS.iconArrowRight+'"></div>'),l=n('<div class="'+r.wijCSS.icon+" "+r.wijCSS.iconArrowUp+'"></div>'),c=n('<div class="'+r.wijCSS.icon+" "+r.wijCSS.iconArrowDown+'"></div>'),e._panPanel.append(a,f,l,c)},u.prototype._getPanPointOffset=function(e,t){var n=e.offset();return t.offset(-n.left,-n.top)},u.prototype._startPanning=function(e,n){var r=this,i=r.options,s=i.converter.getViewCenter(),o=new t.Point(e.outerWidth()/2,e.outerHeight()/2),u=n.offset(-o.x,-o.y),a=Math.sqrt(Math.pow(u.x,2)+Math.pow(u.y,2)),f=new t.Point(n.x,n.y),l;r._panningTimer&&clearInterval(r._panningTimer),r._panningTimer=setInterval(function(){l=i.converter.viewToGeographic((new t.Point(u.scale(r._speed,r._speed))).offset(s.x,s.y)),r._trigger("targetCenterChanged",null,{targetCenter:l})},20),a>o.x&&(f=o.scale(u.x/a,u.y/a).offset(o.x,o.y)),f=f.offset(e.position().left,e.position().top),r._panPoint.css("left",f.x-r._panPoint.width()/2).css("top",f.y-r._panPoint.height()/2).show()},u.prototype._stopPanning=function(){var e=this;e._panningTimer&&clearInterval(e._panningTimer),e._panPoint.hide()},u.prototype._createZoomPanel=function(){var e=this,t=e.options,r=e.element;e._zoomSlider=n("<div></div>").css("height","100%").css("font-size","13px"),e._zoomPanel=n('<div class="'+o.zoomCss+'"></div>').append(e._zoomSlider),r.append(e._zoomPanel),e._zoomSlider.wijslider({orientation:"vertical",range:!1,min:t.minZoom,max:t.maxZoom,step:1,value:t.zoom,values:null}),e._on(e._zoomPanel,{mousedown:function(e,t){e.stopPropagation()}}),e._on(!0,e._zoomPanel,{wijsliderchange:function(t,n){e._trigger("targetZoomChanged",null,{targetZoom:n.value})}})},u.prototype._createScalePanel=function(){var e=this,t=e.options,r=e.element;e._scalePanel=n('<div class="'+o.scaleCss+" "+t.wijCSS.content+'"></div>').appendTo(r),e._on(e._scalePanel,{mousedown:function(e,t){e.stopPropagation()},dblclick:function(e,t){e.stopPropagation()}}),e._metersLabel=n('<span class="'+o.scaleLableCss+'"></span>'),e._milesLabel=n('<span class="'+o.scaleLableCss+'"></span>'),e._metersValue=n('<span class="'+o.scaleValueCss+" "+t.wijCSS.stateDefault+'"></span>'),e._milesValue=n('<span class="'+o.scaleValueCss+" "+t.wijCSS.stateDefault+'"></span>'),e._scalePanel.append(e._metersLabel,e._metersValue,n("<br />"),e._milesLabel,e._milesValue),e._updateScalePanel()},u.prototype._updateScalePanel=function(){var e=this;e._updateScale(e._metersValue,e._metersLabel,1,1e3,"km","m"),e._updateScale(e._milesValue,e._milesLabel,3.2808399,5280,"mi","ft")},u.prototype._updateScale=function(e,t,n,r,o,u){if(e){var a=this,f=a.options,l=i,c=s,h=a._getDistance(l)*n,p=a._getDistance(c)*n,d=a._roundest(Math.floor(h),Math.floor(p));d.toString().length<=Math.ceil(Math.LOG10E*Math.log(r))?t&&t.text(d+" "+u):(h/=r,p/=r,d=a._roundest(Math.floor(h),Math.floor(p)),t&&t.text(d+" "+o))}var v=(d-h)*1/(p-h);e.width(Math.max(l*(1-v)+c*v,0))},u.prototype._getDistance=function(e){var n=this,r=n.options;return r.converter.distance(r.center,r.converter.viewToGeographic((new t.Point(r.converter.getViewCenter())).offset(r.center.x<0?e:-e,0)))},u.prototype._roundest=function(e,t){var n=this,r=t.toString(),i=e.toString();for(var s=0;s<r.length;++s)if(r.length>i.length||r[s]!=i[s])return parseInt(n._padRight(r.substring(0,s+1),r.length,"0"));return t},u.prototype._padRight=function(e,t,n){if(e.length<t){var r,i=new String;for(r=1;r<=t-e.length;r++)i+=n;return e+i}return e},u.prototype.destroy=function(){var t=this;n(document).off("."+t.widgetName),t._panPanel.remove(),t._zoomSlider.wijslider("destroy").remove(),t._panPanel.off("."+t.widgetName).remove(),t._zoomPanel.off("."+t.widgetName).remove(),t._scalePanel.off("."+t.widgetName).remove(),t.element.removeClass(o.toolsLayerCss).off("."+t.widgetName),e.prototype.destroy.call(this)},u}(e.wijmoWidget);t.wijtoolslayer=u;var a=function(){function e(){}return e}();t.wijtoolslayer_options=a,u.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new a),n.wijmo.registerWidget("wijtoolslayer",u.prototype)})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r="wijmo-wijmaps-tile",i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype._create=function(){var e=this,t=e.options;e._tileItems={},e._tileScale=e._getTileScale(Math.round(t.zoom),t.zoom),e._renderTiles()},i.prototype._setOption=function(t,n){var r=this,i=r.options;if(i[t]!==n)switch(t){case"center":r._setCenter(n);return;case"zoom":r._setZoom(n);return;case"source":r._setSource(n);return}e.prototype._setOption.call(this,t,n)},i.prototype._setCenter=function(e){var n=this,r=n.options,i=new t.Size(e.x-r.center.x,e.y-r.center.y);n._offsetTiles(i),r.center=e,n._renderTiles()},i.prototype._setZoom=function(e){var t=this,n=t.options,r=n.zoom,i,s;e>=n.source.minZoom&&e<=n.source.maxZoom&&(t._tileScale=t._getTileScale(Math.round(e),e),t._scaleTiles(t._getTileScale(r,e)),n.zoom=e,setTimeout(function(){t._renderTiles()},10))},i.prototype._setSource=function(e){var t=this,r=t.options;r.source=e,n.each(t._tileItems,function(e,n){n.img.remove(),delete t._tileItems[e]}),t._renderTiles()},i.prototype._offsetTiles=function(e){var r=this,i=r._getViewFullSize();n.each(r._tileItems,function(n,r){r.bounds.location=(new t.Point(r.bounds.location)).offset(-e.width*i.width,-e.height*i.height),r.img.css("left",r.bounds.location.x).css("top",r.bounds.location.y)})},i.prototype._getTileScale=function(e,t){return Math.pow(2,t-e)},i.prototype._scaleTiles=function(e){var r=this,i=r._getViewSize(),s=new t.Rectangle(new t.Point(0,0),i);n.each(r._tileItems,function(n,o){o.bounds.location.x=i.width/2-(i.width/2-o.bounds.location.x)*e,o.bounds.location.y=i.height/2-(i.height/2-o.bounds.location.y)*e,o.bounds.size=(new t.Size(o.bounds.size)).scale(e,e),s.intersect(o.bounds)?o.img.css("left",o.bounds.location.x).css("top",o.bounds.location.y).css("width",o.bounds.size.width).css("height",o.bounds.size.height):(o.img.remove(),delete r._tileItems[n])})},i.prototype._renderTiles=function(){var e=this,r=e.options,i=Math.round(r.zoom),o=e._getLeftTopTileItem(),u=e._getViewSize(),a=e._getTileSize(),f=e._getMaxTileCount(r.zoom),l=f-o.columnIndex,c=f-o.rowIndex,h=Math.min(l,Math.ceil((u.width-o.bounds.location.x)/a.width)),p=Math.min(c,Math.ceil((u.height-o.bounds.location.y)/a.height)),d,v,m,g,y,b=n.extend({},e._tileItems),w=[];for(m=o.rowIndex;m<o.rowIndex+p;m++)for(g=o.columnIndex;g<o.columnIndex+h;g++)d=o.bounds.location.x+a.width*(g-o.columnIndex),v=o.bounds.location.y+a.height*(m-o.rowIndex),y=new s(g,m,new t.Rectangle(new t.Point(d,v),new t.Size(a.width,a.height)),i),e._renderTile(y,i,b,w)},i.prototype._renderTile=function(e,t,i,s){var o=this,u=o.options,a=e.bounds.location,f=e.bounds.size,l,c,h,p,d="tile_"+e.columnIndex+"_"+e.rowIndex+"_"+e.zoomLevel;o._tileItems[d]?(h=o._tileItems[d],h.bounds=e.bounds,h.img.css("left",a.x).css("top",a.y).css("width",f.width).css("height",f.height),o.element.append(h.img)):(o._tileItems[d]=e,c=u.source.getUrl(e.zoomLevel,e.columnIndex,e.rowIndex),l="left:"+a.x+"px; top:"+a.y+"px; width:"+f.width+"px; height:"+f.height+"px; display:none",e.img=n('<img class="'+r+'" style="'+l+'" src="'+c+'"></img>'),s.push(d),e.img.one("load.wijmultiscaleimage",function(n,r){o._onTileLoad(e.img,d,t,i,s)}),o.element.append(e.img))},i.prototype._onTileLoad=function(e,t,r,i,s){var o=this,u=o.options;e.fadeIn(600,function(){s.splice(n.inArray(t,s),1),s.length==0&&n.each(i,function(e,t){o._isUselessTile(t,r)&&(t.img.remove(),n("img[src='"+t.img.attr("src")+"']").length==0&&(delete i[e],delete o._tileItems[e]))})})},i.prototype._isUselessTile=function(e,n){var r=this,i=r.options,s=Math.round(i.zoom),o=new t.Rectangle(t.Point.empty,r._getViewSize()),u=o.intersect(e.bounds);return e.zoomLevel===n||e.zoomLevel===s?!u:!0},i.prototype._isPointInRect=function(e,t){return e.x>=t.location.x&&e.x<=t.location.x+t.size.width&&e.y>=t.location.y&&e.y<=t.location.y+t.size.height},i.prototype._getLeftTopTileItem=function(){var e=this,n=e.options,r=e._getMaxTileCount(n.zoom),i=(new t.Point(n.center)).scale(r,r),o=e._getTileSize(),u=e._getViewSize(),a=Math.floor(i.y),f=Math.floor(i.x),l=e._getViewCenter().offset(-(i.x%1)*o.width,-(i.y%1)*o.height);while(f>0&&l.x>0)f-=1,l.x-=o.width;while(a>0&&l.y>0)a-=1,l.y-=o.height;return new s(f,a,new t.Rectangle(l,o),Math.round(n.zoom))},i.prototype._getTileSize=function(){var e=this,n=e.options;return(new t.Size(n.source.tileWidth,n.source.tileHeight)).scale(e._tileScale,e._tileScale)},i.prototype._getMaxTileCount=function(e){return Math.pow(2,Math.round(e))},i.prototype._getViewSize=function(){var e=this;return new t.Size(e.element.width(),e.element.height())},i.prototype._getViewCenter=function(){var e=this,n=e._getViewSize();return new t.Point(n.width/2,n.height/2)},i.prototype._getViewFullSize=function(){var e=this,n=e.options,r=Math.pow(2,n.zoom);return(new t.Size(n.source.tileWidth,n.source.tileHeight)).scale(r,r)},i.prototype.destroy=function(){this.element.children().remove(),e.prototype.destroy.call(this)},i}(e.wijmoWidget);t.wijmultiscaleimage=i;var s=function(){function e(e,t,n,r,i){this.columnIndex=e,this.rowIndex=t,this.bounds=n,this.zoomLevel=r,this.img=i}return e}(),o=function(){function e(){this.center=new t.Point(0,0),this.zoom=3}return e}();t.wijmultiscaleimage_options=o,i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new o),n.wijmo.registerWidget("wijmultiscaleimage",i.prototype)})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=1,i=20,s=256,o=256,u="wijmo-wijmaps",a="wijmo-wijmaps-container",f="wijmo-wijmaps-tileslayer",l="wijmo-wijmaps-layercontainer",c=function(c){function h(){c.apply(this,arguments)}return __extends(h,c),h.prototype._create=function(){var e=this,t=e.options;e._setInnerSource(t.source,function(){e._createMaps()}),c.prototype._create.call(this)},h.prototype._createMaps=function(){var a=this,f=a.element,l=a.options,c,h,p,d,v,m;f.addClass(u),f.addClass(l.wijCSS.content),f.attr("tabindex",-1),a._isPanning=!1,a._isZooming=!1,a._isCenterChanging=!1,a._keyCode=e.getKeyCodeEnum(),a._innerSource?(a._minZoom=a._innerSource.minZoom,a._maxZoom=a._innerSource.maxZoom,a._coordConverter=new t.CoordConverter(f,new t.Point(l.center.x,l.center.y),l.zoom,a._innerSource.tileWidth,a._innerSource.tileHeight)):(a._minZoom=r,a._maxZoom=i,a._coordConverter=new t.CoordConverter(f,new t.Point(l.center.x,l.center.y),l.zoom,s,o)),l.targetCenter||(l.targetCenter=n.extend({},l.center)),l.targetZoom===undefined&&(l.targetZoom=l.zoom),a._createLayers(),l.targetZoom!==l.zoom&&(p=l.targetZoom,l.targetZoom=l.zoom,a._setTargetZoom(p));if(l.targetCenter.x!==l.center.x||l.targetCenter.y!==l.center.y)d=l.targetCenter,l.targetCenter=l.center,a._setTargetCenter(d);a._on(f,{dragstart:function(e,t){e.preventDefault()},selectstart:function(e,t){e.preventDefault()},mousewheel:function(e,n){var r=new t.Point(e.pageX-f.offset().left,e.pageY-f.offset().top);n>0?a._zoomIn(r):a._zoomOut(r),e.preventDefault()},dblclick:function(e,n){var r=new t.Point(e.pageX-f.offset().left,e.pageY-f.offset().top);a._zoomIn(r)},mousedown:function(e,r){f.focus(),a._isPanning=!0,a._panningStartPosition=new t.Point(e.pageX,e.pageY),n(document).disableSelection()},keydown:function(e,t){a._onKeyDown(e)&&e.preventDefault()},keypress:function(e,t){a._onKeyPress(e)&&e.preventDefault()}}),a._on(n(document),{mouseup:function(e,t){a._isPanning=!1,n(document).enableSelection()},mousemove:function(e,n){a._isPanning&&(c=a._panningStartPosition.x-e.pageX,h=a._panningStartPosition.y-e.pageY,a._panningStartPosition=new t.Point(e.pageX,e.pageY),a._panning(c,h))}})},h.prototype._innerDisable=function(){c.prototype._innerDisable.call(this),this._handleDisabledOption(!0)},h.prototype._innerEnable=function(){c.prototype._innerEnable.call(this),this._handleDisabledOption(!1)},h.prototype._handleDisabledOption=function(e){var t=this,r=t.options,i=t._layers,s={disabled:e};i&&n.each(i,function(e,t){t.element[t.wijname](s)}),t._innerSource&&t._multiScaleImageContainer.wijmultiscaleimage(s),r.showTools&&t._toolsLayerContainer.wijtoolslayer(s),e?t._disabledCover.show():t._disabledCover.hide()},h.prototype._setOption=function(e,t){var n=this,r=this.options;if(r[e]!==t)switch(e){case"center":n._setCenter(t);return;case"targetCenter":n._setTargetCenter(t);return;case"zoom":n._setZoom(t);return;case"targetZoom":n._setTargetZoom(t);return;case"layers":n._setLayers(t);return;case"showTools":n._setShowTools(t);return;case"source":n._setSource(t);return}c.prototype._setOption.call(this,e,t)},h.prototype._setInnerSource=function(e,r){var i=this,s=i.options,o;switch(e){case"bingMapsRoadSource":i._innerSource=t.MapSource.bingMapsRoadSource,o=!0;break;case"bingMapsAerialSource":i._innerSource=t.MapSource.bingMapsAerialSource,o=!0;break;case"bingMapsHybridSource":i._innerSource=t.MapSource.bingMapsHybridSource,o=!0;break;default:i._innerSource=e,o=!1}o&&s.bingMapsKey&&s.bingMapsKey!==""?n.ajax({url:"http://dev.virtualearth.net/webservices/v1/LoggingService/LoggingService.svc/Log?entry=0&auth="+s.bingMapsKey+"&fmt=1&type=3&group=wijmo&name=wijmaps&mkt=en-us&jsonp=?",data:null,context:null,success:function(e){i._authenticationResult=e?e.authenticationResultCode:"",i._sessionId=e?e.sessionId:"",r()},error:function(e){r()},dataType:"json",timeout:5e3}):r()},h.prototype._setShowTools=function(e){var t=this,n=t.options;n.showTools=e,e?t._createToolsLayer():t._destroyToolsLayer()},h.prototype._setSource=function(e){var t=this,n=t.options;n.source=e,t._setInnerSource(e,function(){t._refreshTileLayer()})},h.prototype._refreshTileLayer=function(){var e=this;e._destroyTileLayer(),e._innerSource?(e._minZoom=e._innerSource.minZoom,e._maxZoom=e._innerSource.maxZoom,e._coordConverter.tileWidth=e._innerSource.tileWidth,e._coordConverter.tileHeight=e._innerSource.tileHeight,e._createMultiScaleImageLayer()):(e._minZoom=r,e._maxZoom=i,e._coordConverter.tileWidth=s,e._coordConverter.tileHeight=o)},h.prototype._setLayers=function(e){var t=this;t.options.layers=e,t._destroyInnerLayers(),t._createInnerLayers()},h.prototype._setCenter=function(e){var n=this;n.options.targetCenter=e,n._trigger("targetCenterChanged",null,{targetCenter:e}),n._setCenterInternal(new t.Point(e.x,e.y))},h.prototype._setCenterInternal=function(e){var t=this,n=t.options;n.center={x:e.x,y:e.y},t._coordConverter.center=e,t._updateLayers(),t._trigger("centerChanged",null,{center:n.center})},h.prototype._setZoom=function(e,t){var n=this,r=n.options;e!==r.zoom&&e>=n._minZoom&&e<=n._maxZoom&&(n.options.targetZoom=e,n._trigger("targetZoomChanged",null,{targetZoom:e}),n._setZoomInternal(e,t))},h.prototype._setZoomInternal=function(e,n){var r=this,i=r.options,s,o,u;o=r._coordConverter.getViewCenter(),s=n?n:o,u=(new t.Size(s.x-o.x,s.y-o.y)).scale(1-Math.pow(2,i.zoom-e),1-Math.pow(2,i.zoom-e)),r._offsetCenter(u.width,u.height),i.zoom=e,r._coordConverter.zoom=e,r._updateLayers(),r._trigger("zoomChanged",null,{zoom:i.zoom})},h.prototype._zoomIn=function(e){var t=this,n=t.options,r=Math.min(Math.round(n.targetZoom+1),t._maxZoom);n.zoom!==r&&t._setTargetZoom(r,e)},h.prototype._zoomOut=function(e){var t=this,n=t.options,r=Math.max(Math.round(n.targetZoom-1),t._minZoom);n.zoom!==r&&t._setTargetZoom(r,e)},h.prototype._setTargetZoom=function(e,t){var n=this,r=n.options,i;e>n._maxZoom&&(e=n._maxZoom),e<n._minZoom&&(e=n._minZoom);if(e!==r.targetZoom){r.targetZoom=e,n._trigger("targetZoomChanged",null,{targetZoom:e});if(n._isZooming)return;n._isZooming=!0,clearInterval(n._targetZoomTimer),n._targetZoomTimer=setInterval(function(){n._isZooming&&(Math.abs(r.zoom-r.targetZoom)<.001?(i=r.targetZoom,n._isZooming=!1,clearInterval(n._targetZoomTimer)):i=r.targetZoom*r.targetZoomSpeed+r.zoom*(1-r.targetZoomSpeed),n._setZoomInternal(i,t))},20)}},h.prototype._setTargetCenter=function(e){var n=this,r=n.options,i,s=n._coordConverter;e.x<s.minLongitude&&(e.x=s.minLongitude),e.x>s.maxLongitude&&(e.x=s.maxLongitude),e.y<s.minLatitude&&(e.y=s.minLatitude),e.y>s.maxLatitude&&(e.y=s.maxLatitude);if(r.targetCenter.x!==e.x||r.targetCenter.y!==e.y){r.targetCenter=e,n._trigger("targetCenterChanged",null,{targetCenter:e});if(n._isCenterChanging)return;n._isCenterChanging=!0,clearInterval(n._targetCenterTimer),n._targetCenterTimer=setInterval(function(){n._isCenterChanging&&(Math.abs(r.targetCenter.x-r.center.x)<.001&&Math.abs(r.targetCenter.y-r.center.y)<.001?(i=new t.Point(r.targetCenter.x,r.targetCenter.y),n._isCenterChanging=!1,clearInterval(n._targetCenterTimer)):i=new t.Point(r.targetCenter.x*r.targetCenterSpeed+r.center.x*(1-r.targetCenterSpeed),r.targetCenter.y*r.targetCenterSpeed+r.center.y*(1-r.targetCenterSpeed)),n._setCenterInternal(i))},20)}},h.prototype._panning=function(e,t){var n=this,r=n.options;(e!==0||t!==0)&&n._offsetCenter(e,t)},h.prototype._offsetCenter=function(e,n){if(e===0&&n==0)return;var r=this,i=r._coordConverter,s=i.getFullMapSize(),o=(new t.Point(i.getLogicCenter())).offset(e/s.width,n/s.height),u=i.logicToGeographic(o);r._setCenter({x:u.x,y:u.y})},h.prototype._onKeyDown=function(e){var t=this,n=t.options,r=t._coordConverter,i=5,s,o=t._keyCode,u=r.getViewSize(),a=0,f=0;switch(e.which){case o.UP:f=-i;break;case o.DOWN:f=i;break;case o.LEFT:a=-i;break;case o.RIGHT:a=i;break;case o.HOME:a=-u.width;break;case o.END:a=u.width;break;case o.PAGE_UP:f=-u.height;break;case o.PAGE_DOWN:f=u.height;break;default:return!1}if(a!==0||f!==0)s=r.geographicToView(n.targetCenter),t._setTargetCenter(r.viewToGeographic({x:s.x+a,y:s.y+f}));return!0},h.prototype._onKeyPress=function(e){var t=this,n=t.options.targetZoom,r=n;switch(String.fromCharCode(e.which)){case"+":r++;break;case"-":r--;break;default:return!1}return n!==r&&t._setTargetZoom(r),!0},h.prototype._createLayers=function(){var e=this,t=e.options;e._container=n("<div class='"+a+"'></div>").appendTo(e.element),e._multiScaleImageContainer=n('<div class="'+l+" "+f+'"></div>').appendTo(e._container),e._innerSource&&e._createMultiScaleImageLayer(),e._layersContainer=n('<div class="'+l+'"></div>').appendTo(e._container),e._createInnerLayers(),e._toolsLayerContainer=n('<div class="'+l+'"></div>').appendTo(e._container),t.showTools&&e._createToolsLayer(),e._disabledCover=n("<div class='"+a+"'></div>").hide().appendTo(e.element)},h.prototype._createMultiScaleImageLayer=function(){var e=this,t=e.options;e._multiScaleImageContainer.wijmultiscaleimage(e._createMultiscaleimageOptions())},h.prototype._createInnerLayers=function(){var e=this,r=e.options,i=e.element;r.layers&&(e._layers=[],n.each(r.layers,function(n,r){var i=r.type===t.LayerType[3]?r.widgetName:"wij"+r.type+"layer",s=e._createLayer(i,r);s&&e._layers.push({wijname:i,options:r,element:s})}))},h.prototype._createToolsLayer=function(){var e=this,n=e.options;e._toolsLayerContainer.wijtoolslayer({center:new t.Point(n.center.x,n.center.y),zoom:n.targetZoom,minZoom:e._minZoom,maxZoom:e._maxZoom,converter:e._coordConverter}),e._toolsLayerContainer.on("wijtoolslayertargetzoomchanged."+e.widgetName,function(t,r){n.targetZoom!==r.targetZoom&&e._setTargetZoom(r.targetZoom)}).on("wijtoolslayertargetcenterchanged."+e.widgetName,function(t,r){r.targetCenter&&(!n.targetCenter||n.targetCenter.x!==r.targetCenter.x||n.targetCenter.y!==r.targetCenter.y)&&e._setTargetCenter({x:r.targetCenter.x,y:r.targetCenter.y})})},h.prototype._createLayer=function(e,t){var r=this,i=r._createWijlayerOptions(t),s=n('<div class="'+l+'"></div>');return r._layersContainer.append(s),s[e]?s[e](i):null},h.prototype._createWijlayerOptions=function(e){var r=this,i=r.options;return n.extend(new t.wijlayer_options,{disabled:r._isDisabled(),center:new t.Point(i.center.x,i.center.y),zoom:i.zoom,targetCenter:new t.Point(i.targetCenter.x,i.targetCenter.y),targetZoom:i.targetZoom,isZooming:r._isZooming,converter:r._coordConverter},e)},h.prototype._updateLayers=function(){var e=this,r=e.options,i=e._layers,s;e._coordConverter._updateSize(),i&&n.each(i,function(t,n){s=e._createWijlayerOptions(n.options),n.element[n.wijname]("beginUpdate"),n.element[n.wijname](s),n.element[n.wijname]("endUpdate")}),e._innerSource&&e._multiScaleImageContainer.wijmultiscaleimage(e._createMultiscaleimageOptions()),r.showTools&&e._toolsLayerContainer.wijtoolslayer({center:new t.Point(r.center.x,r.center.y),zoom:r.targetZoom,converter:e._coordConverter})},h.prototype._createMultiscaleimageOptions=function(){var e=this,n=e.options;return{source:e._innerSource,zoom:n.zoom,center:e._coordConverter.geographicToLogic(new t.Point(n.center.x,n.center.y))}},h.prototype.refreshLayers=function(){var e=this,t=e.options,r=e._layers;r&&n.each(r,function(e,t){t.element[t.wijname]("refresh")})},h.prototype.viewToGeographic=function(e){return this._coordConverter.viewToGeographic(e)},h.prototype.geographicToView=function(e){return this._coordConverter.geographicToView(e)},h.prototype.viewToLogic=function(e){return this._coordConverter.viewToLogic(e)},h.prototype.logicToView=function(e){return this._coordConverter.logicToView(e)},h.prototype.distance=function(e,t){return this._coordConverter.distance(e,t)},h.prototype.destroy=function(){var e=this,t=e.options,r=e.element;r.removeClass(u),r.removeClass(t.wijCSS.content),r.removeAttr("tabindex"),e.element.off("."+e.widgetName),n(document).off("."+e.widgetName),e._destroyLayers(),c.prototype.destroy.call(this)},h.prototype._destroyLayers=function(){var e=this,t=e.options;e._innerSource&&e._destroyTileLayer(),e._destroyInnerLayers(),t.showTools&&e._destroyToolsLayer(),e._container.remove(),e._disabledCover.remove()},h.prototype._destroyTileLayer=function(){var e=this;e._multiScaleImageContainer.data().wijmoWijmultiscaleimage&&e._multiScaleImageContainer.off("."+e.widgetName).wijmultiscaleimage("destroy")},h.prototype._destroyToolsLayer=function(){var e=this;e._toolsLayerContainer.data().wijmoWijtoolslayer&&this._toolsLayerContainer.off("."+e.widgetName).wijtoolslayer("destroy")},h.prototype._destroyInnerLayers=function(){var e=this;e._layers&&(n.each(e._layers,function(e,t){t.element[t.wijname]("destroy").remove()}),e._layers=null)},h}(e.wijmoWidget);t.wijmaps=c;var h=function(){function e(){this.source="bingMapsRoadSource",this.bingMapsKey="",this.center={x:0,y:0},this.zoom=1,this.showTools=!0,this.targetZoomSpeed=.3,this.targetCenterSpeed=.3,this.layers=[]}return e}();t.wijmaps_options=h,c.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new h),n.wijmo.registerWidget("wijmaps",c.prototype)})(e.maps||(e.maps={}));var t=e.maps})(wijmo||(wijmo={}));