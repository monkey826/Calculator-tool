var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r="wijdatepager",i="wijmo-wijdatepager",s="wijmo-wijdatepager-increment",o="wijmo-wijdatepager-decrement",u="wijmo-wijdatepager-container",a="wijmo-wijdatepager-pages",f="wijmo-wijdatepager-pagelabel",l="wijmo-wijdatepager-pagelabel-first",c="wijmo-wijdatepager-pagelabel-last",h="wijmo-wijdatepager-pageheader",p="wijmo-wijdatepager-pagerange",d="wijmo-wijdatepager-tooltip",v="wijmo-wijdatepager-tooltip-inner",m="wijmo-wijdatepager-triangle",g="wijmo-wijdatepager-width-smallest",y="wijmo-wijdatepager-width-small",b="wijmo-wijdatepager-width-medium",w="wijmo-wijdatepager-width-normal",E=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(t,n){var r=this.options.selectedDate,i=function(e,t){return e&&t&&e.getTime&&t.getTime?e.getTime()===t.getTime():e===t};e.prototype._setOption.call(this,t,n);switch(t){case"culture":case"cultureCalendar":this.options[t]=n,this._innerCulture=null,this._resetCulture(),this._initBackground();break;case"selectedDate":this.options.selectedDate=n,this._initBackground(),i(n,r)||this._onSelectedDateChanged();break;case"viewType":this.options.viewType=n,this._resetPageDates(),this._initBackground();break;case"customViewOptions":this.options.customViewOptions=n,this._resetPageDates(),this._initBackground();break;case"nextTooltip":this.element.find("."+s).attr("title",n);break;case"prevTooltip":this.element.find("."+o).attr("title",n);break;case"firstDayOfWeek":this.options.firstDayOfWeek=n,this.options.viewType==="week"&&this._initBackground()}return this},t.prototype._innerDisable=function(){e.prototype._innerDisable.call(this),this._toggleDisableDatePager(!0)},t.prototype._innerEnable=function(){e.prototype._innerEnable.call(this),this._toggleDisableDatePager(!1)},t.prototype._toggleDisableDatePager=function(e){this.element.toggleClass(this.options.wijCSS.stateDisabled,e),n.mobile==null?(this.element.find("."+o).button("option","disabled",e),this.element.find("."+s).button("option","disabled",e)):(this.element.find("."+o).toggleClass(this.options.wijCSS.stateDisabled,e),this.element.find("."+s).toggleClass(this.options.wijCSS.stateDisabled,e))},t.prototype._create=function(){var t=this.options,r,f,l;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),t.selectedDate||(t.selectedDate=new Date),this._nativeClass=this.element.attr("class"),this._dtpagernamespacekey="dtpager"+(new Date).getTime(),this.element.addClass(i).addClass(t.wijCSS.wijdatepager).addClass(t.wijCSS.widget).addClass(t.wijCSS.helperClearFix),r=n.proxy(this.invalidate,this),n(window).bind("resize."+this._dtpagernamespacekey,r),this.element.disableSelection&&this.element.disableSelection(),this.element.append(n("<a></a>").addClass(o).addClass(t.wijCSS.wijdatepagerDecButton).append(n("<span>"+t.prevTooltip+"</span>"))).append(n("<div></div>").addClass(u).addClass(t.wijCSS.wijdatepagerContainer).addClass(t.wijCSS.content).append(n("<div></div>").addClass(a).addClass(t.wijCSS.wijdatepagerPages))).append(n("<a></a>").addClass(s).addClass(t.wijCSS.wijdatepagerIncButton).append(n("<span>"+t.nextTooltip+"</span>"))),f=this.element.find("."+o),l=this.element.find("."+s),n.mobile==null?(f.button({icons:{primary:t.wijCSS.iconArrowLeft},text:!1}),l.button({icons:{primary:t.wijCSS.iconArrowRight},text:!1})):(f.html(""),f.addClass(t.wijCSS.iconArrowLeft+" "+t.wijCSS.icon+" ui-btn"),l.html(""),l.addClass(t.wijCSS.iconArrowRight+" "+t.wijCSS.icon+" ui-btn")),f.click(n.proxy(this.goLeft,this)),l.click(n.proxy(this.goRight,this)),this._initBackground(),e.prototype._create.call(this)},t.prototype.destroy=function(){var t=this.options.wijCSS;this.element.empty().removeAttr("aria-disabled"),this.element.attr("class",this._nativeClass?this._nativeClass:""),n(window).unbind("."+this._dtpagernamespacekey),n(document).unbind("."+this._dtpagernamespacekey),e.prototype.destroy.call(this)},t.prototype.refresh=function(){this.invalidate()},t.prototype._getCustomViewUnit=function(){var e=this.options,t;return e.customViewOptions.unit?(t=e.customViewOptions.unit.toLowerCase(),n.inArray(t,["day","week","month","year"])?t:"day"):"day"},t.prototype.invalidate=function(){var e=this,t,r=e.options,i=r.selectedDate,l,c=e.element.find("."+u),h=e.element.find("."+o),p=e.element.find("."+s),d=e.element.innerWidth(),v=i,m=h.is(":visible")?h.outerWidth(!0):0,E=p.is(":visible")?p.outerWidth(!0):0,S,x,T,N,C,k,L,A=this._getCustomViewUnit(),O;if(r.viewType.toLowerCase()==="custom"){k=r.customViewOptions.count||1;for(L=0;L<k;L++){switch(A){case"day":O=e._getDateClass(e._addDays(i,-L));break;case"month":O=e._getDateClass(new Date(i.getFullYear(),i.getMonth()-L,1));break;case"year":O=e._getDateClass(new Date(i.getFullYear()-L,0,1));break;default:O=e._getDateClass(v)}t=e.element.find("."+f+"."+O);if(t.length===1)break}}else t=e.element.find("."+f+"."+e._getDateClass(v));t.length!==1?t=n(e.element.find("."+f)[e._index]):(l=this.element.find("."+f).index(t),this._index=l),C="."+f,N=r.wijCSS.stateActive.split(" "),n.each(N,function(e){C+="."+N[e]}),e.element.find(C).removeClass(r.wijCSS.stateActive),t.addClass(e.options.wijCSS.stateActive),c.css("left",m),e.element.removeClass(g).removeClass(r.wijCSS.wijdatepagerWidthSmallest).removeClass(y).removeClass(r.wijCSS.wijdatepagerWidthSmall).removeClass(b).removeClass(r.wijCSS.wijdatepagerWidthMedium).removeClass(w).removeClass(r.wijCSS.wijdatepagerWidthNormal),d<300?e.element.addClass(g).addClass(r.wijCSS.wijdatepagerWidthSmallest):d<475?e.element.addClass(y).addClass(r.wijCSS.wijdatepagerWidthSmall):d<600?e.element.addClass(b).addClass(r.wijCSS.wijdatepagerWidthMedium):e.element.addClass(w).addClass(r.wijCSS.wijdatepagerWidthNormal),c.outerWidth(d-m-E),n.browser.msie&&parseInt(n.browser.version,10)<=7&&(S=e.element.find("."+a),x=S.find("."+f),T=Math.round(S.width()/e._datesDef.length)-(x.outerWidth(!0)-x.width()),x.width(T))},t.prototype.goLeft=function(e){if(this._isDisabled())return;this._setSelectedIndex(this._index-1,!0);if(e)return e.preventDefault(),!1},t.prototype.goRight=function(){if(this._isDisabled())return;this._setSelectedIndex(this._index+1)},t.prototype._getCulture=function(e){return this._innerCulture||this._resetCulture(e),this._innerCulture},t.prototype._resetCulture=function(e){var t=n.wijGetCulture(e||this.options.culture,this.options.cultureCalendar);this._innerCulture=t},t.prototype._isRTL=function(){return!!this._getCulture().isRTL},t.prototype._initBackground=function(e,t){var r=this;typeof e=="undefined"&&(e=!1),typeof t=="undefined"&&(t=!1);var i,s,o,u,d,v=this,m=v.options,g,y=n("<div></div>");if(this._isInAnimate)return;this._index=0,this._datesDef=this._getDatesDefinition(),this._min=0,this._max=this._datesDef.length-1,n.each(this._datesDef,function(e,t){var i=n("<div>"+r._datesDef[e].l+"</div>").addClass(f).addClass(m.wijCSS.wijdatepagerPageLabel).addClass(r._getDateClass(t.d));e===0&&i.addClass(l).addClass(m.wijCSS.wijdatepagerPageLabelFirst),t.range&&i.addClass(p).addClass(m.wijCSS.wijdatepagerPageRange),t.header&&i.addClass(h).addClass(m.wijCSS.wijdatepagerPageHeader).addClass(m.wijCSS.stateHighlight),e===r._max&&i.addClass(c).addClass(m.wijCSS.wijdatepagerPageLabelLast),y.append(i)}),i=y.html(),o=this.element.find("."+a),e?(this._isInAnimate=!0,s=o.clone(!0),o.html(i),u=o.find("."+f),t?(s.insertAfter(o),d=n(u[this._index]).offset().left,o.css("opacity",0).css("left",-s.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),s.css("left",0).stop().animate({left:s.outerWidth(!0)+"px",opacity:0},function(){s.remove(),v._isInAnimate=!1,v.invalidate()})):(s.insertBefore(o),d=n(u[this._index]).offset().left,o.css("opacity",0).css("left",s.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),s.stop().animate({left:"-"+s.outerWidth(!0)+"px",opacity:0},function(){s.remove(),v._isInAnimate=!1,v.invalidate()}))):(o.html(i),this.invalidate()),u=o.find("."+f),u.hover(n.proxy(this._pagelabelHover,this),n.proxy(this._pagelabelHout,this)),u.bind("mousedown",n.proxy(this._pagelabelMouseDown,this)),u.click(n.proxy(function(e){var t=n(e.target),r;r=this.element.find("."+f).index(t),this._setSelectedIndex(r)},this))},t.prototype._getDateClass=function(e){return"c1dt"+e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()},t.prototype._addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},t.prototype._nextYears=function(e,t){return new Date(e.getFullYear()+t,0,1)},t.prototype._nextMonths=function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,1)},t.prototype._getDatesDefinition=function(){var e=this,t=e.options,n=t.viewType.toLowerCase(),r,i,s,o,u,a=[],f,l=t.selectedDate,c=t.maxDateGroup||6,h,p,d,v,m=t.customViewOptions.count||1;switch(n){case"week":s=new Date(l.getFullYear(),l.getMonth(),-6),r=t.firstDayOfWeek-s.getDay(),Math.abs(r)>6&&(r=s.getDay()-t.firstDayOfWeek),s=e._addDays(s,r),u=new Date(l.getFullYear(),l.getMonth()+1,7),r=0;while(s<=u||s.getMonth()===l.getMonth())o=e._addDays(s,7),a.push({l:e._formatString(e.localizeString("weekViewLabelFormat","{0:MMM dd}-{1:dd}"),s,e._addDays(s,6)),d:s,d2:e._addDays(s,6)}),l>=s&&l<=o&&(e._index=r),s=o,r+=1;break;case"month":i=new Date(l.getFullYear()-1,0,1),a.push({l:e._formatString(e.localizeString("monthViewYearLabelFormat","{0:yyyy}"),i),d:i,range:!0}),i=new Date(l.getFullYear(),0,1),a.push({l:e._formatString(e.localizeString("monthViewYearLabelFormat","{0:yyyy}"),i),d:i,header:!0});for(r=0;r<12;r+=1)i=new Date(l.getFullYear(),r,1),a.push({l:e._formatString(e.localizeString("monthViewLabelFormat","{0:MMM}"),i),d:i}),o=new Date(l.getFullYear(),r+1,1),l>=i&&l<=o&&(e._index=r+2);i=new Date(l.getFullYear()+1,0,1),a.push({l:e._formatString(e.localizeString("monthViewYearLabelFormat","{0:yyyy}"),i),d:i,range:!0});break;case"custom":v=e._getCustomViewUnit(),h=(v==="week"?7:1)*m,s=e._getDateAfterAdjusting(-c*h/2),u=e._getDateAfterAdjusting(c*h/2);if(!e._shouldResetDates(s,u))return e._datesDef;r=0;while(s<=u){switch(v){case"week":f=t.firstDayOfWeek-s.getDay(),s=e._addDays(s,f),u=e._addDays(u,f);case"day":o=e._addDays(s,h),p=e._addDays(s,h-1),m===1&&v==="day"?d=e.localizeString("customViewUnitSingleDayLabelFormat","{0:MMM dd}"):s.getMonth()===p.getMonth()?d=e.localizeString("customViewUnitDayLabelFormat","{0:MMM dd}-{1:dd}"):d=e.localizeString("customViewUnitDayLabelFormat2Months","{0:MMM dd}-{1:MMM dd}");break;case"month":o=e._nextMonths(s,m),p=e._nextMonths(s,m-1),m===1?d=e.localizeString("customViewUnitSingleMonthLabelFormat","{0:MMM}"):s.getFullYear()===p.getFullYear()?d=e.localizeString("customViewUnitMonthLabelFormat","{0:MMM}-{1:MMM, yyyy}"):d=e.localizeString("customViewUnitMonthLabelFormat2Years","{0:MMM yyyy}-{1:MMM yyyy}");break;case"year":o=e._nextYears(s,m),p=e._nextYears(s,m-1),m===1?d=e.localizeString("customViewUnitSingleYearLabelFormat","{0:yyyy}"):d=e.localizeString("customViewUnitYearLabelFormat","{0:yyyy}-{1:yyyy}")}a.push({l:e._formatString(d,s,p),d:s,d2:p}),l>=s&&l<=o&&(e._index=r),s=o,r+=1}e._resetPageDates(a[0].d,a[a.length-1].d);break;default:i=new Date(l.getFullYear(),l.getMonth(),0),a.push({l:e._formatString(e.localizeString("dayViewMonthLabelFormat","{0:MMM}"),i),d:i,range:!0}),i=new Date(l.getFullYear(),l.getMonth(),1),a.push({l:e._formatString(e.localizeString("dayViewMonthLabelFormat","{0:MMM}"),i),d:i,header:!0}),s=i,r=2;while(s.getMonth()===l.getMonth())o=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1),a.push({l:e._formatString(e.localizeString("dayViewLabelFormat","{0:d }"),s),d:s}),l>=s&&l<=o&&(e._index=r),s=o,r+=1;i=new Date(l.getFullYear(),l.getMonth()+1,1),a.push({l:e._formatString(e.localizeString("dayViewMonthLabelFormat","{0:MMM}"),i),d:i,range:!0})}return a},t.prototype._getDateAfterAdjusting=function(e){var t=this,n=t.options,r=n.selectedDate,i=r.getFullYear(),s=r.getMonth();switch(t._getCustomViewUnit()){case"day":case"week":return new Date(i,s,r.getDate()+e);case"month":return new Date(i,s+e,1);case"year":return new Date(i+e,0,1)}},t.prototype._resetPageDates=function(e,t){this._startDate=e||null,this._endDate=t||null},t.prototype._shouldResetDates=function(e,t){var n=this,r=n.options,i=r.selectedDate;return!n._startDate||!n._endDate?(n._resetPageDates(e,t),!0):n._startDate<new Date(i.getFullYear(),i.getMonth(),i.getDate())&&n._endDate>new Date(i.getFullYear(),i.getMonth(),i.getDate())?!1:(n._resetPageDates(e,t),!0)},t.prototype._setSelectedIndex=function(e,t){typeof t=="undefined"&&(t=!1);var n=this.options,r;if(this._isDisabled())return;if(e>=this._min&&e<=this._max){this._dragActivated&&this._showTooltip(e);if(this._index!==e){if(this._datesDef[e].header){if(!t)return;e-=1}this._index=e,r=this._datesDef[e].d,n.selectedDate=r,this._max>2&&this._index===0?this._initBackground(!0,!0):this._index===this._max?(n.viewType==="week"&&(n.selectedDate=new Date(n.selectedDate.getFullYear(),n.selectedDate.getMonth(),n.selectedDate.getDate()+7)),this._initBackground(!0,!1),n.selectedDate=r):this.invalidate(),this._onSelectedDateChanged()}}},t.prototype._onSelectedDateChanged=function(){var e=this.options;this._trigger("selectedDateChanged",null,{selectedDate:e.selectedDate})},t.prototype._pagelabelHover=function(e){var t=n(e.target),r=this.options;if(t.hasClass(h))return;t.addClass(r.wijCSS.stateHover)},t.prototype._showTooltip=function(e){var t=this,r=t.options,i=t._datesDef[e],s=r.viewType,o,u=this.element.find("."+f)[e],a=t._getCustomViewUnit(),l=r.customViewOptions.count||1;t._tooltip||(t._tooltip=n("<div></div>").addClass(d).addClass(r.wijCSS.wijdatepagerTooltip).append(n("<div></div>").addClass(v).addClass(r.wijCSS.wijdatepagerTooltipInner)).append(n("<div></div>").addClass(m).addClass(r.wijCSS.wijdatepagerTriangle)),t.element.append(t._tooltip),t._tooltip.wijpopup());switch(s){case"week":i.d.getMonth()!==i.d2.getMonth()?o=t._formatString(t.localizeString("weekViewTooltip2MonthesFormat","{0:MMMM d} - {1:MMMM d, yyyy}"),i.d,i.d2):o=t._formatString(t.localizeString("weekViewTooltipFormat","{0:MMMM d} - {1:d, yyyy}"),i.d,i.d2);break;case"month":o=t._formatString(t.localizeString("monthViewTooltipFormat","{0:MMMM yyyy}"),i.d);break;case"custom":a==="day"||a==="week"?l===1?o=t._formatString(t.localizeString("customViewSingleDayTooltipFormat","{0:MMMM d yyyy}"),i.d):i.d.getMonth()!==i.d2.getMonth()?o=t._formatString(t.localizeString("customViewDayUnitTooltip2MonthesFormat","{0:MMMM d} - {1:MMMM d, yyyy}"),i.d,i.d2):o=t._formatString(t.localizeString("customViewDayTooltipFormat","{0:MMMM d} - {1:d, yyyy}"),i.d,i.d2):a==="month"?l===1?o=t._formatString(t.localizeString("customViewSingleMonthTooltipFormat","{0:MMMM yyyy}"),i.d):i.d.getFullYear()!==i.d2.getFullYear()?o=t._formatString(t.localizeString("customViewMonthTooltip2YearsFormat","{0:MMMM yyyy} - {1:MMMM yyyy}"),i.d,i.d2):o=t._formatString(t.localizeString("customViewMonthTooltipFormat","{0:MMMM} - {1:MMMM, yyyy}"),i.d,i.d2):a==="year"&&(l===1?o=t._formatString(t.localizeString("customViewSingleYearTooltipFormat","{0:yyyy}"),i.d):o=t._formatString(t.localizeString("customViewYearTooltipFormat","{0:yyyy} - {1:yyyy}"),i.d,i.d2));break;default:o=this._formatString(t.localizeString("dayViewTooltipFormat","{0:dddd, MMMM d, yyyy}"),i.d)}n.ui&&(t._tooltip.wijpopup("show",{of:u,my:"center bottom",at:"center top",offset:"-10 -10"}),t._tooltip.find("."+v).html(o))},t.prototype._hideTooltip=function(){this._tooltip.wijpopup("hide")},t.prototype._pagelabelHout=function(e){n(e.target).removeClass(this.options.wijCSS.stateHover)},t.prototype._pagelabelMouseDown=function(e){this._dragActivated=!1;if(this._isDisabled())return;e.preventDefault();var t=n(e.target),r;if(t.hasClass(h))return;r=this.element.find("."+f).index(t),this._dragActivated=!0,this._setSelectedIndex(r),this._mouseDownTimeFix20555=(new Date).getTime(),this._startClientX=e.pageX,this._startInd=r,n(document).bind("mousemove."+this._dtpagernamespacekey,n.proxy(this._pageindicatorMouseMove,this)),n(document).bind("mouseup."+this._dtpagernamespacekey,n.proxy(this._pageindicatorMouseUp,this))},t.prototype._detectLeftButton=function(e){return e.originalEvent&&(e=e.originalEvent),"buttons"in e?e.buttons===1:"which"in e?e.which===1:e.button===1},t.prototype._pageindicatorMouseMove=function(e){if(!this._detectLeftButton(e)){this._pageindicatorMouseUp();return}e.preventDefault();if(this._isInAnimate)return;var t=this.element.find("."+f)[this._startInd],n,r;if(!t)return;n=t.offsetLeft+Math.round(t.offsetWidth/2)+(e.pageX-this._startClientX),r=this._findClosesPageIndexByPos(n);if(this._prevMoveInd===r)return;this._prevMoveInd=r;if(this._mouseDownTimeFix20555+150>(new Date).getTime())return;r!==-1&&r!==this._index&&this._setSelectedIndex(r)},t.prototype._pageindicatorMouseUp=function(){this._dragActivated=!1,n(document).unbind("."+this._dtpagernamespacekey),this._hideTooltip()},t.prototype._findClosesPageIndexByPos=function(e){var t=this.element.find("."+a).find("."+f),n;for(n=0;n<t.length;n+=1)if(t[n].offsetLeft<e&&t[n].offsetLeft+t[n].offsetWidth>e)return n;return-1},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t.prototype._formatString=function(e,t,n,r){var i,s=arguments,o,u,a=this;if(s.length<=1)return Globalize.format(s);typeof e=="string"&&typeof window[e]=="function"&&(e=window[e]);if(typeof e=="function"){u=[];for(o=1;o<s.length;o+=1)u[o-1]=s[o];return e.apply(this,u)}return i=new RegExp("\\{(\\d+)(?:,([-+]?\\d+))?(?:\\:([^(^}]+)(?:\\(((?:\\\\\\)|[^)])+)\\)){0,1}){0,1}\\}","g"),e.replace(i,function(e,t,n,r,i){return e=s[Number(t)+1],r?Globalize.format(e,r,a._getCulture()):e})},t}(e.wijmoWidget);t.wijdatepager=E;var S=function(){function e(){this.wijCSS={wijdatepager:"",wijdatepagerIncButton:"",wijdatepagerDecButton:"",wijdatepagerContainer:"",wijdatepagerPages:"",wijdatepagerPageLabel:"",wijdatepagerPageLabelFirst:"",wijdatepagerPageLabelLast:"",wijdatepagerPageHeader:"",wijdatepagerPageRange:"",wijdatepagerTooltip:"",wijdatepagerTooltipInner:"",wijdatepagerTriangle:"",wijdatepagerWidthSmallest:"",wijdatepagerWidthSmall:"",wijdatepagerWidthMedium:"",wijdatepagerWidthNormal:""},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-b",stateDefault:"ui-btn ui-btn-b"},this.initSelector=":jqmData(role='wijdatepager')",this.culture="",this.cultureCalendar="",this.localization=null,this.firstDayOfWeek=0,this.maxDateGroup=6,this.selectedDate=null,this.viewType="day",this.customViewOptions={unit:"day",count:1},this.nextTooltip="right",this.prevTooltip="left",this.selectedDateChanged=null}return e}();E.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new S),n.wijmo.registerWidget(r,E.prototype)})(e.datepager||(e.datepager={}));var t=e.datepager})(wijmo||(wijmo={}));