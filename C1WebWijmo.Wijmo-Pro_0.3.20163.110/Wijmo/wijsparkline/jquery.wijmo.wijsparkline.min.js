var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r="wijsparkline",i={line:{stroke:"#5b8f00","stroke-width":1,opacity:.9},area:{stroke:"#009999","stroke-width":1,fill:"#0099ff","fill-opacity":.5},column:{stroke:"none",fill:"#0099ff","fill-opacity":.9,negStyle:{fill:"#ff0000"},zeroStyle:{fill:"#808080"}}},s=function(){function e(e){this._hOffset=15,this._vOffset=-15,this._tooltipEle=n("<div style='position:absolute' class='wijmo-wijsparkline-tooltip'></div>"),this._tooltipEle.appendTo("body").hide()}return e.prototype.show=function(e,t){this._tooltipEle.css({left:t.originalLeft+this._hOffset,top:t.originalTop+this._vOffset}).empty().append(e),this._tooltipEle.is(":hidden")&&this._tooltipEle.show()},e.prototype.hide=function(){this._tooltipEle.hide()},e.prototype.destroy=function(){this._tooltipEle.remove(),this._tooltipEle=null},e}();t.SparklineTooltip=s;var o=function(t){function o(){t.apply(this,arguments)}return __extends(o,t),o.prototype._create=function(){var e=this,r=e.options,i=r.width||e.element.width(),s=r.height||e.element.height(),o=e.element.attr("style"),u,a;e.wrapper=n("<div class='ui-widget "+r.wijCSS.sparkline+"'></div>").attr("style",o||""),i&&e.wrapper.css("width",i),s&&e.wrapper.css("height",s),e.canvasWrapper=n("<div class='"+r.wijCSS.canvasWrapper+"'></div>"),e.element.wrap(e.wrapper).after(e.canvasWrapper).hide();if(e.canvasWrapper.is(":hidden")&&e.canvasWrapper.wijAddVisibilityObserver){if(e.canvasWrapper.hasClass("wijmo-wijobserver-visibility"))return;e.canvasWrapper.wijAddVisibilityObserver(function(){e.redraw(),e.canvasWrapper.wijRemoveVisibilityObserver&&e.canvasWrapper.wijRemoveVisibilityObserver()},"wijsparkline")}r.data?e.data=r.data:(a=e.element.html(),e.data=a.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")),u=Raphael(e.canvasWrapper[0],i,s),e.canvas=u,e.canvasWrapper.is(":visible")&&e._render(),t.prototype._create.call(this)},o.prototype._setOption=function(e,n){var r=this.options;e==="height"||e==="width"?(r[e]=n,this.element[e](n)):e==="data"?this.data=r.data=n:t.prototype._setOption.call(this,e,n),this.redraw()},o.prototype._innerDisable=function(){t.prototype._innerDisable.call(this),this._toggleDisableSparkline(!0)},o.prototype._innerEnable=function(){t.prototype._innerEnable.call(this),this._toggleDisableSparkline(!1)},o.prototype._toggleDisableSparkline=function(e){this.element.parent().toggleClass(this.options.wijCSS.stateDisabled,e)},o.prototype._render=function(){var e=this,t=e.options,r=t.type,i=t.seriesList,s=t.seriesStyles?t.seriesStyles.length:0,o;e.seriesRegionInfos=[],e.canvas.clear(),e.canvasBounds={startX:0,width:t.width||this.element.width()||this.canvasWrapper.width(),startY:0,height:t.height||this.element.height()||this.canvasWrapper.height()},r=r&&r!==""?r.toLowerCase():"line",e.containsColumnType=r==="column"||n.grep(i,function(e){return e.type&&e.type.toLowerCase()==="column"}).length>0,i&&i.length>0?n.each(i,function(n,i){var u=i.type&&i.type!==""?i.type.toLowerCase():r;o=s>0?t.seriesStyles[n%s]:null,e._internalRender(i,t,u,o)}):(o=s>0?t.seriesStyles[0]:null,e._internalRender(null,t,r,o)),e._bindCanvasEvents()},o.prototype._internalRender=function(t,r,s,o){var u,a,f,l,c=i[s];o=n.extend({},c,o,t?t.seriesStyle:null),f=t&&t.data?t.data:this.data,t&&t.columnWidth!==undefined&&t.columnWidth!==null&&typeof t.columnWidth=="number"?l=t.columnWidth:l=r.columnWidth,u=new e.sparkline[s+"Render"](this.element,this.canvas,s,{data:f,min:r.min,max:r.max,valueAxis:r.valueAxis,origin:r.origin,animation:r.animation,bind:t?t.bind||r.bind:r.bind,seriesStyle:o,columnWidth:l,canvasBounds:this.canvasBounds});if(!u.isValid())return!0;u.render(),a={type:s,bind:t?t.bind:null,regionInfos:u.getRegionInfos()},s==="column"&&(this.colunmWidth=u.getColumnWidth()),this.seriesRegionInfos.push(a)},o.prototype.redraw=function(){var e=this.options,t=0,n=0;t=e.width||this.element.width()||this.canvasWrapper.width(),n=e.height||this.element.height()||this.canvasWrapper.height();if(t<1||n<1)return;this.canvas.setSize(t,n),this._render()},o.prototype.destroy=function(){this._unbindCanvasEvents(),this.element.unwrap().show(),this.canvas.clear(),this.wrapper=null,this.canvasWrapper.remove(),this.canvasWrapper=null,this.seriesRegionInfos=[],this.canvasBounds=null,this.tooltip&&(this.tooltip.destroy(),this.tooltip=null),t.prototype.destroy.call(this)},o.prototype._bindCanvasEvents=function(){var e=this,t=e.options,i=e.canvasWrapper,s="",o="."+r;if(!i||!e.canvas)return;n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(window.navigator.pointerEnabled?this.element.css("touch-action","none"):window.navigator.msPointerEnabled&&this.element.css("-ms-touch-action","none")),n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(s="wij"),i.bind(s+"mousemove"+o,function(t){var n=e._getMousePosition(i,t),r=e._isDisabled();if(r)return;e._mouseMoveInsideArea(n)}),i.bind(s+"mouseout"+o,function(t){var n=t.currentTarget,r=t.relatedTarget?t.relatedTarget:t.toElement,i=e._isDisabled();if(i)return;if(n.nodeName.toLowerCase()!=="div")return;while(r&&r!==n&&r.nodeName.toLowerCase()!=="body")r=r.parentNode;if(r===n)return;e._mouseOutInsideArea()}),i.bind(s+"click"+o,function(t){var n=e._getMousePosition(i,t),r=e._isDisabled(),s=[];if(r)return;s=e._getCurrentRegionInfos(n),e._trigger("click",null,{currentRegion:s})})},o.prototype._getMousePosition=function(e,t){var n=e.offset(),r=document.compatMode==="CSS1Compat",i=r?t.pageX:t.clientX,s=r?t.pageY:t.clientY,o={left:i-n.left,originalLeft:i,top:s-n.top,originalTop:s};return o},o.prototype._mouseMoveInsideArea=function(e){var t=this,r=t.options,i=r.tooltipFormat,s=r.tooltipContent,o="",u=[],a=NaN;u=t._getCurrentRegionInfos(e),u.length>0&&(n.each(u,function(e,r){var f;e===0&&(o+="<span>"),s&&n.isFunction(s)?f=n.proxy(s,t.data[r.index])():(r.bind&&(o+=r.bind+": "),i?f=i.replace(/\{(\d+)\}/g,r.value.toString()):f=r.value.toString()),o+=f,e<u.length-1?o+="<br />":o+="</span>";if(isNaN(a))if(t.containsColumnType)r.type==="column"&&(a=r.position.x+t.colunmWidth/2);else if(r.type==="line"||r.type==="area")a=r.position.x}),this._paintTooltip(o,e),this._paintIndicatorLine(a)),this._trigger("mouseMove",null,{currentRegion:u})},o.prototype._mouseOutInsideArea=function(){this.tooltip&&this.tooltip.hide(),this.indicatorLine&&(this.indicatorLine.wijRemove(),this.indicatorLine=null)},o.prototype._getCurrentRegionInfos=function(e){var t=this,r=[];return n.each(this.seriesRegionInfos,function(n,i){var s,o="_"+i.type+"GetCurrentRegionInfo",u=t[o];u&&(s=u.call(t,i,e),s&&(s.type=i.type,s.bind=i.bind,r.push(s)))}),r},o.prototype._lineGetCurrentRegionInfo=function(e,t){var r=e.regionInfos,i,s;if(!r)return;return i=r.length,n.each(r,function(e,n){var o=n.position,u,a;if(e<i-1){u=r[e+1],a=u.position;if(t.left>=o.x&&t.left<a.x)return s=n,s.index=e,!1}else if(t.left>=o.x)return s=n,s.index=e,!1}),s},o.prototype._areaGetCurrentRegionInfo=function(e,t){return this._lineGetCurrentRegionInfo(e,t)},o.prototype._columnGetCurrentRegionInfo=function(e,t){return this._lineGetCurrentRegionInfo(e,t)},o.prototype._pieGetCurrentRegionInfo=function(e,t){return null},o.prototype._bulletGetCurrentRegionInfo=function(e,t){return null},o.prototype._unbindCanvasEvents=function(){n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(window.navigator.pointerEnabled?this.element.css("touch-action",""):window.navigator.msPointerEnabled&&this.element.css("-ms-touch-action","")),this.element.unbind("."+r)},o.prototype._paintTooltip=function(e,t){this.tooltip||(this.tooltip=new s(this.options.tooltipStyle)),this.tooltip.show(e,t)},o.prototype._paintIndicatorLine=function(e){var t,n,r,i;this.indicatorLine?this.indicatorLine.transform("T"+e+" 0"):(t=this.canvasBounds.height,n=this.canvasBounds.startX,r=this.canvasBounds.startY,i=["M",n,r,"V",t],this.indicatorLine=this.canvas.path(i.join(" ")),this.indicatorLine.transform("T"+e+" 0"))},o}(e.wijmoWidget);t.wijsparkline=o;var u=function(){function e(e,t,n,r){this.isValidData=!0,this.values=[],this.type=n,this.options=r,this.element=e,this.canvas=t,this.animationSet=t.set(),this.scanValues(),this.options.min===null||this.options.min===undefined||typeof this.options.min!="number"?this.minValue=Math.min.apply(Math,this.values):this.minValue=this.options.min,this.options.max===null||this.options.max===undefined||typeof this.options.max!="number"?this.maxValue=Math.max.apply(Math,this.values):this.maxValue=this.options.max}return e.prototype.render=function(){if(!this.element||!this.canvas)return},e.prototype.playAnimation=function(){var e=this.options,t=e.canvasBounds,n=e.animation;this.animationSet.length>0&&n&&n.enabled&&(this.animationSet.wijAttr("clip-rect",Raphael.format("{0} {1} 0 {2}",t.startX,t.startY,t.height)),this.animationSet.wijAnimate({"clip-rect":Raphael.format("{0} {1} {2} {3}",t.startX,t.startY,t.width,t.height)},n.duration,n.easing,null))},e.prototype.scanValues=function(){var e=this,t=e.options,r=t.bind,i=t.data;n.isArray(i)&&n.each(i,function(t,n){var i;r&&n&&n[r]!==undefined?i=n[r]:i=n,typeof i=="string"&&(i=parseFloat(i));if(isNaN(i))return e.isValidData=!1,!1;e.values.push(i)})},e.prototype.setRegionInfos=function(){var e=this,t=0,r=e.options.canvasBounds.height,i=e.options.canvasBounds.width,s;if(!e.values||e.values.length===0)return;this.regionInfos||(this.regionInfos=[]),s=e.values.length,t=e.maxValue-e.minValue,e.valRange=t=t===0?1:t,n.each(e.values,function(n,o){var u,a;u=n*(i/s),a=r*(1-(o-e.minValue)/t),e.regionInfos.push({value:o,position:{x:u,y:a}})})},e.prototype.getRegionInfos=function(){return(!this.regionInfos||this.regionInfos.length===0)&&this.setRegionInfos(),this.regionInfos},e.prototype.getColumnWidth=function(){return null},e.prototype.isValid=function(){return this.isValidData},e}();t.sparklineRenderBase=u;var a=function(e){function t(t,n,r,i){e.call(this,t,n,r,i),this.regionInfos=[]}return __extends(t,e),t.prototype.render=function(){var t=this.options,r=[];e.prototype.render.call(this),this.setRegionInfos(),this.regionInfos&&this.regionInfos.length>0&&(n.each(this.regionInfos,function(e,t){var n=t.position;e===0?r.push("M"):r.push("L"),r.push(n.x),r.push(n.y)}),r.length>0&&(this.line=this.canvas.path(r.join(" ")),this.line.wijAttr(t.seriesStyle),this.line.wijAttr("fill","none"),this.animationSet.push(this.line),this.type==="line"&&this.playAnimation()))},t}(u);t.lineRender=a;var f=function(e){function t(t,n,r,i){e.call(this,t,n,r,i)}return __extends(t,e),t.prototype.render=function(){var t=this.options.canvasBounds.height,r=this.maxValue,i=this.minValue,s=this.options.origin,o,u,a,f;e.prototype.render.call(this);if(this.options.valueAxis){if(s===null||s===undefined||typeof s!="number")s=(r-i)/2+i;u=t*(1-(s-this.minValue)/this.valRange)}else u=t;a=Raphael.parsePathString(this.line.attr("path")),a&&a.length>0&&(f=[],n.each(a,function(e,t){n.each(t,function(e,t){f.push(t)}),t[0]==="M"&&(o=t[1]),e===a.length-1&&(f.push("V"),f.push(u),f.push("H"),f.push(o),f.push("Z"))})),f.length>0&&(this.area=this.canvas.path(f.join(" ")),this.area.wijAttr(this.options.seriesStyle),this.area.wijAttr("stroke","none"),this.animationSet.push(this.area),this.playAnimation())},t}(a);t.areaRender=f;var l=function(e){function t(t,n,r,i){e.call(this,t,n,r,i),this.animateBars=[]}return __extends(t,e),t.prototype.render=function(){var t=this,r=this,i=r.maxValue,s=r.minValue,o=r.canvas,u=r.options,a=u.origin,f=u.animation,l=u.canvasBounds.height,c=u.seriesStyle,h=u.seriesStyle.negStyle,p=u.seriesStyle.zeroStyle,d,v,m;e.prototype.render.call(this),r.setRegionInfos(),delete c.zeroStyle,delete c.negStyle,h=n.extend({},c,h),p=n.extend({},c,p),this.columnWidth=r.adjustColumnWidth(),d=l/r.valRange,v=f&&f.enabled;if(u.valueAxis){if(a===null||a===undefined||typeof a!="number")a=(i-s)/2+s;m=(i-a)*d}else m=l;r.regionInfos&&r.regionInfos.length>0&&(n.each(r.regionInfos,function(e,n){var i,f,g,y,b,w,E=n.position.x,S=n.value;u.valueAxis?S>=a?(w=S===a,b=w?n.position.y-2*d:n.position.y,i=v?m:n.position.y,f=w?2*d:(S-a)*d,g=w?p:c):(b=i=m,f=(a-S)*d,g=h):(w=S===s,b=w?n.position.y-2*d:n.position.y,i=m,f=w?2*d:l-n.position.y,g=w?p:c),y=o.rect(E,i,t.columnWidth,f),y.wijAttr(g),y.top=b,y.height=f,r.animateBars.push(y)}),r.playAnimation())},t.prototype.playAnimation=function(){var e=this.options,t=e.animation;t&&t.enabled?this.animateBars.length>0&&n.each(this.animateBars,function(e,n){var r={height:n.height,y:n.top};n.wijAttr({height:0}),n.stop().wijAnimate(r,t.duration,t.easing,null)}):this.animateBars.length>0&&n.each(this.animateBars,function(e,t){var n={height:t.height,y:t.top};t.wijAttr(n)})},t.prototype.adjustColumnWidth=function(){var e=this.options,t=e.columnWidth,n=e.canvasBounds.width,r=2,i;return i=n/this.values.length-r,t>i?i:t},t.prototype.getColumnWidth=function(){return this.columnWidth},t}(u);t.columnRender=l;var c=function(){function e(){this.initSelector=":jqmData(role='wijsparkline')",this.wijCSS={sparkline:"wijmo-wijsparkline",canvasWrapper:"wijmo-sparkline-canvas-wrapper"},this.type="line",this.seriesList=[],this.width=null,this.height=null,this.data=null,this.bind=null,this.seriesStyles=[],this.animation={enabled:!0,duration:2e3,easing:"easeInCubic"},this.valueAxis=!1,this.origin=null,this.min=null,this.max=null,this.columnWidth=10,this.tooltipFormat=null,this.tooltipContent=null,this.mouseMove=null,this.click=null,this.disabled=!1}return e}();o.prototype.options=n.extend(!0,{},o.prototype.options,new c),o.prototype.widgetEventPrefix="wijsparkline",n.wijmo.registerWidget("wijsparkline",o.prototype)})(e.sparkline||(e.sparkline={}));var t=e.sparkline})(wijmo||(wijmo={}));