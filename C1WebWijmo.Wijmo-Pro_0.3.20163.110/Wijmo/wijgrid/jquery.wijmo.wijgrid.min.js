var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){function r(e,t){var r=n.extend(!0,{},e,t);return delete r.constructor,r}var n=jQuery;t.extendWidgetOptions=r;var i=function(r){function i(){r.apply(this,arguments),this.mDataOffset=0,this.mRowOuterHeight=-1,this._windowResizeTimer=0,this.mEditSkechRowIndex=-1,this.mCurrentCellLocker=!1}return __extends(i,r),i.prototype._createWidget=function(t,n){e.grid.DataOptionPersister.persistAndClearIntoElement(n,t),r.prototype._createWidget.apply(this,arguments),e.grid.DataOptionPersister.restoreFromElement(this.element[0],t,!0)},i.prototype._create=function(){var r=this;if(!this.element.is("table"))throw"invalid markup";this.mAdjustHeaderText=!0,this.mSplitDistanceX=0,this.mSplitDistanceY=0,this.mCurrentCellLocker=!1,this._windowResizeTimer=0,this.mDataOffset=0,this.mScrollingState={x:null,y:null,index:0,scrollLeft:0},this.mRowOuterHeight=-1,this._initialized=!1,this.mDestroyed=!1,this._rendered=!1,this._eventUID=undefined,this.mDataViewWrapper=undefined,this._originalHtml=undefined,this._originalAttr=undefined,this._originalCssText=undefined,this.mAutoHeight=undefined,this.mAutoWidth=undefined,this.mRenderCounter=0,this.mSuperPanelHeader=undefined,this.mTopPagerDiv=undefined,this.mBottomPagerDiv=undefined,this.$groupArea=undefined,this.mUID=undefined,this.mWijDataView=undefined,this.mOuterDiv=undefined,this.mSketchTable=undefined,this.mCellFormatter=undefined,this.mRowStyleFormatter=undefined,this.mCellStyleFormatter=undefined,this._eventUID=e.grid.getUID(),this._spinnerActivated=!1,this.mDeficientFilters={},this.mRenderableColumns=new t.renderableColumnsCollection,this.mDetails=[],this.mLoadingDetails=0,this._isDetail()&&(this.mMasterInfo=this.element.data(i.JQDATA_MASTER_INFO_KEY),this.element.removeData(i.JQDATA_MASTER_INFO_KEY),this.mIgnoreSizing=!0),this.options=n.extend(!0,{},this.options),n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options),e.grid.DataOptionPersister.restoreFromElement(this.element[0],this.options),window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._initialized=!1,this.mDestroyed=!1,this.mClosestCulture=n.wijGetCulture(this.options.culture,this.options.cultureCalendar),this.mDataViewWrapper=new e.grid.dataViewWrapper(this),this._originalHtml=this.element.html(),this._originalAttr={},this._originalCssText=this.element[0].style.cssText,this.element.addClass(i.CSS.root),this.element.wrap('<div class="'+this.options.wijCSS.widget+" "+i.CSS.wijgrid+" "+this.options.wijCSS.wijgrid+" "+i.CSS.outerDivMarker+" "+this.options.wijCSS.content+" "+this.options.wijCSS.cornerAll+'"></div>'),this.mOuterDiv=this.element.parent();var s=this.element[0].style.height,o=this.element[0].style.width;if(this._isDetail()){var u=this.options;s=u.height||u.height===0?u.height+"":s,o=u.width||u.width===0?u.width+"":o}s&&this.mOuterDiv.css("height",s),o&&this.mOuterDiv.css("width",o),this.mAutoHeight=s==""||s=="auto",this.mAutoWidth=o==""||o=="auto",this.mResizeOnWindowResize=this.mAutoHeight||(s+"").indexOf("%")>0||this.mAutoWidth||(o+"").indexOf("%")>0,this.element.css({height:"",width:""}),this.options.disabled&&this.disable(),this.mCellFormatter=new e.grid.cellFormatterHelper,this.mRowStyleFormatter=new e.grid.rowStyleFormatterHelper(this),this.mCellStyleFormatter=new e.grid.cellStyleFormatterHelper(this),this._viewPortBounds({start:0,end:0,startX:0,endX:0}),this._allowVVirtualScrolling()&&(this._viewPortBounds().start=this.mScrollingState.index,this._serverSideVirtualScrolling()&&(this.mDataOffset=this.mScrollingState.index)),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(e){r._initialized&&!r.mDestroyed&&e.target!==r.mOuterDiv[0]&&r.element.is(":visible")&&r.setSize()},"wijgrid"),this._winOrientation=e.grid.getWindowOrientation(),this.mRenderCounter=0},i.prototype._destroy=function(){var t=this;try{this.element.wijRemoveVisibilityObserver&&this.element.wijRemoveVisibilityObserver(),this._view().dispose(),this._detachEvents(!0),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._dragndropui&&(this._dragndropui.dispose(),this._dragndropui=null),this.mDataViewWrapper.dispose(),this.mCellFormatter&&(this.mCellFormatter.dispose(),this.mCellFormatter=null),e.grid.remove$dataByPrefix(this.element,this.mDataPrefix),this.element.insertBefore(this.mOuterDiv),this.mOuterDiv.remove(),this.element.html(this._originalHtml),n.each(this._originalAttr,function(e,n){n===undefined?t.element.removeAttr(e):t.element.attr(e,n)}),this.element.removeClass(e.grid.wijgrid.CSS.root),this.element[0].style.cssText=this._originalCssText}finally{this.mDestroyed=!0}},i.prototype._init=function(){this.mSuperPanelHeader=null,this.mTopPagerDiv=null,this.mBottomPagerDiv=null,this.$groupArea=null,this._prevHoveredSketchRowIndex=-1,this.mClosestCulture=n.wijGetCulture(this.options.culture,this.options.cultureCalendar),this.options.data||(this.mTHead||(this.mTHead=this._readTableSection(this.element,1,this.options.readAttributesFromData)),this.mTFoot||(this.mTFoot=this._readTableSection(this.element,3,this.options.readAttributesFromData))),this._initialized=this._initialized||!1,this._isDetail()&&this._validateRelation(this.options.relation),this.ensureControl(!0)},i.prototype._setOption=function(e,t){var n=this["_preset_"+e],i=this.options[e],s,o;n!==undefined&&(t=n.apply(this,[t,i])),s=t!==i||e.toLowerCase()==="data"||e.toLowerCase()==="columns",r.prototype._setOption.apply(this,[e,t]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[t,i]))},i.prototype.columns=function(){return this.mVisibleLeaves||[]},i.prototype._setColumns=function(e){this.mVisibleLeaves=e},i.prototype.currentCell=function(t,n,r){var i,s=this._view(),o=this._rows();if(arguments.length===0)return i=this._currentCell(),i||this._currentCell(i=e.grid.cellInfo.outsideValue),i;i=typeof t!="number"?t._clone():new e.grid.cellInfo(t,n);if(!i.isEqual(e.grid.cellInfo.outsideValue)){if(!i._isValid())throw"invalid arguments";i._clip(this._getDataCellsRange(0));if(i.rowIndex()>=0){var u=s._getRowInfoBySketchRowIndex(i.rowIndex());if(!u||!(u.type&2))return}}return i._setGridView(this),this._changeCurrentCell(null,i,{changeSelection:r||!1,setFocus:!1}),this._currentCell()},i.prototype.data=function(){return this.mDataViewWrapper.dataView().getSource()},i.prototype.dataView=function(){return this.mDataViewWrapper.dataView()},i.prototype._isRoot=function(){return!this._isDetail()},i.prototype._isDetail=function(){return this.options._isDetail===!0},i.prototype._clearDetails=function(){this.mDetails&&this.mDetails.splice(0,this.mDetails.length)},i.prototype.details=function(){return this.mDetails||(this.mDetails=[]),this.mDetails},i.prototype.doRefresh=function(r){var i=this;n.isPlainObject(r)||(r={});var s=this,o=r&&r.virtualScrollData;if(!this._initialized)try{this._prepareColumns(this.options.columns,this.options.columnsAutogenerationMode,this.mDataViewWrapper.getFieldsInfo(),!0,!0)}catch(u){throw u}finally{this._initialized=!0}if(!o){this._rebuildLeaves();var a=t.lazy(this.mDataViewWrapper.data,this.mDataViewWrapper),f=this.mDataViewWrapper.dataView(),l=this._prepareTotalsRequest();l.length&&n.each(this._leaves(),function(e,t){t.options._totalsValue=a().totals?a().totals[t.options.dataKey]:undefined});if(f.count()){var c=this._leaves(),h=new e.grid.LazySketchTable({count:function(){return f.count()},getRange:function(e,t,n,r){for(var s=0;s<t;s++){var o=e+s,u=f.item(o);n[r+s]=i._buildSketchRow(i.mDataViewWrapper._wrapDataItem(u,o),c)}}});(this._hasGrouping()||this._hasMerging()||this._hasDetail())&&h.ensureNotLazy(),this.mSketchTable=h}else{this.mSketchTable=new e.grid.SketchTable;var p=a().emptyData;p&&n.each(p,function(e,t){s.mSketchTable.add(s._buildSketchRowEmptyDataItem(t,i._leaves(),e===p.length-1))})}}this._onRendering(r),o?this._refreshVirtual(r):this._refresh(r),r&&n.isFunction(r.beforeOnRendered)&&r.beforeOnRendered.apply(this,[r]);var d=this._view();if(this.mEditSkechRowIndex>=0&&d._isRowRendered(this.mEditSkechRowIndex)>=0){var v=d._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex);v&&v.state&16&&d._makeRowEditable(v)}this._onRendered(r),r&&n.isFunction(r.afterRefresh)&&r.afterRefresh.apply(this,[r])},i.prototype.beginEdit=function(){if(!this._allowCellEditing())throw'Can be used only if the editingMode option is set to "cell".';return this._beginEditInternal(null)},i.prototype.endEdit=function(e){return typeof e=="undefined"&&(e=!1),this._endEditInternal(null,e)},i.prototype.editRow=function(e){if(this.options.editingMode!=="row")throw'Can be used only if the editingMode option is set to "row".';this.mEditSkechRowIndex>=0&&this.cancelRowEditing();if(e>=0){var t=-1,n;for(var r=0;r<this.mSketchTable.count()&&t<0;r++)n=this.mSketchTable.row(r),n.isDataRow()&&n.dataItemIndex()===e&&(t=r);if(t>=0){var i=this._view();this.mEditSkechRowIndex=t,n.renderState|=16;if(i._isRowRendered(this.mEditSkechRowIndex)>=0){var s=i._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1);s.state|=16,i._removeBodyRow(s.sectionRowIndex,!0);var o=i._insertBodyRow(n,s.sectionRowIndex,s.dataItemIndex,s.virtualDataItemIndex,this.mEditSkechRowIndex);o.dataRowIndex=s.dataRowIndex,this._hasMerging()&&this._view()._rebuildOffsets(),i._makeRowEditable(o),this.selection()._ensureSelectionInRow(this.mEditSkechRowIndex)}}}},i.prototype.exportGrid=function(e,t,n,r){},i.prototype.updateRow=function(){if(this.mEditSkechRowIndex>=0){var n=e.grid.asEditableDataView(this.mDataViewWrapper.dataView()),r=!1;if(!n)throw"The provided DataView doesn't supports the editing operation.";try{var i=this.mSketchTable.row(this.mEditSkechRowIndex),s=this._view();if(!i||!i.isDataRow()||!(i.renderState&16))throw"Invalid row";if(this._view()._isRowRendered(this.mEditSkechRowIndex)>=0){var o=s._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1),u=this._visibleLeaves(),a=[],f=new e.grid.cellEditorHelper;for(var l=0;l<u.length;l++){var c=u[l];if(c instanceof t.c1field&&!c.options.readOnly){var h=o.$rows.children("td, th").eq(l);if(h.length){var p=s._changeCellRenderState(h,0,!0);if(p&16){var d=s.getAbsoluteCellInfo(h[0],!0),v=f.updateCell(this,d,null,!1);if(!(v&2)){r=!0;return}v&8||a.push(d)}}}}for(var l=0;l<a.length;l++)f.cellEditEnd(this,a[l],null);i.renderState&=-17,o.state&=-17,s._removeBodyRow(o.sectionRowIndex,!0);var m=s._insertBodyRow(i,o.sectionRowIndex,o.dataItemIndex,o.virtualDataItemIndex,this.mEditSkechRowIndex);m.dataRowIndex=o.dataRowIndex,this.selection()._ensureSelectionInRow(this.mEditSkechRowIndex)}else i.renderState&=-17}finally{r||(this.mEditSkechRowIndex=-1)}}},i.prototype.cancelRowEditing=function(){if(this.mEditSkechRowIndex>=0)try{var e=this.mSketchTable.row(this.mEditSkechRowIndex),t=this._view();if(!e||!e.isDataRow()||!(e.renderState&16))throw"Invalid row.";e.renderState&=-17;if(this._view()._isRowRendered(this.mEditSkechRowIndex)>=0){var n=t._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1);n.state&=-17,t._removeBodyRow(n.sectionRowIndex,!0);var r=t._insertBodyRow(e,n.sectionRowIndex,n.dataItemIndex,n.virtualDataItemIndex,this.mEditSkechRowIndex);r.dataRowIndex=n.dataRowIndex,this._hasMerging()&&this._view()._rebuildOffsets(),this.selection()._ensureSelectionInRow(this.mEditSkechRowIndex)}}finally{this.mEditSkechRowIndex=-1}},i.prototype.deleteRow=function(t){if(t>=0){var n=e.grid.asEditableDataView(this.mDataViewWrapper.dataView());if(!n||!n.canRemove())throw"The provided DataView doesn't supports the deleting operation.";this.mDataViewWrapper.ignoreChangeEvent(!0),n.remove(t),this.mDataViewWrapper.ignoreChangeEvent(!1),this.mDataViewWrapper.isKODataView()||this.ensureControl(!0,{forceDataLoad:!0})}},i.prototype.ensureControl=function(t,r){this._loading(),n.isPlainObject(r)||(r={data:null,afterRefresh:null,beforeRefresh:null}),this._initialized||(this._prepareColumns(this.options.columns,this.options.columnsAutogenerationMode,this.mDataViewWrapper.isDataLoaded()&&this.mDataViewWrapper.getFieldsInfo(),this.mDataViewWrapper.isDataLoaded(),!1),this.mDataViewWrapper.isOwnDataView()||(new e.grid.settingsManager(this)).MapDVToWG()),this._initialized&&r&&n.isFunction(r.beforeRefresh)&&r.beforeRefresh.apply(this);if(!r||!r.virtualScrollData)this.mAllowVVirtualScrolling=undefined,this.mEditSkechRowIndex=-1;t===!0?this.mDataViewWrapper.load(r):(this.doRefresh(r),this._loaded())},i.prototype.getCellInfo=function(e){var t=null;return e&&(e=this._findUntilOuterDiv(e,{td:!0,th:!0}))&&(t=this._view().getAbsoluteCellInfo(e,!1)),t},i.prototype.getFilterOperatorsByDataType=function(t){return(new e.grid.filterOperatorsCache(this)).getByDataType(t||"string")},i.prototype.pageCount=function(){return this._customPagingEnabled()?Math.ceil(this.options.totalRows/this.options.pageSize)||1:this.options.allowPaging?this.mDataViewWrapper.dataView().pageCount():1},i.prototype._closestCulture=function(){return this.mClosestCulture},i.prototype._serverShaping=function(){return!1},i.prototype._pageIndexForDataView=function(){return this.options.pageIndex},i.prototype.setSize=function(t,r,i,s){typeof s=="undefined"&&(s=!0);if(!this._rendered||this.mIgnoreSizing)return;var o=this._view(),u=null,a=this.mOuterDiv,f=this._visibleLeaves(),l=[],c=n.browser&&n.browser.msie&&n.browser.version<9;try{c&&(e.grid.wijgrid.IGNORE_WIN_RESIZE=!0),o&&o.getScrollValue&&(u=o.getScrollValue());if(t||t===0)this.mAutoWidth=!1,a.width(t);if(r||r===0)this.mAutoHeight=!1,a.height(r);o._resetWidth(),this._hideAllFilterDropDownLists(),this._allowHVirtualScrolling()?(this._resetScrollState(),this.doRefresh()):this._setSizeInternal(u,i,s)}finally{e.grid.wijgrid.IGNORE_WIN_RESIZE=!1}},i.prototype._setSizeWithoutDetails=function(){var e=this._ignoreSizing();this._ignoreSizing(!1),this.setSize(undefined,undefined,undefined,!1),this._ignoreSizing(e)},i.prototype._setSizeInternal=function(e,t,n){typeof n=="undefined"&&(n=!0);if(!this._rendered)return;this._isDetail()&&this.mIgnoreSizing&&this.element.width("100%");if(this.mIgnoreSizing)return;n&&this._resetDetailsSize(),this._view().updateSplits(e,t),this._UIFrozener().refresh();if(n&&this.mLoadingDetails===0){var r=this.details();for(var i=0;i<r.length;i++){var s=r[i].grid();s&&(s._ignoreSizing(!1),s.setSize(),s._ignoreSizing(!0))}}},i.prototype._resetDetailsSize=function(){if(this._rendered&&this.mLoadingDetails===0){var e=this.details();for(var t=0;t<e.length;t++){var n=e[t].grid();n&&(n._view()._resetWidth(),n._resetDetailsSize())}}},i.prototype.selection=function(){return this.mSelection||(this.mSelection=new e.grid.selection(this)),this.mSelection},i.prototype._ignoreSizing=function(e){return arguments.length&&(this.mIgnoreSizing=e),this.mIgnoreSizing},i.prototype._masterInfo=function(){return this.mMasterInfo},i.prototype._master=function(){return this.mMasterInfo?this.mMasterInfo.master:null},i.prototype._validateRelation=function(e){if(!e||!e.length)throw"The relation option must be defined.";for(var t=0;t<e.length;t++)if(!e[t].detailDataKey||!e[t].masterDataKey)throw"Both detailDataKey and masterDataKey properties must be defined."},i.prototype._topMaster=function(){var e=this,t;while(t=e._masterInfo())e=t.master;return e},i.prototype._leaves=function(){return this.mLeaves||(this.mLeaves=[]),this.mLeaves},i.prototype._visibleLeaves=function(){return this.mVisibleLeaves||(this.mVisibleLeaves=[]),this.mVisibleLeaves},i.prototype._renderedLeaves=function(){return this.mRenderedLeaves||(this.mRenderedLeaves=[]),this.mRenderedLeaves},i.prototype._virtualLeaves=function(){return this.mVirtualLeaves||(this.mVirtualLeaves=[]),this.mVirtualLeaves},i.prototype._allColumns=function(){return this.mAllColumns||(this.mAllColumns=[]),this.mAllColumns},i.prototype._findInstance=function(e){return e?this._allColumns()[e._travIdx]||null:null},i.prototype._currentCell=function(e){if(!arguments.length)return this.mCurrentCell;this.mCurrentCell=e},i.prototype._groupAreaColumns=function(){return this.mGroupAreaColumns||(this.mGroupAreaColumns=[]),this.mGroupAreaColumns},i.prototype._tHead=function(){return this.mTHead},i.prototype._onDataViewCurrentPositionChanged=function(e,t){var n=this._currentCellFromDataView(this.currentCell().cellIndex());n=this.currentCell(n,null,!0)},i.prototype._resetColumns=function(){e.grid.traverse(this.options.columns,function(e,t){if(e._dynamic){var r=n.inArray(e,t);r>=0&&t.splice(r,1)}else e.dataKey=e._originalDataKey,e.headerText=e._originalHeaderText}),this._initialized=!1},i.prototype._resetDataProperitesOnFilterChanging=function(){this._resetDataProperties(),this._resetVerticalBounds()},i.prototype._resetDataProperties=function(){this.options.pageIndex=0},i.prototype._resetVerticalBounds=function(){var e=this._viewPortBounds();e.start=0,this.mScrollingState.index=0,this.mScrollingState.y=0},i.prototype._resetScrollState=function(){this.mScrollingState&&(this.mScrollingState.scrollLeft=0,this.mScrollingState.x=0)},i.prototype._onDataViewLoading=function(){this._clearDetails(),this._activateSpinner(),this._trigger("dataLoading")},i.prototype._onDataViewReset=function(t,n){this.mEditSkechRowIndex=-1,this.mCurrentCellLocker&&(this._serverSideVirtualScrolling()&&t&&t.virtualScrollData||this._resetVerticalBounds(),this.mCurrentCellLocker=!1),(new e.grid.settingsManager(this)).MapDVToWG(),this._trigger("dataLoaded"),n&&this._resetColumns(),this.doRefresh(t),this._loaded()},i.prototype._onDataViewLoaded=function(){},i.prototype._loading=function(){this._isDetail()||this._activateSpinner();if(!this._isRoot()){var e=this._masterInfo().master;e._onDetailLoading(this)}this._trigger("loading")},i.prototype._onDetailLoading=function(e){this._topMaster()._activateSpinner()},i.prototype._loaded=function(){this._isRoot()&&this.mLoadingDetails>0||this._deactivateSpinner();if(!this._isRoot()){var e=this._masterInfo().master;e._onDetailLoaded(this)}this._trigger("loaded")},i.prototype._onDetailLoaded=function(e){this.mLoadingDetails>0&&this.mLoadingDetails--;var t=e._masterInfo();t.master.details()[t.dataRowIndex]._setGrid(e),this.mLoadingDetails===0&&(this._isRoot()?this._rendered&&(this._setSizeInternal(this.mScrollingState,undefined,!0),this._deactivateSpinner()):this._rendered&&this._masterInfo().master._onDetailLoaded(this))},i.prototype._buildSketchRow=function(n,r){var i=e.grid.dataViewWrapper.getMetadata(n.values),s=new t.SketchDataRow(n.originalRowIndex,1,i&&i.rowAttributes),o=i&&i.cellsAttributes;for(var u=0,a=r.length;u<a;u++){var f=r[u];if(f instanceof t.c1field){var l=f,c=o?o[l.options.dataKey]:null,h=this.mDataViewWrapper.getValue(n.values,l.options.dataKey);s.add(new t.ValueCell(this.parse(f.options,h),c))}else s.add(new t.ValueCell(null,{}))}return s},i.prototype._buildSketchRowEmptyDataItem=function(e,n,r){var i=new t.SketchRow(128,1,null),s=n.length;for(var o=0,u=e.length;o<u;o++)i.add(new t.HtmlCell(e[o],{colSpan:s>0&&r?this._visibleLeaves().length:1}));return i},i.prototype._prepareColumnsStage1=function(t,n,r){(new e.grid.bandProcessor).getVisibleHeight(t,!0)},i.prototype._prepareColumnsStage2=function(r,i,s,o,u,a){var f=this;typeof a=="undefined"&&(a=!0),e.grid.traverse(r,function(e){e._originalDataKey=e.dataKey,e._originalHeaderText=e.headerText}),o&&e.grid.columnsGenerator.generate(i,s,r),e.grid.setTraverseIndex(r),a&&this._generateColumnInstancesFromOptions(r),o&&this.mDataViewWrapper&&this.mAdjustHeaderText&&n.each(this._leaves(),function(e,r){var i=f.mDataViewWrapper.isBoundedToDOM(),s=r.options,o=typeof s.dataKey=="number"?s.dataKey:s._leavesIdx;if(s.headerText===undefined&&(f.options.columnsAutogenerationMode==="merge"||s._dynamic)){var u=f._originalHeaderRowData();i&&u&&o<u.length?s.headerText=n.trim(u[o]):r instanceof t.c1field&&(s.headerText=s.dataKey+"")}var a=f._originalFooterRowData();i&&a&&o<a.length&&(s._footerTextDOM=n.trim(a[o]))})},i.prototype._prepareColumns=function(e,t,n,r,i,s){typeof s=="undefined"&&(s=!0),this._prepareColumnsStage1(e,r,i),this._prepareColumnsStage2(e,t,n,r,i,s)},i.prototype._rebuildLeaves=function(){var t=[];this._addVirtualColumns(t),n.each(this.options.columns,function(e,n){t.push(n)}),e.grid.setTraverseIndex(t),this._columnsHeadersTable((new e.grid.bandProcessor).generateSpanTable(t)),this._generateColumnInstancesFromOptions(t),this._onLeavesCreated()},i.prototype._addVirtualColumns=function(e){this._showRowHeader()&&e.push(t.c1rowheaderfield.getInitOptions()),this._hasDetail()&&e.push(t.c1detailrowheaderfield.getInitOptions())},i.prototype._generateColumnInstancesFromOptions=function(n){var r=this;this.mAllColumns=[],this.mLeaves=[],this.mVirtualLeaves=[],this.mVisibleLeaves=[],this.mGroupedLeaves=null,this.mRenderedLeaves=[];var i=0,s=0,o=0;e.grid.traverse(n,function(n){n._visLeavesIdx=undefined,n._leavesIdx=undefined,n._renderedIndex=undefined,n._isLeaf&&(n._leavesIdx=s++,n._parentVis&&(n._visLeavesIdx=o++)),n.disabled=r.options.disabled===!0;var u=e.grid.asColumnInstance(r,n);r.mAllColumns.push(u),u instanceof t.c1field&&(n.dataIndex=i++),n._isLeaf&&(r.mLeaves.push(u),n._parentVis&&(r.mVisibleLeaves.push(u),u instanceof t.c1rowheaderfield&&r.mVirtualLeaves.push(u)))})},i.prototype._onLeavesCreated=function(){},i.prototype._allowEditing=function(){return this.options.allowEditing===!0||this.options.editingMode==="cell"||this.options.editingMode==="row"},i.prototype._allowCellEditing=function(){var e=this.options.editingMode;return e==="row"?!1:this.options.allowEditing===!0||e==="cell"},i.prototype._allowVirtualScrolling=function(){return this._allowVVirtualScrolling()||this._allowHVirtualScrolling()},i.prototype._allowVVirtualScrolling=function(){if(this.mAllowVVirtualScrolling===undefined){var e=this.options.scrollingSettings.virtualizationSettings.mode,t=this.options.allowVirtualScrolling||e==="rows"||e==="both";this.mAllowVVirtualScrolling=!this.options.allowPaging&&t&&this._lgGetStaticRowIndex()<0&&this._lgGetScrollMode()!=="none"&&!this._hasMerging()&&!this._hasDetail()}return this.mAllowVVirtualScrolling},i.prototype._allowHVirtualScrolling=function(){if(this.mAllowHVirtualScrolling===undefined){var e=this.options.scrollingSettings.virtualizationSettings.mode,t=e==="columns"||e==="both";this.mAllowHVirtualScrolling=t&&this._lgGetScrollMode()!=="none"&&!this._hasGrouping()&&!this._hasBands()&&!this._hasDetail()}return this.mAllowHVirtualScrolling},i.prototype._headerRows=function(){return this._view().headerRows()},i.prototype._filterRow=function(){return this._view().filterRow()},i.prototype._rows=function(){return this._view().bodyRows()},i.prototype._localizeFilterOperators=function(t){var r=this,i=new e.grid.filterOperatorsCache(this);n.each(t,function(e,t){if(t.name){var n=i.getByName(t.name);n&&(n.displayName=t.displayName)}})},i.prototype._KeyDownEventListener=function(){if(!this.mKeyDownEventListener){var e=this._view(),n=e&&e.focusableElement();n&&(this.mKeyDownEventListener=new t.keyDownEventListener(this,n))}return this.mKeyDownEventListener},i.prototype._UIDragndrop=function(t){return!this._dragndropui&&t&&(this._dragndropui=new e.grid.uiDragndrop(this)),this._dragndropui},i.prototype._UIFrozener=function(t){if(!this._frozenerui||t)this._frozenerui=new e.grid.uiFrozener(this);return this._frozenerui},i.prototype._UIResizer=function(t){return!this._resizerui&&t&&(this._resizerui=new e.grid.uiResizer(this)),this._resizerui},i.prototype._UISelection=function(t){return!this._selectionui&&t&&(this._selectionui=new e.grid.uiSelection(this)),this._selectionui},i.prototype._postset_allowColMoving=function(e,t){var r=this;n.each(this.columns(),function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)});var i=this._groupAreaColumns();i&&n.each(i,function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)})},i.prototype._postset_allowEditing=function(e,t){this._postset_editingMode(this.options.editingMode,undefined)},i.prototype._postset_allowSorting=function(e,t){this.ensureControl(!1)},i.prototype._postset_columns=function(e,t){this._initialized=!1,this.ensureControl(!0)},i.prototype._postset_allowPaging=function(e,t){this.ensureControl(!0)},i.prototype._postset_freezingMode=function(e,t){this._frozenerui&&this._frozenerui.refresh()},i.prototype._postset_culture=function(e,t){this.mClosestCulture=n.wijGetCulture(this.options.culture,this.options.cultureCalendar),this.ensureControl(!1)},i.prototype._postset_customFilterOperators=function(e,t){var n=this.mDataViewWrapper.dataView()},i.prototype._postset_data=function(t,n){this._resetColumns(),this.mDataViewWrapper&&this.mDataViewWrapper.dispose(),this.mDataViewWrapper=new e.grid.dataViewWrapper(this),this.ensureControl(!0)},i.prototype._postset_disabled=function(t,n){var r=this,i=this._view();e.grid.iterateChildrenWidgets(this.mOuterDiv,function(e,n){n!==r&&n.option("disabled",t)});if(this.mEditSkechRowIndex>=0&&i._isRowRendered(this.mEditSkechRowIndex)>=0){var s=i._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1);s&&s.$rows.find("."+e.grid.wijgrid.CSS.inputMarker).prop("disabled",t)}i&&i.ensureDisabledState()},i.prototype._postset_editingMode=function(e,t){this.mKeyDownEventListener&&(this.mKeyDownEventListener.dispose(),this.mKeyDownEventListener=null,this._KeyDownEventListener())},i.prototype._postset_groupIndent=function(e,t){this.ensureControl(!1)},i.prototype._postset_groupAreaCaption=function(e,t){var n=this._groupedLeaves();this.$groupArea&&(!n||!n.length)&&this.$groupArea.html(e||"&nbsp;")},i.prototype._postset_highlightCurrentCell=function(e,t){var n=this.currentCell();n&&n._isValid()&&this._highlightCellPosition(n,e)},i.prototype._preset_pageIndex=function(e,r){if(t.isNaN(e))throw"out of range";var i=this.pageCount(),s=function(e){return e>i-1&&(e=i-1),e<0&&(e=0),e};e=s(e);if(this.options.allowPaging&&e!==r){var o={newPageIndex:e};this._onPageIndexChanging(o)?e=s(o.newPageIndex):(e=r,n.each([this.mTopPagerDiv,this.mBottomPagerDiv],function(t,n){if(n&&n.length){var r=n.data("wijmo-wijpager");r&&(r.options.pageIndex=e)}}))}return e},i.prototype._postset_pageIndex=function(e,t){if(this.options.allowPaging){var n={newPageIndex:e};this._customPagingEnabled()?this._onPageIndexChanged(n):this.ensureControl(!0,{afterRefresh:function(){this._onPageIndexChanged(n)}})}},i.prototype._preset_pageSize=function(e,n){if(t.isNaN(e))throw"out of range";return e<=0&&(e=1),e},i.prototype._postset_pageSize=function(e,t){this._resetDataProperties(),this.options.allowPaging&&!this._customPagingEnabled()&&this.ensureControl(!0)},i.prototype._postset_pagerSettings=function(e,t){this.ensureControl(!1)},i.prototype._postset_rowHeight=function(e,t){this.mRowOuterHeight=-1,this.ensureControl(!1)},i.prototype._postset_scrollMode=function(e,t){this.ensureControl(!1)},i.prototype._preset_scrollingSettings=function(e,t){return n.extend(!0,{},n.wijmo.wijgrid.prototype.options.scrollingSettings,e)},i.prototype._postset_selectionMode=function(t,n){var r=this.selection(),i=this.currentCell(),s=this.selection().selectedCells().length();r.beginUpdate(),r.clear(),i&&i._isValid()&&s&&r._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,0,null),r.endUpdate(),this._view().toggleDOMSelection(t==="none")},i.prototype._postset_showFilter=function(e,t){this.ensureControl(!1)},i.prototype._postset_showGroupArea=function(e,t){this.ensureControl(!1)},i.prototype._postset_showRowHeader=function(e,t){this.ensureControl(!1)},i.prototype._postset_staticRowIndex=function(e,t){this._freezingAllowed()&&(this.options.scrollingSettings.staticRowIndex=e,this.ensureControl(!1))},i.prototype._postset_staticColumnIndex=function(e,t){this._freezingAllowed()&&(this.options.scrollingSettings.staticColumnIndex=e,this.ensureControl(!1))},i.prototype._postset_allowVirtualScrolling=function(e,t){this.ensureControl(!1)},i.prototype._preset_allowVirtualScrolling=function(e,n){if(t.isNaN(e)||e<0)throw"out of range";return e},i.prototype._activateSpinner=function(){if(!this._spinnerActivated&&!this._topMaster()._spinnerActivated){var t=e.grid.wijgrid.CSS,n=this.options.wijCSS,r=this.mOuterDiv.append('<div class="'+t.spinnerMarker+" "+t.loadingOverlay+" "+n.wijgridLoadingOverlay+" "+n.overlay+'"></div>'+'<span class="'+t.spinnerMarker+" "+t.loadingText+" "+n.wijgridLoadingText+" "+n.content+" "+n.cornerAll+'">'+'<span class="'+t.spinnerMarker+" "+n.icon+" "+n.iconClock+'"></span>'+this.options.loadingText+"</span>").find("> ."+t.loadingText);r.position({my:"center",at:"center center",of:this.mOuterDiv,collision:"none"}),this._spinnerActivated=!0}},i.prototype._customPagingEnabled=function(){return this.options.allowPaging&&this.options.totalRows>=0},i.prototype._deactivateSpinner=function(){if(this._spinnerActivated)try{var t=e.grid.wijgrid.CSS;this.mOuterDiv.children("."+t.spinnerMarker).remove()}finally{this._spinnerActivated=!1}},i.prototype._prepareTotalsRequest=function(){var e=this._leaves(),r;return!e||!this.options.showFooter?[]:(r=n.map(e,function(e,n){var r=e.options;return e instanceof t.c1field&&r.aggregate&&r.aggregate!=="none"?[e]:null}),r)},i.prototype._groupedLeaves=function(e){var r;e=!(r=this.mGroupedLeaves)||e;if(e){r=[];var i=this._leaves(),s=!1;n.each(i,function(e,n){t.c1field.isGroupedColumn(n)?(s=s||n.options.groupedIndex===undefined,s||r.push(n)):delete n.options.groupedIndex}),s?n.each(i,function(e,n){t.c1field.isGroupedColumn(n)&&(n.options.groupedIndex=r.length,r.push(n))}):(r.sort(function(e,t){return e.options.groupedIndex-t.options.groupedIndex}),n.each(r,function(e,t){t.options.groupedIndex=e})),this.mGroupedLeaves=r}return r||[]},i.prototype._ensureRenderableBounds=function(t){return e.grid.ensureBounds(t,this._renderableRowsCount()-1)},i.prototype._ensureTotalRowsBounds=function(t){return e.grid.ensureBounds(t,this._totalRowsCount()-1)},i.prototype._ensureLowerBoundVisible=function(e){var t=this._renderableRowsCount();if(e.end>=t){var n=this._view(),r=n.getVirtualPageSize(!1);e.end=t-1,e.start=e.end-r+1,e.start=Math.max(0,e.start),e.end=Math.max(0,e.end)}return e},i.prototype._renderableColumnsRange=function(){return this.mRenderableColumns},i.prototype._renderableRowsRange=function(){return this.mRenderableRows},i.prototype._rebuildRenderableRowsCollection=function(){var t=-1,n=-1,r=!1,i=this._totalRowsCount();this.mRenderableRows=new e.grid.renderableRowsCollection(i-1);if(this._allowVVirtualScrolling()&&this._serverSideVirtualScrolling())this.mRenderableRows.add({start:0,end:i-1});else if(!this._allowVVirtualScrolling()||!this._hasGrouping())this.mRenderableRows.add({start:0,end:i-1});else{for(var s=0;s<this.mSketchTable.count();s++){var o=this.mSketchTable.row(s);o.extInfo.state&1?(t>=0&&(this.mRenderableRows.add({start:t,end:n}),r=!1),t=n=-1):t<0?(r=!0,t=n=s):n++}r&&this.mRenderableRows.add({start:t,end:n})}},i.prototype._refresh=function(n){if(this._hasGrouping()&&this._hasDetail())throw"It is not possible to use columns grouping and master-detail hierarchy simultaneously.";if(this._hasDetail()&&this._allowVirtualScrolling())throw"It is not possible to use virtual scrolling and master-detail hierarchy simultaneously.";t.hierarchyBuilder.build(this),(new e.grid.grouper).group(this,this.mSketchTable),(new e.grid.merger).merge(this,this.mSketchTable),this._rebuildRenderableRowsCollection(),this._lgGetScrollMode()!=="none"?this.mView=new e.grid.fixedView(this,this._viewPortBounds()):this.mView=new e.grid.flatView(this,this._viewPortBounds()),this._render(),this.options.allowPaging&&(this.mTopPagerDiv&&this.mTopPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",4),this.mBottomPagerDiv&&this.mBottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",4))},i.prototype._refreshVirtual=function(e){var t=e.virtualScrollData,n=e.virtualScrollData.direction;if(n==="h")this._view().render(!0);else{var r={top:0,bottom:0};t.data&&(r=this._processVirtualData(t)),this._updateRowInfos(t,r),this._renderVirtualIntoView(t)}},i.prototype._updateRowInfos=function(e,t){var n=this._viewPortBounds(),r=this._view(),i=e.newBounds,s=this._view().bodyRows(),o,u,a,f;switch(e.mode){case 3:break;case 2:o={start:i.start-n.start,end:n.end-n.start},a=i.start-n.start;for(u=o.start;u<=o.end;u++)f=r._getRowInfo(s.item(u),!1),f.sectionRowIndex-=a,t.top!==0&&(f.dataItemIndex+=t.top,f.sketchRowIndex+=t.top),r._setRowInfo(f.$rows,f);break;case 1:o={start:n.start-n.start,end:i.end-n.start},a=n.start-i.start;for(u=o.start;u<=o.end;u++)f=r._getRowInfo(s.item(u),!1),f.sectionRowIndex+=a,t.top!==0&&(f.dataItemIndex+=t.top,f.sketchRowIndex+=t.top),r._setRowInfo(f.$rows,f)}},i.prototype._renderVirtualIntoView=function(e){var t=this._viewPortBounds(),n=this,r,i=this._view(),s,o,u;i._clearNorthTablesHeight(!0),i._ensureRenderHBounds();switch(e.mode){case 3:i._clearBody();var a=e.newBounds.end-e.newBounds.start+1;this._renderableRowsRange().forEachIndex(e.newBounds.start,a,function(e){u=e-n.mDataOffset,r=n.mSketchTable.row(u),i._insertBodyRow(r,-1,r.dataItemIndex(),r.dataItemIndex(n.mDataOffset),u)}),i._rebuildOffsets();break;case 2:s={start:e.newBounds.start,end:t.end};for(var f=0;f<s.start-t.start;f++)i._removeBodyRow(0);var a=e.newBounds.end-s.end;this._renderableRowsRange().forEachIndex(s.end+1,a,function(e){u=e-n.mDataOffset,r=n.mSketchTable.row(u),i._insertBodyRow(r,-1,r.dataItemIndex(),r.dataItemIndex(n.mDataOffset),u)});break;case 1:s={start:t.start,end:e.newBounds.end};for(var f=0;f<t.end-e.newBounds.end;f++)i._removeBodyRow(s.end-s.start+1);o=0;var a=t.start-e.newBounds.start;this._renderableRowsRange().forEachIndex(e.newBounds.start,a,function(e){u=e-n.mDataOffset,r=n.mSketchTable.row(u),i._insertBodyRow(r,o++,r.dataItemIndex(),r.dataItemIndex(n.mDataOffset),u)});break;default:}},i.prototype._processVirtualData=function(e){var t=this.mDataViewWrapper,n=t.dataView().getSource(),r,i=this._leaves(),s,o,u,a=0,f={top:0,bottom:0},l=this._serverSideVirtualScrollingMargin();switch(e.mode){case 3:this.mSketchTable.clear(),t._unsafeSplice(0,n.length),this.mDataOffset=e.request.index;for(s=0;s<e.data.length;s++)t._unsafePush(r=e.data[s]),this.mSketchTable.add(this._buildSketchRow(t._wrapDataItem(r,s),i));break;case 2:for(s=0;s<e.data.length;s++)t._unsafePush(r=e.data[s]),this.mSketchTable.add(this._buildSketchRow(t._wrapDataItem(r,n.length-1),i));f.bottom=e.data.length;break;case 1:for(s=e.data.length-1;s>=0;s--)t._unsafeSplice(0,0,r=e.data[s]),this.mSketchTable.insert(0,this._buildSketchRow(t._wrapDataItem(r,s),i));this.mDataOffset=e.request.index,f.top=e.data.length}return o=this._ensureTotalRowsBounds({start:e.newBounds.start,end:e.newBounds.end}),u={start:this.mDataOffset,end:this.mDataOffset+n.length-1},a=u.end-o.end-l,a>0&&(f.bottom-=a,t._unsafeSplice(n.length-a,a),this.mSketchTable.removeLast(a)),a=o.start-u.start-l,a>0&&(f.top-=a,t._unsafeSplice(0,a),this.mSketchTable.removeFirst(a),this.mDataOffset+=a),this.mSketchTable.updateIndexes(),t._refreshSilent(),f},i.prototype._needToCreatePagerItem=function(){return this.options.allowPaging===!0},i.prototype._isMobileEnv=function(){return this._isMobile},i.prototype._isTouchEnv=function(){return!!n.support.isTouchEnabled&&!!n.support.isTouchEnabled()},i.prototype._render=function(){var t=this._view(),r=this.options,i=e.grid.wijgrid.CSS,s=this.options.wijCSS,o;t.render(!1),o=this.mOuterDiv,this._lgGetScrollMode()!=="none"&&(o=this.mOuterDiv.find("div."+i.scroller+":first")),this.mSuperPanelHeader=null,this.mTopPagerDiv&&(this.mTopPagerDiv.data("wijmo-wijpager")&&this.mTopPagerDiv.wijpager("destroy"),this.mTopPagerDiv.remove()),this.mTopPagerDiv=null,this._needToCreatePagerItem()&&(r.pagerSettings.position==="top"||r.pagerSettings.position==="topAndBottom")&&(this.mTopPagerDiv||(o.prepend(this.mSuperPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.mSuperPanelHeader.prepend(this.mTopPagerDiv=n('<div class="'+i.headerArea+" "+s.wijgridHeaderArea+" "+s.header+" "+s.cornerTop+'"></div>')))),r.showGroupArea?this._processGroupArea(o):this.$groupArea=null,this.mBottomPagerDiv&&(this.mBottomPagerDiv.data("wijmo-wijpager")&&this.mBottomPagerDiv.wijpager("destroy"),this.mBottomPagerDiv.remove()),this.mBottomPagerDiv=null,this._needToCreatePagerItem()&&(r.pagerSettings.position==="bottom"||r.pagerSettings.position==="topAndBottom")&&(this.mBottomPagerDiv||o.append(this.mBottomPagerDiv=n('<div class="'+i.footerArea+" "+s.wijgridFooterArea+" wijmo-wijsuperpanel-footer "+s.stateDefault+" "+s.cornerBottom+'"></div>')))},i.prototype._processGroupArea=function(t){var r=this,i=this,s=this._groupedLeaves(),o=e.grid.wijgrid.CSS,u=this.options.wijCSS;this.mGroupAreaColumns=[],this.$groupArea=n('<div class="'+u.content+" "+u.helperClearFix+" "+o.groupArea+" "+u.wijgridGroupArea+'"></div>'),s.length>0?n.each(s,function(e,t){var s=n('<a href="#"></a>').appendTo(i.$groupArea);r.mGroupAreaColumns.push(r._createGroupAreaColumnHeader(s,t))}):this.$groupArea.addClass(o.groupAreaEmpty).css("padding",0).html(this.options.groupAreaCaption||"&nbsp;"),this.mSuperPanelHeader||t.prepend(this.mSuperPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.mSuperPanelHeader.prepend(this.$groupArea),this._UIDragndrop(!0).attachGroupArea(this.$groupArea)},i.prototype._createGroupAreaColumnHeader=function(e,n){return new t.c1groupedfield(this,n.options,e)},i.prototype._pagerSettings2PagerWidgetSettings=function(){return n.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:n.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:n.proxy(this._onPagerWidgetPageIndexChanged,this)})},i.prototype._showRowHeader=function(){return this.options.showRowHeader===!0&&this._lgGetStaticColumnsAlignment()!=="right"},i.prototype._attachEvents=function(){var e=this._view(),t=e.focusableElement(),r=this,i=function(e){return e+"."+r.widgetName};t.unbind(i("keydown")).bind(i("keydown"),n.proxy(this._onKeyDown,this)),t.unbind(i("focusin")).bind(i("focusin"),n.proxy(this._onFocusIn,this)),this._KeyDownEventListener(),n.each(e.subTables(),function(e,t){var s=t.element();s&&(s.tHead&&n(s.tHead).unbind(i("click")).bind(i("click"),n.proxy(r._onClick,r)),s.tBodies.length&&n(s.tBodies[0]).unbind(i("click")).bind(i("click"),n.proxy(r._onClick,r)).bind(i("dblclick")).bind(i("dblclick"),n.proxy(r._onDblClick,r)).bind(i("mousemove")).bind(i("mousemove"),n.proxy(r._onMouseMove,r)).bind(i("mouseout")).bind(i("mouseout"),n.proxy(r._onMouseOut,r)))}),this._isRoot()&&n(window).bind("resize."+this.widgetName+"."+this._eventUID,n.proxy(this._onWinResize,this))},i.prototype._detachEvents=function(e){var t=this._view(),r=this,i;this._windowResizeTimer>0&&(window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=0),n(window).unbind("resize."+this.widgetName+"."+this._eventUID),t&&(i=t.focusableElement(),i.unbind("."+this.widgetName),n.each(t.subTables(),function(){var e=this.element();e&&(e.tHead&&n(e.tHead).unbind("."+r.widgetName),e.tBodies.length&&n(e.tBodies[0]).unbind("."+r.widgetName))}))},i.prototype._handleSort=function(e,r){var i=e.options,s=this.options.columns;if(this.options.allowSorting){var o=i.sortDirection==="none"?"ascending":i.sortDirection==="ascending"?"descending":"ascending",u={column:i,sortDirection:o,sortCommand:i.dataKey+" "+(o==="ascending"?"asc":"desc")};if(this._onColumnSorting(u)){i.sortDirection=u.sortDirection,r?i._sortOrder=this.mCustomSortOrder++:(this.mCustomSortOrder=1e3,n.each(this._allColumns(),function(n,r){r.options._sortOrder=0;if(r instanceof t.c1field){var i=r.options;r!==e&&(!i.groupInfo||i.groupInfo.position==="none")&&(i.sortDirection="none")}}));var a={column:i,sortDirection:i.sortDirection,sortCommand:i.dataKey+" "+(i.sortDirection==="ascending"?"asc":"desc")};this._customPagingEnabled()?this._onColumnSorted(a):this.ensureControl(!0,{afterRefresh:function(){this._onColumnSorted(a)}})}}},i.prototype._handleDragnDrop=function(e,t,r,i,s){var o=e.options,u=t&&t.options||null,a=i?"groupArea":"columns",f=s?"groupArea":"columns";if(s)this._onColumnGrouping({drag:o,drop:u,dragSource:a,dropSource:f,at:r})&&this.ensureControl(!0,{beforeRefresh:function(){if(!u)o.groupedIndex=0;else switch(r){case"left":o.groupedIndex=u.groupedIndex-.5;break;case"right":o.groupedIndex=u.groupedIndex+.5}i||n.extend(!0,o,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:o,drop:u,dragSource:a,dropSource:f,at:r})}});else{var l=this._allColumns(),c=o._parentIdx>=0?l[o._parentIdx].options.columns:this.options.columns,h=u._parentIdx>=0?l[u._parentIdx].options.columns:this.options.columns,p=c===this.options.columns?this._virtualLeaves().length:0,d=h===this.options.columns?this._virtualLeaves().length:0;this._onColumnDropping({drag:o,drop:u,at:r})&&this.ensureControl(!1,{beforeRefresh:function(){c.splice(o._linearIdx-p,1);switch(r){case"left":c===h&&o._linearIdx<u._linearIdx?h.splice(u._linearIdx-d-1,0,o):h.splice(u._linearIdx-d,0,o);break;case"right":c===h&&o._linearIdx<u._linearIdx?h.splice(u._linearIdx-d,0,o):h.splice(u._linearIdx-d+1,0,o);break;case"center":u.columns.push(o)}},afterRefresh:function(){this._onColumnDropped({drag:o,drop:u,at:r})}})}},i.prototype._handleFilter=function(n,r,i){var s=(new e.grid.filterOperatorsCache(this)).getByName(r),o,u;if(s){var a=n.options;s.arity>1?(o=this.parse(a,i),u=o!==null&&(e.grid.getDataType(a)==="string"||!t.isNaN(o))):u=!0;if(u){var f={column:a,operator:s.name,value:o};this._onColumnFiltering(f)&&(a.filterValue=f.value,a.filterOperator=f.operator,this._resetDataProperitesOnFilterChanging(),this._customPagingEnabled()?this._onColumnFiltered({column:a}):this.ensureControl(!0,{afterRefresh:function(){this._onColumnFiltered({column:a})}}))}}},i.prototype._handleUngroup=function(e){var t=e.options;this._onColumnUngrouping({column:t})&&this.ensureControl(!0,{beforeRefresh:function(){delete t.groupedIndex,n.extend(!0,t,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:t})}})},i.prototype._onVirtualScrolling=function(e,t,r,i,s,o){var u=this;this.ensureControl(this._serverSideVirtualScrolling(),{virtualScrollData:{direction:"v",newBounds:e,request:t,mode:r,data:o},beforeRefresh:function(){u._view().resetRowsHeightsCache()},beforeOnRendered:function(e){var t=u._viewPortBounds();n.extend(t,e.virtualScrollData.newBounds)},afterRefresh:function(e){u._view()._adjustRowsHeights(),u._UIFrozener().ensureVBarHeight(),s&&s(i)}})},i.prototype._handleVerticalVirtualScrolling=function(e,t,n){typeof t=="undefined"&&(t=null);var r=this._view(),i=this._viewPortBounds(),s=this._ensureRenderableBounds({start:e,end:e+r.getVirtualPageSize()-1}),o=this._ensureTotalRowsBounds({start:this.mDataOffset,end:this.mDataOffset+this.mDataViewWrapper.dataView().count()-1}),u=null,a,f=r.getVirtualPageSize();t?a=t:s.start>i.end||s.end<i.start?a=3:s.start>i.start?a=2:s.start<i.start?a=1:a=s.start!==i.start||s.end!==i.end?3:0;if(this._serverSideVirtualScrolling())switch(a){case 3:u={index:e,maxCount:f};break;case 2:s.end>o.end&&(u={index:o.end+1,maxCount:f});break;case 1:s.start<o.start&&(u={index:Math.max(0,o.start-f),maxCount:0},u.maxCount=o.start-u.index)}a!==0&&this._onVirtualScrolling(s,u,a,e,n)},i.prototype._handleHorizontalVirtualScrolling=function(e,t){var n=this;this.mRenderableColumns=e,this.mRenderedLeaves=[],n._allowCellEditing()&&n.currentCell()._isValid()&&n.currentCell()._isEdit()&&n.endEdit(!0),this.ensureControl(!1,{virtualScrollData:{direction:"h"},afterRefresh:function(e){n._attachEvents(),t&&t()}})},i.prototype._serverSideVirtualScrolling=function(){return!1},i.prototype._serverSideVirtualScrollingMargin=function(){var e=this._view().getVirtualPageSize()*2;return e<20&&(e=20),e},i.prototype._onBeforeCellEdit=function(e){return this._trigger("beforeCellEdit",null,e)},i.prototype._onBeforeCellUpdate=function(e){return this._trigger("beforeCellUpdate",null,e)},i.prototype._onInvalidCellValue=function(e){return this._trigger("invalidCellValue",null,e)},i.prototype._onAfterCellUpdate=function(e){return this._trigger("afterCellUpdate",null,e)},i.prototype._onAfterCellEdit=function(e){return this._trigger("afterCellEdit",null,e)},i.prototype._onColumnDropping=function(e){return this._trigger("columnDropping",null,e)},i.prototype._onColumnDropped=function(e){this._trigger("columnDropped",null,e)},i.prototype._onColumnGrouping=function(e){return this._trigger("columnGrouping",null,e)},i.prototype._onColumnGrouped=function(e){this._trigger("columnGrouped",null,e)},i.prototype._onColumnUngrouping=function(e){return this._trigger("columnUngrouping",null,e)},i.prototype._onColumnUngrouped=function(e){this._trigger("columnUngrouped",null,e)},i.prototype._onColumnFiltering=function(e){return this._trigger("filtering",null,e)},i.prototype._onColumnFiltered=function(e){this._trigger("filtered",null,e)},i.prototype._onFilterOperatorsListShowing=function(e){this._trigger("filterOperatorsListShowing",null,e)},i.prototype._onColumnSorting=function(e){return this._trigger("sorting",null,e)},i.prototype._onColumnSorted=function(e){this._trigger("sorted",null,e)},i.prototype._onCurrentCellChanged=function(t,r){var i=this,s=this.options,o=this.currentCell(),u=o.row(),a=function(){var s=i.currentCell(),o=i._getDataCellsRange(0);if(i.options.highlightCurrentCell){var u=new e.grid.cellInfo(r.changingEventArgs.oldCellIndex,r.changingEventArgs.oldRowIndex,i);u._isValid&&o._containsCellInfo(u)&&i._highlightCellPosition(u,!1),i._highlightCellPosition(s,!0)}var a;r.setFocus&&(a=s.tableCell())&&i._setFocusOnCell(r.hasFocusedChild?n(t.target):n(a),r.hasFocusedChild,s.columnInst()),i._trigger("currentCellChanged"),r.changeSelection&&i._updateSelection(t,r.selectionExtendMode);var f=t&&(t.type||"").toLowerCase()||"";f==="click"&&i._editBySingleClick()&&i._beginEditInternal(t)};this.mCurrentCellLocker=!0,this.mDataViewWrapper.currentPosition(u&&u.type&2?u.dataItemIndex:-1);if(this._lgGetScrollMode()!=="none"&&o&&!o.isEqual(e.grid.cellInfo.outsideValue)){var f=o,u=f.row();u&&!(u.type&2)&&!f.tableCell()&&(f=o._clone(),f.cellIndex(0)),this._view().scrollTo(f,function(){try{a()}finally{i.mCurrentCellLocker=!1}},r)}else try{a()}finally{this.mCurrentCellLocker=!1}},i.prototype._onDetailCreating=function(e){this._trigger("detailCreating",null,e)},i.prototype._onDetailsLoaded=function(e){this._trigger("detailsLoaded",null,e)},i.prototype._onPageIndexChanging=function(e){return this._trigger("pageIndexChanging",null,e)},i.prototype._onPageIndexChanged=function(e){this._trigger("pageIndexChanged",null,e)},i.prototype._onPagerWidgetPageIndexChanging=function(e,t){t.handled=!0},i.prototype._onPagerWidgetPageIndexChanged=function(e,t){this._setOption("pageIndex",t.newPageIndex)},i.prototype._onRendering=function(t){var n=this._view(),r=e.grid.wijgrid.CSS;this._rendered=!1,this.mAllowVVirtualScrolling=undefined,this.mAllowHVirtualScrolling=undefined;if(!t.virtualScrollData){var i=this._currentCell();this.mCurrentCellPrevCycle=i?{x:i.cellIndex(),y:i.rowIndex(),dataItemIndex:i.row()?i.row().dataItemIndex:-1}:{x:-1,y:-1,dataItemIndex:-1},this._currentCell(null),n&&n.dispose(),this._detachEvents(!1),this.mRenderCounter===0&&e.grid.emptyTable(this.element[0]),this.mOuterDiv[0].style.height||(this._isHeightTemporaryFixed=!0,this.mOuterDiv.height(this.mOuterDiv.height())),this.element.detach(),this.element.css({"table-layout":"",width:""}),this.element.empty(),this.mOuterDiv.children(":not(."+r.spinnerMarker+")").remove(),this.mOuterDiv.append(this.element),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null),this.mKeyDownEventListener&&(this.mKeyDownEventListener.dispose(),this.mKeyDownEventListener=null)}this._trigger("rendering")},i.prototype._onRendered=function(e){var t=this._view(),n,r=this.selection().selectedCells().length()>0;this._rendered=!0,this.mRenderCounter++;if(!e.virtualScrollData)this._isHeightTemporaryFixed&&(this._isHeightTemporaryFixed=!1,this.mOuterDiv[0].style.height=""),this.mSelection=null,this._attachEvents(),this._setAttr(t.focusableElement(),"tabIndex",0),n=this._currentCellFromDataView(this.mCurrentCellPrevCycle.x),!n._isValid()&&this.options.showSelectionOnRender&&(n=this._getFirstDataRowCell(0)),this.currentCell(n,null,!0),this._UISelection(!0),this._setSizeInternal(this.mScrollingState);else{var n=this.currentCell();this.currentCell(n,null,!1),n._isEdit()&&!n._isRendered()&&n._isEdit(!1);var i=this.selection();i._ensureSelection()}(!e.virtualScrollData||this._allowHVirtualScrolling())&&this._recreateResizerUI(),this._trigger("rendered")},i.prototype._recreateResizerUI=function(){var t=this;this._resizerui&&this._resizerui.dispose(),this._resizerui=new e.grid.uiResizer(this);var r=this._allowHVirtualScrolling()?this.columns():this._renderedLeaves();n.each(r,function(e,n){n._isRendered()&&n.options._isLeaf&&t._resizerui.addElement(n)})},i.prototype._onClick=function(t){if(!this._canInteract()||!t.target)return;var r=this._view(),i=this._findUntilOuterDiv(t.target,{td:!0,th:!0}),s,o,u=0,a,f,l=!1,c=!!t&&t.type==="click";if(i){if(c&&n(t.target).hasClass(e.grid.wijgrid.CSS.groupToggleVisibilityButton))return this._onGroupBtnClick(t),t.stopPropagation(),!1;s=n(i).closest("tr");if(!s.length)return;o=r.getAbsoluteCellInfo(i,!1);if(s.hasClass(e.grid.wijgrid.CSS.dataRow)||s.hasClass(e.grid.wijgrid.CSS.headerRow)||s.hasClass(e.grid.wijgrid.CSS.filterRow)){if(o.cellIndex()<0||o.rowIndex()<0)o.rowIndex()>=0?(this.options.scrollingSettings.virtualizationSettings.mode!=="none"&&(o=r.getAbsoluteCellInfo(i,!0)),o=new e.grid.cellInfo(0,o.rowIndex()),u=2,l=!0):o.cellIndex()>=0&&(this._allowHVirtualScrolling()&&(o=r.getAbsoluteCellInfo(i,!0)),o=this._getFirstDataRowCell(o.cellIndex()),u=1,l=!0);l||(o=r.getAbsoluteCellInfo(i,!0)),this._changeCurrentCell(t,o,{changeSelection:!0,setFocus:c,selectionExtendMode:u})}if(c){var h={cell:o};this._trigger("cellClicked",null,h)}}},i.prototype._onDblClick=function(e){!this._editBySingleClick()&&this._testForThis(e.target)&&this._beginEditInternal(e)},i.prototype._onGroupBtnClick=function(t){if(!this._canInteract())return;var r=n(t.target).closest("tr"),i=e.grid.groupHelper,s=i.getGroupInfo(r[0]),o=this;if(s){var u=i.getColumnByGroupLevel(this._leaves(),s.level),a=null;if(u){var f=u.options.groupInfo.expandInfo[s.index];f.isExpanded?f.collapse(this,u):f.expand(this,u,t.shiftKey),this._allowVVirtualScrolling()?(this._rebuildRenderableRowsCollection(),this._view().vsUI._changeVisibleRowsCount(this._renderableRowsRange().capacity()),this._ensureLowerBoundVisible(this._viewPortBounds()),this._handleVerticalVirtualScrolling(this._viewPortBounds().start,3)):a=f.cr,this.setSize(undefined,undefined,a)}}},i.prototype._onKeyDown=function(t){var r=this._KeyDownEventListener().isHiddenInput(n(t.target));if(!this._canInteract()||r&&this._KeyDownEventListener().canHandle(t))return!0;var i=t.target.tagName.toLowerCase(),s=n(t.target),o=this.currentCell(),u=e.getKeyCodeEnum(),a=undefined;if(!!r||i!=="input"&&i!=="option"&&i!=="select"&&i!=="textarea"||s.closest("tr.wijmo-wijgrid-datarow").length!==0){if(this._allowCellEditing()){if((t.which===u.ESCAPE||t.which===113)&&o._isValid()&&o._isEdit())return this._endEditInternal(t,t.which===u.ESCAPE),!1;if(t.which===113)return this._beginEditInternal(t),!1}if(!this.options.allowKeyboardNavigation)return!0;var f;switch(t.which){case u.DOWN:case u.PAGE_DOWN:case u.UP:case u.PAGE_UP:case u.LEFT:case u.RIGHT:case u.HOME:case u.END:case u.TAB:if(t.which===u.TAB){var l=this._visibleLeaves();if(!l||!l.length)return!0}if(r||this._canMoveToAnotherCell(t.target,t.which)){var c=this._getDataCellsRange(2);f=this._getNextCurrentCell(c,o,t.keyCode,t.shiftKey)}}if(f)return this._changeCurrentCell(t,f,{changeSelection:!0,setFocus:!0}),!1;if(t.which===u.TAB){a=n(this._view().focusableElement());if(t.shiftKey){if(a&&t.target!==a[0])return a.focus(),!1}else t.target===a[0]&&o._isValid()&&this._setFocusOnCell(n(o.tableCell()),!1,o.columnInst())}return!0}return!0},i.prototype._onFocusIn=function(e){this.options.allowKeyboardNavigation&&e&&e.target&&n(e.target).is(":input")&&!this._KeyDownEventListener().isHiddenInput(n(e.target))&&this._testForThis(e.target)&&this._onClick(e)},i.prototype._onMouseMove=function(t){if(!this.options.highlightOnHover||!this._canInteract()||this._frozenerui&&this._frozenerui.inProgress())return;var r=this._findUntilOuterDiv(t.target,{td:!0,th:!0});if(r){var i=n(r).closest("tr");if(!i.length||!i.hasClass(e.grid.wijgrid.CSS.dataRow)&&!i.hasClass(e.grid.wijgrid.CSS.headerRow))return;var s=this._view().getAbsoluteCellInfo(r,!0),o=s.rowIndex();o!==this._hover()&&(this._hover(-1),this._hover(o))}},i.prototype._onToggleHierarchy=function(e,t){if(!this._canInteract())return;var n=this.details()[t.dataRowIndex];n.isExpanded()?n.collapse():n.expand()},i.prototype._onMouseOut=function(t){if(!this._canInteract())return;if(this._hover()>=0){var r=this._findUntilOuterDiv(t.relatedTarget,{tr:!0});(!r||!n(r).hasClass(e.grid.wijgrid.CSS.dataRow))&&this._hover(-1)}},i.prototype._onWinResize=function(t){var n=this;if(e.grid.wijgrid.IGNORE_WIN_RESIZE)return;this._windowResizeTimer>0&&(window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=0),this._windowResizeTimer!==-1&&(this._windowResizeTimer=window.setTimeout(function(){n._windowResizeTimer=-1;try{if(!n.mDestroyed&&n._initialized&&n.element.parent().length&&n.element.is(":visible")){var t=e.grid.getWindowOrientation(),r=n.mResizeOnWindowResize&&(!e.grid.isMobile()||t!==n._winOrientation);n._winOrientation=t,r&&(n._onWindowResize(),n.setSize())}}finally{n._windowResizeTimer=0}},e.grid.wijgrid.WIN_RESIZE_TIMEOUT))},i.prototype._onWindowResize=function(){},i.prototype._fieldResized=function(e,n,r){n<0&&(n=0),r<=0&&(r=1);var i={column:e.options,oldWidth:n,newWidth:r};if(this._trigger("columnResizing",null,i)!==!1){if(t.isNaN(i.newWidth)||i.newWidth<0)i.newWidth=1;e.option("width",i.newWidth);if(this._allowHVirtualScrolling())this.doRefresh();else if(this._allowVVirtualScrolling()&&!this._serverSideVirtualScrolling()&&this._lgGetScrollMode()==="auto"){var s=this._view();s._isLastItemRendered()&&s._canRenderMoreItems()&&this.doRefresh()}var o={column:e.options};this._trigger("columnResized",null,o)}},i.prototype._setFocusOnCell=function(e,t,n){t||this._KeyDownEventListener().focus(e,n)},i.prototype._findFocusedChild=function(e){var t=e.find(":focus");return t.length?t:null},i.prototype._changeCurrentCell=function(t,r,i){if(this.mCurrentCellLocker)return;var s=this.currentCell(),o=this._getDataCellsRange(0);if(o._isValid()&&o._containsCellInfo(r)||r.isEqual(e.grid.cellInfo.outsideValue)){var u=t&&t.target&&n(t.target),a=r.tableCell(),f=r.container(),l=null;i.hasFocusedChild=!!(a&&u&&u[0]!==a&&u[0]!==f[0]&&!this._KeyDownEventListener().isHiddenInput(u)&&(l=this._findFocusedChild(f)));if(s.cellIndex()!==r.cellIndex()||s.rowIndex()!==r.rowIndex()){var c={cellIndex:r.cellIndex(),rowIndex:r.rowIndex(),oldCellIndex:s.cellIndex(),oldRowIndex:s.rowIndex()};if(!this._trigger("currentCellChanging",null,c))return!1;var h=!1;if(!this._allowCellEditing()||!s._isEdit()||(h=this._endEditInternal(null)))i.changingEventArgs=c,s=r._clone(),s._setGridView(this),this._currentCell(s),this._onCurrentCellChanged(t,i)}else this.options.highlightCurrentCell&&this._highlightCellPosition(s,!0),i.changeSelection&&this._updateSelection(t,i.selectionExtendMode),a&&!s._isEdit()&&(t&&this._editBySingleClick()?(this.mCurrentCellLocker=!0,this._beginEditInternal(t),this.mCurrentCellLocker=!1):i.setFocus&&this._setFocusOnCell(i.hasFocusedChild?l:n(a),i.hasFocusedChild,s.columnInst()))}return!0},i.prototype._highlightCellPosition=function(t,r){if(t&&t._isValid()){var i=t.cellIndexAbs(),s=t.rowIndexAbs(),o=e.grid.renderState,u=this._view(),a,f,l;f=u.getHeaderCell(i),f&&(a=u._getRowInfo(this._headerRows().item(t.column()._thY)),f=n(f),l=u._changeCellRenderState(f,2,r),this.mCellStyleFormatter.format(f,i,t.columnInst(),a,l)),t._isRendered()&&(f=u.getJoinedRows(s,0),f&&(a=u._getRowInfo(f),u._changeRowRenderState(a,2,r),this.mRowStyleFormatter.format(a)),f=u.getCell(i,s),f&&(f=n(f),l=u._changeCellRenderState(f,2,r),this.mCellStyleFormatter.format(f,i,t.columnInst(),a,l)))}},i.prototype._hover=function(e){return arguments.length&&(e>=0?(this._hoverRowCss(e,!0),this._prevHoveredSketchRowIndex=e):(this._hoverRowCss(this._prevHoveredSketchRowIndex,!1),this._prevHoveredSketchRowIndex=-1)),this._prevHoveredSketchRowIndex},i.prototype._hoverRowCss=function(e,t){if(e>=0){var n=this._view(),r=n._getRowInfoBySketchRowIndex(e);r&&(n._changeRowRenderState(r,4,t),r.$rows&&this.mRowStyleFormatter.format(r))}},i.prototype._beginEditInternal=function(t){if(this._canInteract()&&this._allowCellEditing()){var n=this.currentCell(),r=n.column(),i;if(r&&!r.readOnly)return i=(new e.grid.cellEditorHelper).cellEditStart(this,n,t),i}return!1},i.prototype._endEditInternal=function(r,i){typeof i=="undefined"&&(i=!1);if(this._canInteract()&&this._allowCellEditing()){var s=this.currentCell(),o=new e.grid.cellEditorHelper,u=s.row();if(u&&!u.data)return!1;var a=o.updateCell(this,s,r,i);if(a&2){if(a&8)return!0;o.cellEditEnd(this,s,r),s=this.currentCell();var f=s.tableCell();return f?this._KeyDownEventListener().focus(n(f),s.columnInst()):n(this._view().focusableElement()).focus(),!this._allowVVirtualScrolling()&&!(s.columnInst()instanceof t.c1booleanfield)&&this._view().ensureHeight(s.rowIndex()),!0}}return!1},i.prototype._onViewInsertEmptyRow=function(e,t,n,r,i,s,o,u){return null},i.prototype._onViewCreateEmptyCell=function(e,t,n){return null},i.prototype._onViewCellRendered=function(e,t,n,r,i){},i.prototype._onViewRowRendered=function(e,t,n){},i.prototype._readTableSection=function(t,n,r){var i=n===2&&this._serverShaping(),s=this.options._htmlTrimMethod;return e.grid.readTableSection(t,n,i,s,r)},i.prototype._getDataParser=function(t){return t.dataParser||e.data.defaultParsers[t.dataType]||e.data.defaultParsers.string},i.prototype._needParseColumnDOM=function(t){return e.grid.getDataType(t)!=="string"&&e.grid.validDataKey(t.dataKey)},i.prototype._getDOMReaderCulture=function(){return null},i.prototype.parseCtx=function(e,t,n,r,i){return this.parse(e,t,i)},i.prototype.parseCtxFailed=function(e,t,n,r,i){return t},i.prototype.parse=function(t,r,i){var s=e.grid.getDataType(t),o=e.grid.getDataType(t);return n.isFunction(r)&&(r=r()),r=e.data.convert(r,s,o,{culture:i||this.mClosestCulture,format:t.dataFormatString,nullString:this.options.nullString,parser:t.dataParser}),r},i.prototype.toStr=function(t,n,r){var i=this.mDataViewWrapper.dataView(),s=e.grid.getDataType(t),o="string";return n=e.data.convert(n,s,o,{culture:r||this.mClosestCulture,format:t.dataFormatString,nullString:this.options.nullString,parser:t.dataParser}),n},i.prototype._funcOptions=function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","cellClicked","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","detailCreating","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},i.prototype._canInteract=function(){return!this.options.disabled&&this.mLoadingDetails===0},i.prototype._canMoveToAnotherCell=function(t,r){var i=t.tagName.toLowerCase(),s,o,u,a;switch(i){case"input":if(n(t).hasClass(e.grid.wijgrid.CSS.inputMarker)){var f=t;return f.type==="text"?(s=f.value.length,o=(new e.grid.domSelection(f)).getSelection(),u=e.getKeyCodeEnum(),a=r===u.TAB||r===u.UP||r===u.DOWN||r===u.PAGE_DOWN||r===u.PAGE_UP||o.length===0&&(o.start===0&&(r===u.LEFT||r===u.HOME)||o.end>=s&&(r===u.RIGHT||r===u.END)),a):!0}return!1;case"textarea":case"select":return!1}return!0},i.prototype._editBySingleClick=function(){var e=(this.options.editingInitOption||"").toLowerCase();switch(e){case"click":case"doubleclick":break;case"auto":default:e=this._isMobileEnv()?"click":"doubleclick"}return e==="click"},i.prototype._getDataToAbsOffset=function(){var e=0,t=0,n=this._headerRows();return e+=this._virtualLeaves().length,n&&(t+=n.length()),this._filterRow()&&t++,{x:e,y:t}},i.prototype._currentCellFromDataView=function(t){var n=this.mDataViewWrapper.currentPosition(),r=new e.grid.cellInfo(t,this._dataViewDataRowIndexToGrid(n),null);return r.rowIndex()<0?r.cellIndex(-1):r.cellIndex()<0&&r.cellIndex(0),r},i.prototype._dataViewDataRowIndexToGrid=function(e){if(e>=0&&this.mSketchTable)for(var t=0;t<this.mSketchTable.count();t++){var n=this.mSketchTable.row(t);if(n.isDataRow()&&n.dataItemIndex()===e)return t}return-1},i.prototype._getDataCellsRange=function(t,n){typeof n=="undefined"&&(n=!1);var r=0,i=0,s=this._visibleLeaves().length-1,o;switch(t){case 1:if(this._rendered){o=this._rows().length()-1;break};case 0:o=this._totalRowsCount()-1;break;case 2:o=this._renderableRowsCount()-1}s-=this._virtualLeaves().length,n&&o>0&&o--;if(s<0||o<0)r=i=s=o=-1;return new e.grid.cellInfoRange(new e.grid.cellInfo(r,i,null),new e.grid.cellInfo(s,o,null))},i.prototype._getDataItem=function(e){return this.dataView().item(e)},i.prototype._getFirstDataRowCell=function(t){var n,r,i,s=this._view(),o=this._rows(),u=e.grid.rowType;for(n=0,r=o.length();n<r;n++){i=s._getRowInfo(o.item(n));if(i.type&2)return new e.grid.cellInfo(t,n)}return e.grid.cellInfo.outsideValue},i.prototype._getNextCurrentCell=function(t,n,r,i){var s=n.cellIndex(),o=n.rowIndex(),u=e.getKeyCodeEnum(),a=this.mSketchTable,f=this._renderableRowsRange().getRenderedIndex(o),l=this._renderableRowsRange(),c,h=r===u.TAB,p=this,d=p._serverSideVirtualScrolling(),v=null,m=null,g=function(e,t,n,r){typeof r=="undefined"&&(r=!1);var i=e?l.forEachIndex:l.forEachIndexBackward,s=0,o=null;return i.call(l,t,-1,function(e){var t=e-p.mDataOffset;if(d&&(t<0||t>=a.count()))return o=e,!1;var i=a.row(t),u=i.isDataRow();if((!r||u)&&!(i.extInfo.state&1)){o=e;if(++s>=n)return!1}}),o};switch(r){case u.ENTER:case u.DOWN:(c=g(true,f+1,1))!=null&&(o=c);break;case u.PAGE_DOWN:(c=g(true,f+1,this.mPageSizeKey))!=null&&(o=c);break;case u.UP:(c=g(false,f-1,1))!=null&&(o=c);break;case u.PAGE_UP:(c=g(false,f-1,this.mPageSizeKey))!=null&&(o=c);break;case u.TAB:i?(s--,s<t.topLeft().cellIndex()&&(s=t.bottomRight().cellIndex(),(c=g(false,f-1,1,true))!=null?o=c:p.options.keyActionTab==="moveAcross"?(c=g(false,l.capacity()-1,1,true))!=null&&(o=c):o=-1)):(s++,s>t.bottomRight().cellIndex()&&(s=t.topLeft().cellIndex(),(c=g(true,f+1,1,true))!=null?o=c:p.options.keyActionTab==="moveAcross"?(c=g(true,0,1,true))!=null&&(o=c):o=-1));break;case u.END:s=t.bottomRight().cellIndex();break;case u.HOME:s=t.topLeft().cellIndex();break;case u.LEFT:s>t.topLeft().cellIndex()&&s--;break;case u.RIGHT:s<t.bottomRight().cellIndex()&&s++}if(o>=0){v=new e.grid.cellInfo(s,o,this),m=v.column();if(m&&m.rowMerge&&m.rowMerge!=="none"){var y=r==u.ENTER||r==u.DOWN||r==u.PAGE_DOWN,b=v._clone(),w=null;while(!(w=b.tableCell())&&b._isRendered())o=y?o+1:o-1,b=new e.grid.cellInfo(s,o,this);w&&(v=b)}}return v},i.prototype._testForThis=function(e){var t=i.CSS.outerDivMarker;while(e){if(e.className&&e.className.indexOf&&e.className.indexOf(t)>=0)return this.mOuterDiv[0]===e;e=e.parentNode}return!1},i.prototype._findUntilOuterDiv=function(e,t){var n=e,r=this.mOuterDiv[0],i,s,o=null;for(;n;n=n.parentNode){s=n.nodeName&&n.nodeName.toLowerCase();if(s){if(n===r){i=n;break}t[s]&&(o=n)}}return i?o:null},i.prototype._freezingAllowed=function(){return this._lgGetScrollMode()!=="none"&&!this._hasSpannedCells()},i.prototype._getStaticIndex=function(e){if(!this._freezingAllowed())return-1;var t,n=this._getDataCellsRange(1);return e?t=Math.min(this._lgGetStaticRowIndex(),n.bottomRight().rowIndex()):t=Math.min(this._lgGetStaticColumnIndex(),n.bottomRight().cellIndex()),t<-1&&(t=-1),t},i.prototype._getStaticOffsetIndex=function(e){var t=0;return e?t+=this._virtualLeaves().length:(t=this._columnsHeadersTable().length,this.options.showFilter&&t++),t},i.prototype._getRealStaticColumnIndex=function(){var t=this._getStaticOffsetIndex(!0),n=this._getStaticIndex(!1),r=n+t;if(n>=0){var i=this._visibleLeaves(),s=this._allColumns(),o=i.length;t>0&&(s=s.slice(t-1,-1));if(r<o-1){var u=e.grid.getTompostParent(i[r],s);if(u)for(r++;r<o;r++){var a=e.grid.getTompostParent(i[r],s);if(a!==u){r--;break}}}r>=o&&(r=o-1)}return r},i.prototype._getRealStaticRowIndex=function(){var e=this._getStaticOffsetIndex(!1);return this._getStaticIndex(!0)+e},i.prototype._hasMerging=function(){var e=this._leaves(),t=!1;for(var n=0,r=e.length;n<r&&!t;n++){var i=e[n].options;t=t||i._parentVis&&i.rowMerge&&i.rowMerge!=="none"}return t},i.prototype._hasBands=function(){var t=this._allColumns();for(var n=0;n<t.length;n++)if(t[n]instanceof e.grid.c1bandfield)return!0;return!1},i.prototype._hasDetail=function(){var e=this.options.detail;return e&&e.relation&&e.relation.length?e:null},i.prototype._hasGrouping=function(){var e=this._leaves(),t=!1;for(var n=0,r=e.length;n<r&&!t;n++){var i=e[n].options;t=i.groupInfo&&i.groupInfo.position!=="none"}return t},i.prototype._hasSpannedCells=function(){return this._hasGrouping()||this._hasMerging()||this._hasDetail()!==null},i.prototype._columnsHeadersTable=function(e){return arguments.length&&(this.mColumnsHeadersTable=e),this.mColumnsHeadersTable},i.prototype._view=function(){return this.mView},i.prototype._originalFooterRowData=function(){var e=this.mTFoot;return e&&e.length?e[0]:null},i.prototype._originalHeaderRowData=function(){var e=this.mTHead;return e&&e.length?e[e.length-1]:null},i.prototype._setAttr=function(e,t,r){var i=this;return e===this.element?arguments.length===2?(n.each(t,function(t,n){t in i._originalAttr||(i._originalAttr[t]=e.attr(t))}),e.attr(t)):(t in this._originalAttr||(this._originalAttr[t]=e.attr(t)),e.attr(t,r)):arguments.length===3?e.attr(t,r):e.attr(t)},i.prototype._totalRowsCount=function(){return this.mSketchTable.count()},i.prototype._renderableRowsCount=function(){return this._renderableRowsRange().capacity()},i.prototype._trackScrollingPosition=function(e,t,n){this.mScrollingState.x=e,this.mScrollingState.y=t,n!=null&&(this.mScrollingState.scrollLeft=n)},i.prototype._trackScrollingIndex=function(e){this.mScrollingState.index=e},i.prototype._uid=function(){return this.mUID===undefined&&(this.mUID=e.grid.getUID()),"wijgrid"+this.mUID},i.prototype._updateSelection=function(t,n){var r=t&&(t.type||"").toLowerCase()||"",i=this.selection(),s=this.currentCell();n=n||0,i.beginUpdate();if(r){if(s._isValid()){i._anchorCell()||i._startNewTransaction(s);switch(r){case"focusin":case"click":(!t.shiftKey||!i._multipleEntitiesAllowed())&&i._startNewTransaction(s),t.shiftKey&&t.ctrlKey?i._clearRange(new e.grid.cellInfoRange(s,s),n):i._selectRange(new e.grid.cellInfoRange(i._anchorCell(),s),t.ctrlKey,t.shiftKey,n,null);break;case"keydown":(!t.shiftKey||!i._multipleEntitiesAllowed())&&i._startNewTransaction(s),i._selectRange(new e.grid.cellInfoRange(i._anchorCell(),s),!1,t.shiftKey,0,null)}}}else i.clear(),s._isValid()&&(i._startNewTransaction(s),i._selectRange(new e.grid.cellInfoRange(s,s),!1,!1,0,null));i.endUpdate(t)},i.prototype._viewPortBounds=function(e){return arguments.length&&(this.mViewPortBounds=e),this.mViewPortBounds},i.prototype._lgGetFreezingMode=function(){return this.options.freezingMode||this.options.scrollingSettings.freezingMode},i.prototype._lgGetRowHeight=function(){return this.options.rowHeight!==undefined?this.options.rowHeight:this.options.scrollingSettings.virtualizationSettings.rowHeight},i.prototype._lgGetStaticColumnsAlignment=function(){return this.options.staticColumnsAlignment||this.options.scrollingSettings.staticColumnsAlignment},i.prototype._lgGetScrollMode=function(){return this.options.scrollMode||this.options.scrollingSettings.mode},i.prototype._lgGetStaticColumnIndex=function(){return this.options.staticColumnIndex!==undefined?this.options.staticColumnIndex:this.options.scrollingSettings.staticColumnIndex},i.prototype._lgGetStaticRowIndex=function(){return this.options.staticRowIndex!==undefined?this.options.staticRowIndex:this.options.scrollingSettings.staticRowIndex},i.prototype._hideAllFilterDropDownLists=function(){n.each(this._visibleLeaves(),function(e,n){n instanceof t.c1field&&n._hideDropDownList()})},i.WIN_RESIZE_TIMEOUT=200,i.IGNORE_WIN_RESIZE=!1,i.JQDATA_MASTER_INFO_KEY="masterinfo",i.CSS={wijgrid:"wijmo-wijgrid",root:"wijmo-wijgrid-root",editedCellMarker:"wijmo-wijgrid-cell-edit",outerDivMarker:"wijgridouterdiv",inputMarker:"wijgridinput",spinnerMarker:"wijgridspinner",table:"wijmo-wijgrid-table",TH:"wijgridth",TD:"wijgridtd",cellContainer:"wijmo-wijgrid-innercell",aggregateContainer:"wijmo-wijgrid-aggregate",rowHeader:"wijmo-wijgrid-rowheader",currentRowHeaderCell:"wijmo-wijgrid-current-rowheadercell",currentHeaderCell:"wijmo-wijgrid-current-headercell",currentCell:"wijmo-wijgrid-current-cell",cellAlignLeft:"wijalign-left",cellAlignRight:"wijalign-right",cellAlignCenter:"wijalign-center",filterList:"wijmo-wijgrid-filterlist",filter:"wijmo-wijgrid-filter",filterInput:"wijmo-wijgrid-filter-input",filterTrigger:"wijmo-wijgrid-filter-trigger",filterNativeHtmlEditorWrapper:"wijgrid-input-wrapper",headerArea:"wijmo-wijgrid-header",footerArea:"wijmo-wijgrid-footer",headerRow:"wijmo-wijgrid-headerrow",row:"wijmo-wijgrid-row",dataRow:"wijmo-wijgrid-datarow",altRow:"wijmo-wijgrid-alternatingrow",emptyDataRow:"wijmo-wijgrid-emptydatarow",filterRow:"wijmo-wijgrid-filterrow",groupHeaderRow:"wijmo-wijgrid-groupheaderrow",groupFooterRow:"wijmo-wijgrid-groupfooterrow",groupHeaderRowCollapsed:"wijmo-wijgrid-groupheaderrow-collapsed",groupHeaderRowExpanded:"wijmo-wijgrid-groupheaderrow-expanded",footerRow:"wijmo-wijgrid-footerrow",detailRow:"wijmo-wijgrid-hierarchy-detailrow",loadingOverlay:"wijmo-wijgrid-overlay",loadingText:"wijmo-wijgrid-loadingtext",groupArea:"wijmo-wijgrid-group-area",groupAreaEmpty:"wijmo-wijgrid-group-area-empty",groupAreaButton:"wijmo-wijgrid-group-button",groupAreaButtonSort:"wijmo-wijgrid-group-button-sort",groupAreaButtonClose:"wijmo-wijgrid-group-button-close",groupToggleVisibilityButton:"wijmo-wijgrid-grouptogglebtn",fixedView:"wijmo-wijgrid-fixedview",scroller:"wijmo-wijgrid-scroller",scrollableContent:"wijmo-wijgrid-scrollable-content",dndHelper:"wijmo-wijgrid-dnd-helper",dndArrowTopContainer:"wijmo-wijgrid-dnd-arrow-top",dndArrowBottomContainer:"wijmo-wijgrid-dnd-arrow-bottom",freezingHandleV:"wijmo-wijgrid-freezing-handle-v",freezingHandleH:"wijmo-wijgrid-freezing-handle-h",freezingHandleContent:"wijmo-wijgrid-freezing-handle-content",resizingHandle:"wijmo-wijgrid-resizehandle",headerCellSortIcon:"wijmo-wijgrid-sort-icon",headerCellText:"wijmo-wijgrid-headertext",detailContainerCell:"wijgrid-detail-cell",c1basefield:"wijmo-c1basefield",c1band:"wijmo-c1band",c1field:"wijmo-c1field"},i}(e.wijmoWidget);t.wijgrid=i,i.prototype.widgetEventPrefix="wijgrid",i.prototype.mDataPrefix="wijgrid",i.prototype.mCustomSortOrder=1e3,i.prototype.mPageSizeKey=10;var s=function(){function e(){this._htmlTrimMethod=2,this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-b",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c",stateHighlight:"ui-btn-down-e"},this.wijCSS={wijgrid:"",wijgridTable:"",wijgridTH:"",wijgridTD:"",wijgridCellContainer:"",wijgridRowHeader:"",wijgridCurrentRowHeaderCell:"",wijgridCurrentHeaderCell:"",wijgridCurrentCell:"",wijgridCellAlignLeft:"",wijgridCellAlignRight:"",wijgridCellAlignCenter:"",wijgridFilterList:"",wijgridFilter:"",wijgridFilterInput:"",wijgridFilterTrigger:"",wijgridFilterNativeHtmlEditorWrapper:"",wijgridHeaderArea:"",wijgridFooterArea:"",wijgridHeaderRow:"",wijgridRow:"",wijgridDataRow:"",wijgridAltRow:"",wijgridEmptyDataRow:"",wijgridFilterRow:"",wijgridGroupHeaderRow:"",wijgridGroupFooterRow:"",wijgridGroupHeaderRowCollapsed:"",wijgridGroupHeaderRowExpanded:"",wijgridFooterRow:"",wijgridDetailRow:"",wijgridLoadingOverlay:"",wijgridLoadingText:"",wijgridGroupArea:"",wijgridGroupAreaButton:"",wijgridGroupAreaButtonSort:"",wijgridGroupAreaButtonClose:"",wijgridGroupToggleVisibilityButton:"",wijgridFixedView:"",wijgridScroller:"",wijgridDndHelper:"",wijgridDndArrowTopContainer:"",wijgridDndArrowBottomContainer:"",wijgridFreezingHandleV:"",wijgridFreezingHandleH:"",wijgridResizingHandle:"",wijgridHeaderCellSortIcon:"",wijgridHeaderCellText:""},this.allowColMoving=!1,this.allowColSizing=!1,this.allowEditing=!1,this.allowKeyboardNavigation=!0,this.keyActionTab="moveAcross",this.allowPaging=!1,this.allowSorting=!1,this.allowVirtualScrolling=!1,this.calendar=null,this.cellStyleFormatter=undefined,this.columns=[],this.columnsAutogenerationMode="merge",this.culture="",this.cultureCalendar="",this.customFilterOperators=[],this.data=null,this.detail=undefined,this.editingInitOption="auto",this.editingMode="none",this.ensureColumnsPxWidth=!1,this.filterOperatorsSortMode="alphabeticalCustomFirst",this.freezingMode=undefined,this.groupAreaCaption="Drag a column here to group by that column.",this.groupIndent=10,this.highlightCurrentCell=!1,this.highlightOnHover=!0,this.loadingText="Loading...",this.nullString="",this.pageIndex=0,this.pageSize=10,this.pagerSettings={mode:"numeric",pageButtonCount:10,position:"bottom"},this.readAttributesFromData=!1,this.rowHeight=undefined,this.rowStyleFormatter=undefined,this.scrollMode=undefined,this.scrollingSettings={freezingMode:"none",mode:"none",staticColumnIndex:-1,staticRowIndex:-1,staticColumnsAlignment:"left",virtualizationSettings:{mode:"none",rowHeight:19,columnWidth:100}},this.selectionMode="singleRow",this.showFilter=!1,this.showFooter=!1,this.showGroupArea=!1,this.showSelectionOnRender=!0,this.showRowHeader=!1,this.staticColumnIndex=undefined,this.staticColumnsAlignment=undefined,this.staticRowIndex=undefined,this.totalRows=-1,this.afterCellEdit=null,this.afterCellUpdate=null,this.beforeCellEdit=null,this.beforeCellUpdate=null,this.cellClicked=null,this.columnDragging=null,this.columnDragged=null,this.columnDropping=null,this.columnDropped=null,this.columnGrouping=null,this.columnGrouped=null,this.columnResizing=null,this.columnResized=null,this.columnUngrouping=null,this.columnUngrouped=null,this.currentCellChanging=null,this.currentCellChanged=null,this.detailCreating=null,this.filterOperatorsListShowing=null,this.filtering=null,this.filtered=null,this.groupAggregate=null,this.groupText=null,this.invalidCellValue=null,this.pageIndexChanging=null,this.pageIndexChanged=null,this.selectionChanged=null,this.sorting=null,this.sorted=null,this.dataLoading=null,this.dataLoaded=null,this.loading=null,this.loaded=null,this.rendering=null,this.rendered=null}return e}();i.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijgrid",i.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(){function e(e){e&&(this.__attr=e)}return e.prototype.ensureAttr=function(){return this.__attr=this.__attr||{},this.__attr},e.prototype.attr=function(e,t){if(arguments.length==0)return this.__attr;if(arguments.length==1)return this.__attr?this.__attr[e]:null;this.ensureAttr()[e]=t},e.prototype.style=function(e,t){if(arguments.length==0)return this.__style;if(arguments.length==1)return this.__style&&this.__style[e];this.ensureStyle()[e]=t},e.prototype.deleteAttr=function(e){this.__attr&&delete this.__attr[e]},e.prototype.deleteStyle=function(e){this.__style&&delete this.__style[e]},e.prototype.ensureStyle=function(){return this.__style=this.__style||{},this.__style},e}();t.SketchObject=r;var i=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.visible=function(e){if(arguments.length==0)return this._visible!==!1;this._visible=e},t}(r);t.SketchCell=i;var s=function(e){function t(t,n){e.call(this,n),this.value=t}return __extends(t,e),t}(i);t.ValueCell=s;var o=function(e){function t(t,n){e.call(this,n),this.html=t||""}return __extends(t,e),t.nbsp=function(){return new t("&nbsp;",null)},t}(i);t.HtmlCell=o;var u=function(e){function t(t,n){e.call(this,n),this.column=t}return __extends(t,e),t}(i);t.HeaderCell=u;var a=function(t){function n(e,n,r){t.call(this,r),this.rowType=e,this.renderState=n,this.extInfo={state:0}}return __extends(n,t),n.prototype.isDataRow=function(){return(this.rowType&2)===2},n.prototype.isPureDataRow=function(){var t=e.grid.rowType;return(this.rowType&-5)===2},n.prototype.dataItemIndex=function(e){return typeof e=="undefined"&&(e=0),-1},n.prototype.cellCount=function(){return this._cells?this._cells.length:0},n.prototype._ensureCells=function(){this._cells=this._cells||[]},n.prototype.add=function(e){this._ensureCells(),this._cells.push(e)},n.prototype.insert=function(e,t){this._ensureCells(),this._cells.splice(e,0,t)},n.prototype.cell=function(e){return this._cells[e]},n.prototype.valueCell=function(e){return this.cell(e)},n.prototype.removeAt=function(e){if(!this._cells)throw"Wrong index";this._cells.splice(e,1)},n.prototype.clear=function(){},n.prototype.getRowInfo=function(){return{type:this.rowType,state:this.renderState,sectionRowIndex:null,dataRowIndex:null,virtualDataItemIndex:null,dataItemIndex:this.dataItemIndex(),sketchRowIndex:null,$rows:null,_extInfo:this.extInfo}},n}(r);t.SketchRow=a;var f=function(e){function t(t,n,r){e.call(this,2|(t%2==1?4:0),n,r),this.originalRowIndex=t}return __extends(t,e),t.prototype.dataItemIndex=function(e){return typeof e=="undefined"&&(e=0),e+this.originalRowIndex},t.prototype.isDataRow=function(){return!0},t}(a);t.SketchDataRow=f;var l=function(e){function t(t,n){var r=t?16:32;e.call(this,r,1,n)}return __extends(t,e),t.prototype.getRowInfo=function(){var t=e.prototype.getRowInfo.call(this);return this.groupByValue!==undefined&&(t.groupByValue=this.groupByValue),t},t}(a);t.SketchGroupRow=l;var c=function(e){function t(t){e.call(this,1,1,t)}return __extends(t,e),t}(a);t.SketchHeaderRow=c;var h=function(e){function t(t){e.call(this,1024,1,t)}return __extends(t,e),t}(a);t.SketchDetailRow=h;var p=function(){function e(){this._table=[]}return e.prototype.getRawTable=function(){return this._table},e.prototype.row=function(e){return this._table[e]},e.prototype.valueAt=function(e,t){return this.row(e).valueCell(t).value},e.prototype.wijgridDataAttrValueAt=function(e,t){return this.row(e).valueCell(t).attr("wijgrid-data")},e.prototype.count=function(e){return typeof e=="number"&&(this._table.length=e),this._table.length},e.prototype.add=function(e){this._table.push(e)},e.prototype.insert=function(e,t){this._table.splice(e,0,t)},e.prototype.clear=function(){this._table.length=0},e.prototype.indexOf=function(e){return this._table.indexOf(e)},e.prototype.remove=function(e,t){typeof t=="undefined"&&(t=1),this._table.splice(e,t)},e.prototype.removeFirst=function(e){typeof e=="undefined"&&(e=1),this._table.splice(0,e)},e.prototype.removeLast=function(e){typeof e=="undefined"&&(e=1),this._table.splice(this._table.length-e,e)},e.prototype.replace=function(e,t){var n=this._table.splice(e,1,t);n&&n.length&&t&&(t.extInfo=n[0].extInfo)},e.prototype.updateIndexes=function(){for(var e=0;e<this._table.length;e++){var t=this._table[e];this._table[e].isDataRow()&&(t.originalRowIndex=e)}},e.prototype.isLazy=function(){return!1},e.prototype.ensureNotLazy=function(){},e.prototype.find=function(e,t){var n=this.findEx(e,t);return n?n.val:null},e.prototype.findIndex=function(e,t){var n=this.findEx(e,t);return n?n.at:-1},e.prototype.findEx=function(e,t){var n=this.count();for(var r=e;r<n;r++){var i=this.row(r);if(t(this.row(r))===!0)return{at:r,val:i}}return null},e}();t.SketchTable=p;var d=function(e){function t(t){e.call(this),this.mIsLazy=!0,this.pageSize=30;if(t==null)throw"Row source is null";this.mSource=t,this._table.length=t.count()}return __extends(t,e),t.prototype.isLazy=function(){return this.mIsLazy},t.prototype.ensureNotLazy=function(){if(!this.isLazy())return;this.ensureRange(),this.mIsLazy=!1},t.prototype.invalidate=function(){this._table=new Array(this.mSource.count()),this.isLazy()||this.updateRange()},t.prototype.row=function(t){return e.prototype.row.call(this,t)||this.ensureRange(Math.max(0,t-this.pageSize/2),this.pageSize),e.prototype.row.call(this,t)},t.prototype.ensureRange=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this._table.length-e);if(!this.isLazy())return;if(e<0)throw"Wrong range start";this._table.length=this.mSource.count();if(this._table.length==0){if(t>0)throw"Wrong range length";return}while(e<this._table.length&&this._table[e])e++;if(e>=this._table.length)return;var n=Math.min(e+t-1,this._table.length-1);while(n>=e&&this._table[n])n--;t=n-e+1,t>0&&this.updateRange(e,t)},t.prototype.updateRange=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this._table.length-e);if(this.mSource==null)throw"Cannot create sketch row because source is null";this.mSource.getRange(e,t,this._table,e)},t}(p);t.LazySketchTable=d})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(e){var t=jQuery,n=function(){function e(n,r){var i=r.split(".");this.namespace=i[0],this.widgetName=i[1],this.widgetFullName=this.namespace+"-"+this.widgetName,t.fn[this.widgetName]=function(n){var r=undefined,i=Array.prototype.slice.call(arguments,1);return typeof n=="string"&&this.length&&this.each(function(){var s=t.data(this,e.DATA_INSTANCE_PROP);if(s){if(!t.isFunction(s[n])||n.charAt(0)==="_")return!1;r=s[n].apply(s,i);if(r!==undefined)return!1}}),r},this.options=n||{},this._destroyed=!1,this._provideDefaults()}return e.prototype.option=function(e,t){var n=e;if(!arguments.length)return this.options;if(typeof e=="string"){if(t===undefined)return this.options[e];n={},n[e]=t,this._setOptions(n)}return this},e.prototype.enable=function(){this._setOption("disabled",!1)},e.prototype.disable=function(){this._setOption("disabled",!0)},e.prototype.destroy=function(){try{this._destroyed||(this._destroy(),this.element.unbind("."+this.widgetName),this.element.removeData(this.widgetFullName))}finally{this._destroyed=!0}},e.prototype.widget=function(){return this.element},e.prototype._destroy=function(){},e.prototype._setOptions=function(e){var n=this;t.each(e,function(e,t){n._setOption(e,t)})},e.prototype._attachToElement=function(t){var n=this;this.element=t,this.element&&(this.options.disabled&&this.disable(),this.element.data(e.DATA_INSTANCE_PROP,this),this.element.bind("remove."+this.widgetName,function(){n.destroy()}))},e.prototype._provideDefaults=function(){this.options.disabled=this.options.disabled||!1},e.prototype._setOption=function(e,t){var n=this["_preset_"+e],r=this.options[e];n&&(t=n.apply(this,[t,r]));if(t!==r){var i=this["_postset_"+e];this.options[e]=t,this._prepostsetOption(e,t),i&&i.apply(this,[t,r])}},e.prototype._prepostsetOption=function(e,t){},e.prototype._postset_disabled=function(e,t){},e.prototype._eventKey=function(e){return e+"."+this.widgetName},e.DATA_INSTANCE_PROP="wijemuinstance",e}();e.widgetEmulator=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function n(e){if(!$.isFunction(e))throw"'factory' must be a function.";t.push(e)}function r(e,n){for(var r=t.length-1;r>=0;r--){var i=t[r](e,n);if(i)return i}throw"Unsupported column."}var t=[];e.registerColumnFactory=n,e.asColumnInstance=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(r){function i(e,t,n){r.call(this,t,n||i.WIDGET_NAME),this.mFirstVisible=undefined,this.mWijgrid=e}return __extends(i,r),i.test=function(e){return!0},i.prototype._destroy=function(){var e=this._owner(),t=this._defCSS(),n=this._wijCSS();this.element&&(this.element.find("*").unbind("."+this.widgetName),this.element.removeClass(n.widget+" "+t.c1basefield+" "+n.stateDefault).html(this.element.find("."+t.headerCellText).html())),e&&e._UIDragndrop()&&e._UIDragndrop(!1).detach(this),r.prototype._destroy.apply(this,arguments)},i.prototype._owner=function(){return this.mWijgrid},i.prototype._attachToElement=function(e){r.prototype._attachToElement.apply(this,arguments);var t=this._owner();t.options.allowColMoving&&this._draggable()&&t._UIDragndrop(!0).attach(this)},i.prototype._provideDefaults=function(){r.prototype._provideDefaults.call(this),e.grid.shallowMerge(this.options,i.prototype.options)},i.prototype._defCSS=function(){return e.grid.wijgrid.CSS},i.prototype._wijCSS=function(){return this.mWijgrid?this.mWijgrid.options.wijCSS:{}},i.prototype._initializeCell=function(t,r,i,s,o){var u=e.grid.rowType,a=!0,f={$cell:t,$container:i,column:this.options,formattedValue:s,row:o,afterDefaultCallback:null};if((o.type&2||o.type===32||o.type===16)&&this.mWijgrid._allowVVirtualScrolling()){var l=this.mWijgrid._view().getDefaultRowHeight();i.css({overflow:"hidden",height:l})}n.isFunction(this.options.cellFormatter)&&(a=!this.options.cellFormatter(f));if(a){var u=e.grid.rowType;switch(o.type&-773){case 2:this._initializeDataCell(t,i,f.formattedValue,o);break;case 64:this._initializeFooterCell(t,i,o);break;case 1:this._initializeHeaderCell(t,i);break;case 8:this._initializeFilterCell(t,i);break;case 16:this._initializeGroupHeaderCell(t,r,i,f.formattedValue,o);break;case 1024:this._initializeDetailCell(t,i,o);break;default:this._updateHTML(o,i,f.formattedValue)}n.isFunction(f.afterDefaultCallback)&&f.afterDefaultCallback(f)}},i.prototype._initializeDataCell=function(e,t,n,r){this._setupDataCell(t,n,r)},i.prototype._initializeFooterCell=function(e,t,n){this._setupFooterCell(t,n)},i.prototype._initializeHeaderCell=function(e,t){this._attachToElement(e);var n=this._defCSS(),r=this._wijCSS();e.addClass(r.widget+" "+n.c1basefield+" "+r.stateDefault),this._setupHeaderCell()},i.prototype._initializeFilterCell=function(e,t){var n=this._defCSS(),r=this._wijCSS();t.addClass(r.widget+" "+r.stateDefault),this._setupFilterCell(t)},i.prototype._initializeGroupHeaderCell=function(e,t,n,r,i){var s=this.mWijgrid;if(t===this.mWijgrid._virtualLeaves().length){var o=this.mWijgrid._groupedLeaves()[i._extInfo.groupLevel-1];if(o){var u=o.options.groupInfo;if(u&&u.outlineMode!=="none"){var a=(i._extInfo.state&2)!=0;r=this._getToggleButtonHtml(a,a?u.collapsedImageClass:u.expandedImageClass)+r}}}this._updateHTML(i,n,r)},i.prototype._initializeDetailCell=function(e,t,n){e.addClass(this._defCSS().detailContainerCell),this._setupDetailCell(t,n)},i.prototype._getToggleButtonHtml=function(e,t){var n=this._defCSS(),r=this._wijCSS(),i=t||(e?r.iconArrowRight:r.iconArrowRightDown);return'<div class ="'+r.icon+" "+i+" "+n.groupToggleVisibilityButton+" "+r.wijgridGroupToggleVisibilityButton+'">&nbsp;</div>'},i.prototype._cellRendered=function(e,t,n){},i.prototype._needToEncodeValue=function(e){return!1},i.prototype._updateHTML=function(e,t,n){var r=this._needToEncodeValue(e);this.mWijgrid.mCellFormatter.updateHTML(t,n,r)},i.prototype._getHeaderContent=function(){return this.options.headerText||"&nbsp;"},i.prototype._createHeaderContent=function(e){e.html(this._getHeaderContent())},i.prototype._decorateHeaderContent=function(e){var t=this._defCSS(),n=this._wijCSS();e.wrapInner('<span class="'+t.headerCellText+" "+n.wijgridHeaderCellText+'" />')},i.prototype._setupHeaderCell=function(){var e=this.element.children("."+this._defCSS().cellContainer).empty();this._createHeaderContent(e),this._decorateHeaderContent(e)},i.prototype._setupFilterCell=function(e){},i.prototype._setupDataCell=function(e,t,n){this._updateHTML(n,e,t)},i.prototype._setupFooterCell=function(e,t){this._updateHTML(t,e,this.options.footerText||this.options._footerTextDOM)},i.prototype._setupDetailCell=function(e,n){var r=this._owner(),i=r.mSketchTable.row(n.sketchRowIndex-1),s=r.details()[i.originalRowIndex];s.isExpanded()&&(r.mLoadingDetails++,r._view()._addDetailInstantiator(function(){t.detailInstantiator.instantiateIn(e,r,s.masterKey(),i.originalRowIndex),e=null}))},i.prototype._postset_headerText=function(e,t){this._setupHeaderCell()},i.prototype._postset_visible=function(e,t){var n=this,r=n._owner();r._allowHVirtualScrolling()&&r._resetScrollState(),r.ensureControl(!1)},i.prototype._postset_width=function(e,t){var n=this._owner()._isDetail();try{n&&this._owner()._ignoreSizing(!1),this.options.ensurePxWidth=!0,this.options._realWidth=e,this._owner().setSize()}finally{n&&this._owner()._ignoreSizing(!0)}},i.prototype._draggable=function(){return!0},i.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},i.prototype._canDrag=function(){return this.options.allowMoving===!0},i.prototype._canDropTo=function(t){return e.grid.isChildOf(this._owner()._allColumns(),t,this)?!1:!0},i.prototype._canDropToGroupArea=function(){return!1},i.prototype._visible=function(){return this.options._visLeavesIdx>=0},i.prototype._isFirstVisible=function(){return this.mFirstVisible===undefined&&(this.mFirstVisible=this.options._visLeavesIdx===this.mWijgrid._virtualLeaves().length),this.mFirstVisible},i.prototype._isRendered=function(){return this._visible()&&this.mWijgrid._renderableColumnsRange().contains(this)},i.prototype._strictWidthMode=function(){return!!(this.options.ensurePxWidth||this.mWijgrid.options.ensureColumnsPxWidth||this.mWijgrid._allowHVirtualScrolling())},i.WIDGET_NAME="wijmo.c1basefield",i}(t.widgetEmulator);t.c1basefield=r;var i=function(){function e(){this.allowMoving=!0,this.allowSizing=!0,this.cellFormatter=undefined,this.ensurePxWidth=undefined,this.footerText=undefined,this.headerText=undefined,this.textAlignment=undefined,this.visible=!0,this.width=undefined}return e}();t.c1basefield_options=i,r.prototype.options=e.grid.extendWidgetOptions({},new i),e.grid.registerColumnFactory(function(e,t){return r.test(t)?new r(e,t):null})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(e){function t(n,r,i){e.call(this,n,r,i||t.WIDGET_NAME)}return __extends(t,e),t.getInitOptions=function(){var e={};return e._clientType=t.CLIENT_TYPE,e._parentVis=!0,e},t.test=function(e){return e._clientType===t.CLIENT_TYPE},t.prototype._provideDefaults=function(){e.prototype._provideDefaults.call(this),this.options.allowMoving=!1,this.options.allowSizing=!1,this.options.dataKey=null,this.options.width=t.COLUMN_WIDTH,this.options.ensurePxWidth=!0},t.prototype._initializeCell=function(t,n,r,i,s){var o=this._defCSS(),u=this._wijCSS();e.prototype._initializeCell.apply(this,arguments),t.attr({role:"rowheader",scope:"row"}).addClass(u.stateDefault+" "+u.content+" "+o.rowHeader+" "+u.wijgridRowHeader)},t.prototype._initializeDetailCell=function(t,n,r){e.prototype._initializeDetailCell.apply(this,arguments),t.removeClass(this._defCSS().detailContainerCell)},t.prototype._setupDetailCell=function(e,t){this._updateHTML(t,e,"")},t.prototype._draggable=function(){return!1},t.prototype._isFirstVisible=function(){return!1},t.CLIENT_TYPE="c1rowheaderfield",t.WIDGET_NAME="wijmo.c1rowheaderfield",t.COLUMN_WIDTH=22,t}(t.c1basefield);t.c1rowheaderfield=r,r.prototype.options=e.grid.extendWidgetOptions({},new t.c1basefield_options),e.grid.registerColumnFactory(function(e,t){return r.test(t)?new r(e,t):null})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(t){function n(e,r,i){t.call(this,e,r,i||n.WIDGET_NAME)}return __extends(n,t),n.test=function(e){return e._clientType===n.CLIENT_TYPE},n.getInitOptions=function(){var t=e.grid.c1rowheaderfield.getInitOptions();return t._clientType=n.CLIENT_TYPE,t},n.prototype._setupDataCell=function(e,t,n){var r=this;if(n.type&512)this._updateHTML(n,e,"&nbsp;");else{var i=this._getToggleButtonHtml((n._extInfo.state&2)!=0);this._updateHTML(n,e,i),e.find("."+this._defCSS().groupToggleVisibilityButton).click(function(e){return r._owner()._onToggleHierarchy(e,n),e.stopPropagation(),!1}).dblclick(function(e){return e.stopPropagation(),!1})}},n.CLIENT_TYPE="c1detailrowheaderfield",n.WIDGET_NAME="wijmo.c1detailrowheaderfield",n}(t.c1rowheaderfield);t.c1detailrowheaderfield=r,e.grid.registerColumnFactory(function(e,t){return r.test(t)?new r(e,t):null})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(r){function i(e,t,n){r.call(this,e,t,n||i.WIDGET_NAME),this.mFilterEditorInitialized=!1}return __extends(i,r),i.test=function(t){return e.grid.validDataKey(t.dataKey)},i.isGroupedColumn=function(t){var n=t.options;return e.grid.c1field.test(n)&&n.groupInfo&&n.groupInfo.position&&n.groupInfo.position!=="none"},i.prototype._destroy=function(){if(this.element){var e=this._defCSS();this.element.removeClass(e.c1field)}try{if(this.mFilterEditor){this.mFilterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType()){case"date":this.mFilterEditor.data("wijmo-wijinputdate")&&this.mFilterEditor.wijinputdate("destroy");break;case"text":this.mFilterEditor.data("wijmo-wijinputtext")&&this.mFilterEditor.wijinputtext("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.mFilterEditor.data("wijmo-wijinputnumber")&&this.mFilterEditor.wijinputnumber("destroy")}}this._hideDropDownList()}finally{this.mFilterEditor=null,this.mDropDownFilterList=null}r.prototype._destroy.apply(this,arguments)},i.prototype._provideDefaults=function(){r.prototype._provideDefaults.call(this),e.grid.shallowMerge(this.options,i.prototype.options),n.isFunction(this.options.dataParser)&&(this.options.dataParser=new this.options.dataParser),this.options.groupInfo=this.options.groupInfo||{},e.grid.shallowMerge(this.options.groupInfo,i.prototype.options.groupInfo)},i.prototype._initializeHeaderCell=function(e,t){r.prototype._initializeHeaderCell.apply(this,arguments);var n=this._defCSS();e.addClass(n.c1field)},i.prototype._needToEncodeValue=function(t){var n=e.grid.rowType,i=t.type&2&&!(t.type&512)?this.options.encodeHtml:r.prototype._needToEncodeValue.apply(this,arguments);return i},i.prototype._isSortable=function(){return!0},i.prototype._isSortableUI=function(){var e=this._owner();return e.options.allowSorting&&this.options.allowSort&&this._isSortable()},i.prototype._canDropTo=function(e){return r.prototype._canDropTo.apply(this,arguments)?this.options.groupedIndex!==undefined&&e instanceof t.c1groupedfield?!1:!0:!1},i.prototype._canDropToGroupArea=function(){return this.options.groupedIndex===undefined},i.prototype._decorateHeaderContent=function(t){var i=this._owner(),s=e.grid.wijgrid.CSS,o=i.options.wijCSS;if(!this._isSortable())r.prototype._decorateHeaderContent.apply(this,arguments);else{var u=this._isSortableUI();u?t.wrapInner('<a class="'+s.headerCellText+" "+o.wijgridHeaderCellText+'" href="#" role="button" />').children("a").bind("click."+this.widgetName,this,n.proxy(this._onSortableElementClick,this)):r.prototype._decorateHeaderContent.apply(this,arguments);var a=s.headerCellSortIcon+" "+o.wijgridHeaderCellSortIcon+" "+o.icon,f=null;switch(this.options.sortDirection){case"ascending":t.append(f=n('<span class="'+a+" "+o.iconArrowUp+'"></span>'));break;case"descending":t.append(f=n('<span class="'+a+" "+o.iconArrowDown+'"></span>'))}f&&u&&f.css("cursor","pointer").bind("click."+this.widgetName,this,n.proxy(this._onSortableElementClick,this))}},i.prototype._onSortableElementClick=function(e){var t=e.data;return t.options.disabled?!1:(t.options.allowSort&&t._owner()._handleSort(t,e.ctrlKey),!1)},i.prototype._showFilter=function(){return this.options.showFilter&&!this._isDetailRelationField()},i.prototype._isDetailRelationField=function(){var e=this._owner();if(!e._isRoot()){var t=e.options.relation;if(t)for(var n=0;n<t.length;n++){var r=t[n].detailDataKey,i=this.options.dataKey;if(r&&i&&(r+"").toLowerCase()===(i+"").toLowerCase())return!0}}return!1},i.prototype._setupFilterCell=function(e){if(this._showFilter()){var t=this._defCSS(),n=this._wijCSS();e.html('<table cellPadding="0" cellSpacing="0" class="'+t.filter+" "+n.wijgridFilter+" "+n.cornerAll+'">'+"<tr>"+'<td style="width:100%">'+'<input type="text" class="'+t.filterInput+" "+n.wijgridFilterInput+'" style="width:100%" />'+"</td>"+'<td class="'+t.filterTrigger+" "+n.wijgridFilterTrigger+" "+n.cornerRight+" "+n.stateDefault+'">'+'<span class="'+n.icon+" "+n.iconArrowDown+'"></span>'+"</td>"+"</tr>"+"</table>"),this._createFilterCellEditor(e)}},i.prototype._createFilterCellEditor=function(t){var r=this,i=this._owner(),s=e.grid.HTML5InputSupport.getDefaultInputType(i._isMobileEnv(),this.options),o=this._defCSS(),u=this._wijCSS(),a=this;t.find("."+o.filterTrigger).attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(e){a.options.disabled||n(this).addClass(u.stateDefault+" "+u.stateHover)}).bind("mouseleave."+this.widgetName,function(e){a.options.disabled||n(this).removeClass(u.stateDefault+" "+u.stateHover+" "+u.stateActive)}).bind("mouseup."+this.widgetName,this,function(e){a.options.disabled||n(this).removeClass(u.stateDefault+" "+u.stateActive)}).bind("mousedown."+this.widgetName,n.proxy(this._onFilterBtnClick,this)).bind("click."+this.widgetName,function(e){e.preventDefault()});var f=i.parse(this.options,e.grid.filterHelper.getSingleValue(this.options.filterValue));if(f===null||f==="undefined")switch(e.grid.getDataType(this.options)){case"boolean":f=!1;break;case"number":case"currency":f=0;break;case"datetime":f=new Date;break;default:f=""}var l={culture:i.options.culture,cultureCalendar:i.options.cultureCalendar,disabled:i.options.disabled,decimalPlaces:function(e){var t=/^(n|p|c){1}(\d*)$/.exec(e);return t&&t[2]?parseInt(t[2],10):(t=/^(d){1}(\d*)$/.exec(e),t?0:2)}(this.options.dataFormatString),imeMode:this.options.imeMode,triggerMouseUp:function(e){r._owner()._hideAllFilterDropDownLists()}};this.mFilterEditor=t.find("input").bind("keypress."+this.widgetName,n.proxy(this._onFilterEditorKeyPress,this));var c=function(e){r.mFilterEditorInitialized&&r._onFilterEditorValueChanged(e)};switch(this._getInputEditorType()){case"date":s==="text"?this.mFilterEditor.wijinputdate(n.extend(l,{date:f,dateFormat:this.options.dataFormatString||undefined,showTrigger:!0,dateChanged:function(e,t){c({value:t.data})},calendar:i.options.calendar})):this._createHtmlEditor(this.mFilterEditor,s,e.grid.HTML5InputSupport.toStr(f,s));break;case"text":this.mFilterEditor.wijinputtext(n.extend(l,{text:f+"",textChanged:function(e,t){c({value:t.text})}}));break;case"numberCurrency":this.mFilterEditor.wijinputnumber(n.extend(l,{type:"currency",value:f,valueChanged:function(e,t){c({value:t.value})}}));break;case"numberNumber":s==="text"?this.mFilterEditor.wijinputnumber(n.extend(l,{value:f,valueChanged:function(e,t){c({value:t.value})}})):this._createHtmlEditor(this.mFilterEditor,s,e.grid.HTML5InputSupport.toStr(f,s));break;case"numberPercent":this.mFilterEditor.wijinputnumber(n.extend(l,{type:"percent",value:f*100,valueChanged:function(e,t){c({value:t.value/100})}}));break;default:throw"Unsupported editor type"}this.mFilterEditorInitialized=!0},i.prototype._createHtmlEditor=function(t,n,r){var i=e.grid.wijgrid.CSS,s=this._owner().options.wijCSS;return t[0].type=n,t.addClass(s.stateDefault).wrap('<span class="'+i.filterNativeHtmlEditorWrapper+" "+s.wijgridFilterNativeHtmlEditorWrapper+'"></span').val(r)},i.prototype._onFilterBtnClick=function(t){var r=this,s=this._owner(),o=!!this.mDropDownFilterList;s._hideAllFilterDropDownLists();if(this.options.disabled||o)return!1;t.target.focus();var u=e.grid.filterHelper.getSingleOperatorName(this.options.filterOperator).toLowerCase(),a=s.getFilterOperatorsByDataType(e.grid.getDataType(this.options)),f={operators:n.extend(!0,[],a),column:this.options},l=[];s._onFilterOperatorsListShowing(f),f.operators&&n.each(f.operators,function(e,t){l.push({label:t.displayName||t.name,value:t.name,selected:t.name.toLowerCase()===u})}),this.mDropDownFilterList=n("<div />").addClass(e.grid.wijgrid.CSS.filterList+" "+s.options.wijCSS.wijgridFilterList).appendTo(document.body).wijlist({autoSize:!0,maxItemsCount:i.DROPDOWN_FILTERS_MAX,selected:function(e,t){var n=r._getFilterValueFromEditor();r._hideDropDownList(),s._handleFilter(r,t.item.value,n)}}).css("z-index",e.grid.getZIndex(s.mOuterDiv,9999)).wijlist("setItems",l).wijlist("renderList");var c=this.mDropDownFilterList.width()|150;this.mDropDownFilterList.width(l.length>i.DROPDOWN_FILTERS_MAX?c+20:c).wijlist("refreshSuperPanel").position({of:n(t.currentTarget),my:"left top",at:"left bottom"}),this.mDropDownFilterList.$button=n(t.currentTarget);var h=this.mDropDownFilterList.eventUID=e.grid.getUID();n(document).bind("mousedown."+this.widgetName+"."+h,{column:this},this._onDocMouseDown)},i.prototype._onFilterEditorKeyPress=function(t){if(t&&t.which===13){var n=this._owner(),r=this._getFilterValueFromEditor(),i=(this.options.filterOperator||"").toLowerCase();if(!r)r=undefined,i="nofilter";else if(!i||i==="nofilter")i=e.grid.getDataType(this.options)==="string"?"contains":"equals";this._hideDropDownList(),n._handleFilter(this,i,r)}},i.prototype._onDocMouseDown=function(t){var r=t.data.column,i=n(t.target),s=e.grid.wijgrid.CSS,o=i.parents("."+s.filterList+":first"),u=i.is("."+s.filterTrigger)?i:i.parents("."+s.filterTrigger+":first");u.length&&u[0]===r.mDropDownFilterList.$button[0]||o.length&&o[0]===r.mDropDownFilterList[0]||r._hideDropDownList()},i.prototype._hideDropDownList=function(){if(this.mDropDownFilterList){var e=this.mDropDownFilterList.eventUID;this.mDropDownFilterList.remove(),this.mDropDownFilterList=null,n(document).unbind("mousedown."+this.widgetName+"."+e,this._onDocMouseDown)}if(this.mFilterEditor&&this._getInputEditorType()==="date"){var t=this.mFilterEditor.data("wijmo-wijinputdate");t&&t._popupVisible()&&t._hidePopup()}},i.prototype._getInputEditorType=function(){switch(e.grid.getDataType(this.options)){case"number":return this.options.dataFormatString&&this.options.dataFormatString.indexOf("p")===0?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"text"}},i.prototype._getFilterValueFromEditor=function(){var t=this._owner(),n=e.grid.HTML5InputSupport.getDefaultInputType(t._isMobileEnv(),this.options),r;switch(this._getInputEditorType()){case"date":n==="text"?r=this.mFilterEditor.wijinputdate("option","date")||new Date:r=e.grid.HTML5InputSupport.parse(this.mFilterEditor.val(),n)||new Date;break;case"text":r=this.mFilterEditor.wijinputtext("option","text");break;case"numberNumber":if(n!=="text"){r=e.grid.HTML5InputSupport.parse(this.mFilterEditor.val(),n)||0;break};case"numberCurrency":r=this.mFilterEditor.wijinputnumber("option","value");break;case"numberPercent":r=this.mFilterEditor.wijinputnumber("option","value")/100}return r},i.prototype._setupFooterCell=function(t,n){var i=this.options;if(i.aggregate&&i.aggregate!=="none"){var s="";i._totalsValue!==undefined&&(s=e.grid.tally.getValueString(i._totalsValue,this,this._owner())),this._updateHTML(n,t,e.grid.stringFormat(i.footerText||"{0}",s||""))}else r.prototype._setupFooterCell.apply(this,arguments)},i.prototype._postset_aggregate=function(e,t){this._owner().ensureControl(!1)},i.prototype._postset_allowSort=function(e,t){this._setupHeaderCell()},i.prototype._postset_dataType=function(e,t){throw"read-only"},i.prototype._postset_dataParser=function(e,t){this._owner().ensureControl(!1)},i.prototype._postset_disabled=function(e,t){this.mFilterEditor&&n.each(this.mFilterEditor.data(),function(t,n){n&&n.widgetName&&n.option&&n.option("disabled",e)})},i.prototype._postset_dataFormatString=function(e,t){this._owner().ensureControl(!1)},i.prototype._postset_filterOperator=function(e,t){var n=this._owner();n._resetDataProperitesOnFilterChanging(),n.ensureControl(!0)},i.prototype._postset_filterValue=function(e,t){var n=this._owner();n._resetDataProperitesOnFilterChanging(),n.ensureControl(!0)},i.prototype._postset_groupInfo=function(e,t){this._owner().ensureControl(!0)},i.prototype._postset_rowMerge=function(e,t){this._owner().ensureControl(!1)},i.prototype._postset_showFilter=function(e,t){this._owner().ensureControl(!1)},i.prototype._postset_sortDirection=function(e,t){this.options._sortOrder=0,this._owner().ensureControl(!0)},i.prototype._postset_width=function(e,t){this._hideDropDownList(),r.prototype._postset_width.apply(this,arguments)},i.prototype._onFilterEditorValueChanged=function(e){},i.WIDGET_NAME="wijmo.c1field",i.DROPDOWN_FILTERS_MAX=8,i}(t.c1basefield);t.c1field=r;var i=function(e){function t(){e.apply(this,arguments),this.aggregate="none",this.allowSort=!0,this.dataKey=undefined,this.dataType=undefined,this.dataParser=undefined,this.dataFormatString=undefined,this.encodeHtml=!1,this.filterOperator="nofilter",this.filterValue=undefined,this.groupInfo={expandInfo:[],level:undefined,groupSingleRow:!0,collapsedImageClass:undefined,expandedImageClass:undefined,position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},this.imeMode="auto",this.inputType=undefined,this.readOnly=!1,this.rowMerge="none",this.showFilter=!0,this.sortDirection="none",this.valueRequired=!1}return __extends(t,e),t}(t.c1basefield_options);t.c1field_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),e.grid.registerColumnFactory(function(e,t){return r.test(t)?new r(e,t):null})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(r){function i(e,t,n){r.call(this,e,t,n||i.WIDGET_NAME)}return __extends(i,r),i.test=function(e){return t.c1field.test(e)&&e.dataType==="boolean"},i.prototype._setupDataCell=function(e,t,r){var i=this._owner(),s=this.options,o=this._defCSS(),u=i._allowCellEditing()&&s.readOnly!==!0,a=n('<input class="'+o.inputMarker+'" type="checkbox" aria-label="checkbox" />');u||a.prop("disabled",!0),i.parse(s,i.mDataViewWrapper.getValue(r.data,s.dataKey))===!0&&a.prop("checked","checked"),e.empty().append(a)},i.prototype._cellRendered=function(t,n,r){var i=this._owner(),s=i._allowCellEditing()&&this.options.readOnly!==!0;if(s){var o=e.getKeyCodeEnum();n.children("input").bind("mousedown",function(e){var t=n.parent()[0],r=i.currentCell();r.tableCell()!==t&&i._onClick({target:t}),r._isEdit()||i.beginEdit()}).bind("keydown",function(e){if(e.which===o.ENTER)return i._endEditInternal(e),!1})}},i.WIDGET_NAME="wijmo.c1booleanfield",i}(t.c1field);t.c1booleanfield=r,e.grid.registerColumnFactory(function(e,t){return r.test(t)?new r(e,t):null})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(t){function n(e,r,i){t.call(this,e,r,i||n.WIDGET_NAME)}return __extends(n,t),n.test=function(e){return!!e&&!!e.columns},n.prototype._provideDefaults=function(){t.prototype._provideDefaults.call(this),e.grid.shallowMerge(this.options,n.prototype.options),this.options.dataKey=null},n.WIDGET_NAME="wijmo.c1bandfield",n}(t.c1basefield);t.c1bandfield=r;var i=function(e){function t(){e.apply(this,arguments),this.columns=[]}return __extends(t,e),t}(t.c1basefield_options);t.c1bandfield_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),e.grid.registerColumnFactory(function(e,t){return!t||!t.columns?null:new r(e,t)})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(t){function r(e,n,i,s){t.call(this,n,s||r.WIDGET_NAME),this.mWijgrid=e,this._attachToElement(i),this._createContent(),this.mWijgrid.options.allowColMoving&&this.mWijgrid._UIDragndrop(!0).attach(this)}return __extends(r,t),r.prototype._destroy=function(){this.mWijgrid._UIDragndrop()&&this.mWijgrid._UIDragndrop(!1).detach(this),this.mWijgrid=null,t.prototype._destroy.apply(this,arguments)},r.prototype._owner=function(){return this.mWijgrid},r.prototype._createContent=function(){var t=e.grid.wijgrid.CSS,r=this.mWijgrid.options.wijCSS,i=n('<span class="'+t.groupAreaButtonClose+" "+r.wijgridGroupAreaButtonClose+" "+r.stateDefault+" "+r.cornerAll+'"><span class="'+r.icon+" "+r.iconClose+'"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.addClass(t.groupAreaButton+" "+r.wijgridGroupAreaButton+" "+r.stateDefault+" "+r.cornerAll).html(this.options.headerText||"").prepend(i),this._isSortableUI()&&this.element.bind("click."+this.widgetName,this,n.proxy(this._onSortableElementClick,this));if(this._isSortable()){var s=t.groupAreaButtonSort+" "+r.wijgridGroupAreaButtonSort+" "+r.icon;switch(this.options.sortDirection){case"ascending":this.element.append(n('<span class="'+s+" "+r.iconArrowUp+'"></span>'));break;case"descending":this.element.append(n('<span class="'+s+" "+r.iconArrowDown+'"></span>'))}}},r.prototype._onCloseClick=function(e){var t=e.data;return t.options.disabled||t.mWijgrid._handleUngroup(t),!1},r.prototype._onSortableElementClick=function(e){var t=e.data;return t.options.disabled?!1:(t.options.allowSort&&t.mWijgrid._handleSort(t,e.ctrlKey),!1)},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(e){return e instanceof r},r.prototype._canDropToGroupArea=function(){return this.options.groupedIndex!==this.mWijgrid._groupedLeaves().length-1},r.prototype._isSortable=function(){return e.grid.c1field.test(this.options)},r.prototype._isSortableUI=function(){return this.mWijgrid.options.allowSorting&&this.options.allowSort&&this._isSortable()},r.WIDGET_NAME="wijmo.c1groupedfield",r}(t.widgetEmulator);t.c1groupedfield=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){this.element.css("display","inline").addClass(this.options.wijCSS.widget)},t.prototype._destroy=function(){this.mBtnElement=null},t.prototype._init=function(){var e=this;this.mBtnElement=this._createElement(this.options).addClass("wijmo-wijgrid-commandbutton").click(function(t){!e.options.disabled&&n.isFunction(e.options.click)&&e.options.click.call(self,t)}),this.element.append(this.mBtnElement),this._attachWidget(this.mBtnElement,this.options)},t.prototype._setOption=function(t,n){var r=this.options[t];e.prototype._setOption.apply(this,[t,n]),r!==n&&t==="disabled"&&this._onDisabledChanged(n===!0)},t.prototype._createElement=function(e){throw"not implemented"},t.prototype._attachWidget=function(e,t){throw"not implemented"},t.prototype._btnElement=function(){return this.mBtnElement},t.prototype._onDisabledChanged=function(e){},t}(e.wijmoWidget);t.wijgridcommandbuttonbase=r;var i=function(){function e(){this.text=undefined,this.click=undefined,this.iconClass=undefined,this.disabled=!1,this.textDataKey=undefined}return e}();t.wijgridcommandbuttonbase_options=i,r.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("wijgridcommandbuttonbase",r.prototype);var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){var t=n('<a href="#" />').text(e.text||"");return e.disabled&&t.prop("disabled","disabled"),t},t.prototype._attachWidget=function(e,t){},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.prop("disabled",e)},t}(r);t.wijgridcommandlink=s,n.wijmo.registerWidget("wijgridcommandlink",n.wijmo.wijgridcommandbuttonbase,s.prototype);var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){return n('<input type="button" />').val(e.text)},t.prototype._attachWidget=function(e,t){e.button({disabled:t.disabled})},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.button({disabled:e})},t}(r);t.wijgridcommandbutton=o,n.wijmo.registerWidget("wijgridcommandbutton",n.wijmo.wijgridcommandbuttonbase,o.prototype);var u=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){var t,r=!!e.text;return e.mobile?(t=n('<input type="button" />'),r&&t.val(e.text)):(t=n("<button />"),r?t.text(e.text):t.html("&nbsp;")),t},t.prototype._attachWidget=function(e,t){var n=!!t.text,r={disabled:t.disabled};t.mobile?(r.icon=t.iconClass,n||(r.iconpos="notext")):(r.icons={primary:t.iconClass},r.text=n),e.button(r)},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.button({disabled:e})},t}(r);t.wijgridcommandimagebutton=u,n.wijmo.registerWidget("wijgridcommandimagebutton",n.wijmo.wijgridcommandbuttonbase,u.prototype);var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){var t;return e.mobile?t=n('<input type="button" />'):t=n("<button />").html("&nbsp;"),t},t.prototype._attachWidget=function(e,t){var n={disabled:t.disabled};t.mobile?(n.icon=t.iconClass,n.iconpos="notext"):(n.icons={primary:t.iconClass},n.text=!1),e.button(n)},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.button({disabled:e})},t}(r);t.wijgridcommandimage=a,n.wijmo.registerWidget("wijgridcommandimage",n.wijmo.wijgridcommandbuttonbase,a.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.test=function(e){return!!e&&!!e.buttonType},r.prototype._provideDefaults=function(){t.prototype._provideDefaults.call(this),e.grid.shallowMerge(this.options,r.prototype.options),this.options.dataKey=null},r.prototype._createCommand=function(t,r,i,s){var o=r.text;if(e.grid.validDataKey(r.textDataKey)&&i.data){var u=i.data[r.textDataKey];n.isFunction(u)&&(u=u()),o=e.grid.stringFormat(o,u)}var a=n.extend({},{mobile:this._owner()._isMobileEnv(),text:o,iconClass:r.iconClass,disabled:this._owner().options.disabled,click:function(e){var t=!0;if(n.isFunction(r.click)){var o=r.click.apply(this,[e,{row:i,column:this.options}]);t=o!==!1&&!e.isDefaultPrevented()}t&&s&&s.apply(this,[e,{row:i}]),e.preventDefault()}}),f=n("<div />");t.append(f);switch(this.options.buttonType){case"link":f.wijgridcommandlink(a);break;case"imageButton":f.wijgridcommandimagebutton(a);break;case"button":f.wijgridcommandbutton(a);break;case"image":f.wijgridcommandimage(a);break;default:throw"Unknown buttonType"}},r}(t.c1basefield);t.c1buttonbasefield=r;var i=function(e){function t(){e.apply(this,arguments),this.buttonType="button"}return __extends(t,e),t}(t.c1basefield_options);t.c1buttonbasefield_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(n){function r(e,t,i){n.call(this,e,t,i||r.WIDGET_NAME)}return __extends(r,n),r.test=function(e){return!!t.c1buttonbasefield.test(e)||!!e.command},r.prototype._provideDefaults=function(){n.prototype._provideDefaults.call(this),e.grid.shallowMerge(this.options,t.c1basefield.prototype.options),this.options.command=this.options.command||{},e.grid.shallowMerge(this.options.command,r.prototype.options.command)},r.prototype._setupDataCell=function(e,t,n){this._createCommand(e,this.options.command,n,null)},r.WIDGET_NAME="wijmo.c1buttonfield",r}(t.c1buttonbasefield);t.c1buttonfield=r;var i=function(e){function t(){e.apply(this,arguments),this.command=undefined}return __extends(t,e),t}(t.c1buttonbasefield_options);t.c1buttonfield_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1buttonbasefield.prototype.options,new i),e.grid.registerColumnFactory(function(e,t){return r.test(t)?new r(e,t):null})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(t){function n(e,r,i){t.call(this,e,r,i||n.WIDGET_NAME)}return __extends(n,t),n.test=function(e){return!!(e.showDeleteButton&&e.showDeleteButton!==!1||e.showEditButton&&e.showEditButton!==!1||e.cancelCommand||e.deleteCommand||e.editCommand||e.updateCommand)},n.prototype._provideDefaults=function(){t.prototype._provideDefaults.call(this),e.grid.shallowMerge(this.options,n.prototype.options),this.options.cancelCommand=this.options.cancelCommand||{},e.grid.shallowMerge(this.options.cancelCommand,n.prototype.options.cancelCommand),this.options.deleteCommand=this.options.deleteCommand||{},e.grid.shallowMerge(this.options.deleteCommand,n.prototype.options.deleteCommand),this.options.editCommand=this.options.editCommand||{},e.grid.shallowMerge(this.options.editCommand,n.prototype.options.editCommand),this.options.updateCommand=this.options.updateCommand||{},e.grid.shallowMerge(this.options.updateCommand,n.prototype.options.updateCommand)},n.prototype._setupDataCell=function(e,t,n){var r=this.options,i=this._owner();n.state&16?r.showEditButton&&(this._createCommand(e,r.updateCommand,n,function(e,t){i.updateRow()}),e.append(document.createTextNode("\u00a0")),this._createCommand(e,r.cancelCommand,n,function(e,t){i.cancelRowEditing()})):(r.showEditButton&&this._createCommand(e,r.editCommand,n,function(e,t){i.editRow(n.dataItemIndex)}),r.showDeleteButton&&(r.showEditButton&&e.append(document.createTextNode("\u00a0")),this._createCommand(e,r.deleteCommand,n,function(e,t){i.deleteRow(n.dataItemIndex)}))),e.addClass("wijmo-wijgrid-innercell-command")},n.WIDGET_NAME="wijmo.c1commandbuttonfield",n}(t.c1buttonbasefield);t.c1commandbuttonfield=r;var i=function(e){function t(){e.apply(this,arguments),this.showDeleteButton=!1,this.showEditButton=!1,this.cancelCommand={text:"Cancel",iconClass:"ui-icon-close",click:undefined,textDataKey:undefined},this.deleteCommand={text:"Delete",iconClass:"ui-icon-trash",click:undefined,textDataKey:undefined},this.editCommand={text:"Edit",iconClass:"ui-icon-pencil",click:undefined,textDataKey:undefined},this.updateCommand={text:"Update",iconClass:"ui-icon-disk",click:undefined,textDataKey:undefined}}return __extends(t,e),t}(t.c1buttonbasefield_options);t.c1commandbuttonfield_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1buttonbasefield.prototype.options,new i),e.grid.registerColumnFactory(function(e,t){return r.test(t)?new r(e,t):null})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){function i(t){var n=[];return e.grid.traverse(t,function(e){n.push(e)}),n}function s(t,n){if(!t||!n||t.options._parentIdx===-1)return null;var r=n[t.options._parentIdx];return r.options._parentIdx===-1?r:e.grid.getTompostParent(r,n)}function o(e,t,r){if(n.isArray(r.options.columns)&&t.options._parentIdx>=0){if(t.options._parentIdx===r.options._travIdx)return!0;if(t.options._parentIdx>r.options._travIdx)for(;;){t=e[t.options._parentIdx];if(t.options._travIdx===r.options._travIdx)return!0;if(t.options._parentIdx===-1)break}}return!1}function u(e){return a(e,0,-1)}function a(e,t,n){if(e)for(var r=0,i=e.length;r<i;r++){var s=e[r];s.options&&(s=s.options),s._linearIdx=r,s._travIdx=t++,s._parentIdx=n,s.columns&&(t=a(s.columns,t,t-1))}return t}function f(t,r){if(t&&n.isFunction(r))for(var i=0;i<t.length;i++){var s=t[i];s.options&&(s=s.options);var o=t.length;r(s,t);if(t.length!==o){i--;continue}s.columns&&e.grid.traverse(s.columns,r)}}var n=jQuery,r=function(){function t(){}return t.prototype.generateSpanTable=function(e){return this._height=this._width=this._inc=this._shift=0,this._table=[],this._traverseList=[],this._savedXPos=[],this._generateSpanTable(e,!0)},t.prototype._generateSpanTable=function(t,n){this._height=this.getVisibleHeight(t,n),this._traverseList=e.grid.flatten(t),this._width=this._traverseList.length;for(var r=0;r<this._height;r++){this._table[r]=[];for(var i=0;i<this._width;i++)this._table[r][i]={column:null,colSpan:0,rowSpan:0}}return this._setTableValues(t,0,0),this._table},t.prototype.getVisibleHeight=function(e,t){var r=0;if(n.isArray(e))for(var i=0,s=e.length;i<s;i++){var o=this.getVisibleHeight(e[i],t);r=Math.max(r,o)}else{var u=e,a=u.visible===undefined?!0:u.visible;u._parentVis=a&&t;if(n.isArray(u.columns)){for(var i=0,s=u.columns.length;i<s;i++)o=this.getVisibleHeight(u.columns[i],u._parentVis),r=Math.max(r,o);if(!u._parentVis)return r;u._isLeaf=r===0,r++}else u._isLeaf=!0,u._parentVis&&(r=1)}return r},t.prototype._getVisibleParent=function(e){while(e){e=this._traverseList[e._parentIdx];if(e&&(e._parentVis||e._parentVis===undefined))return e}return null},t.prototype._setTableValues=function(e,t,r){var i,s;if(n.isArray(e))for(var o=0,u=e.length;o<u;o++)this._setTableValues(e[o],t,r);else{var a=e;if(a._travIdx===undefined)throw"undefined travIdx";i=r+this._shift,a._parentVis&&(s=i+this._inc,this._table[t][s].column=a,this._savedXPos[a._travIdx]=s);if(n.isArray(a.columns))for(o=0,u=a.columns.length;o<u;o++)this._setTableValues(a.columns[o],t+1,r);if(a._parentVis)this._shift-i===0?(this._table[t][this._savedXPos[a._travIdx]].rowSpan=this._height-t,this._shift++):this._table[t][this._savedXPos[a._travIdx]].colSpan=this._shift-i;else if(!n.isArray(a.columns)&&this._height>0){var f=this._getVisibleParent(a),l=f?f._isLeaf:!1;l&&this._inc++,t>=this._height&&(t=this._height-1),s=r+this._shift+this._inc,this._table[t][s].column=a,l||(f&&this._savedXPos[f._travIdx]===s&&this._shiftTableElements(s,t),this._inc++)}}},t.prototype._shiftTableElements=function(e,t){for(var n=0;n<t;n++)this._table[n][e+1]=this._table[n][e],this._table[n][e]={column:null,colSpan:0,rowSpan:0},this._table[n][e+1].column&&this._savedXPos[this._table[n][e+1].column._travIdx]++},t}();t.bandProcessor=r,t.flatten=i,t.getTompostParent=s,t.isChildOf=o,t.setTraverseIndex=u,t.traverse=f})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function r(t){this._dvFilteringSettings=undefined,this._dvPagingSettings=undefined,this._dvSortingSettings=undefined,this._wgFilteringSettings=undefined,this._wgPagingSettings=undefined,this._wgSortingSettings=undefined;if(!t)throw"exception";this._wijgrid=t,this._dataView=t.mDataViewWrapper.dataView(),this._filterCache=new e.grid.filterOperatorsCache(t)}return r.prototype.compareSettings=function(){var t=!0,n,r=this.DVPagingSettings(),i=this.WGPagingSettings();t=r===i,!t&&r&&i&&(t=r.pageSize===i.pageSize&&r.pageIndex===i.pageIndex);if(t){var s=this.DVSortingSettings(),o=this.WGSortingSettings();t=s===o;if(!t&&s&&o&&(n=s.length)===o.length){t=!0;for(var u=0;u<n&&t;u++)t=s[u].dataKey===o[u].dataKey&&s[u].sortDirection===o[u].sortDirection}}if(t){var a=this.DVFilteringSettings(),f=this.WGFilteringSettings();t=e.grid.compareObj(a,f)}return t},r.prototype.DVFilteringSettings=function(){function e(t,r){var i;n.each(t,function(t,s){if(typeof s=="string")i=s;else if(n.isArray(s))e(s,r);else{var o=s,u=r;u.value.push(o.value),u.operator.push({name:o.customProps&&o.customProps.originalOperator||o.operator,condition:i})}})}if(this._dvFilteringSettings===undefined){var t=[],r=this._dataView.filter();r&&n.each(r,function(r,i){var s={operator:undefined,owner:null,dataKey:r};if(n.isArray(i))s.value=[],s.operator=[],e(i,s);else if(n.isPlainObject(i)){var o=i;s.value=o.value,s.operator=o.customProps&&o.customProps.originalOperator||i.operator||"Equals",s.customProps=o.customProps}else s.value=i,s.operator="Equals";t.push(s)}),this._dvFilteringSettings=t.length?t:null}return this._dvFilteringSettings},r.prototype.DVPagingSettings=function(){if(this._dvPagingSettings===undefined){var t=e.grid.asPagedDataView(this._dataView);if(t){var n=t.pageSize();this._dvPagingSettings=n>0?{pageSize:t.pageSize(),pageIndex:t.pageIndex()}:null}}return this._dvPagingSettings},r.prototype.DVSortingSettings=function(){if(this._dvSortingSettings===undefined){var t=[],r=e.data.sorting.compile(this._dataView.sort()).normalized;r&&n.each(r,function(e,n){n!==null&&t.push({dataKey:typeof n=="string"?n:n.property,sortDirection:n.asc||n.asc===undefined?"ascending":"descending",sortOrder:undefined,customProps:n.customProps})}),this._dvSortingSettings=t.length?t:null}return this._dvSortingSettings},r.prototype.WGFilteringSettings=function(){var r=this;if(this._wgFilteringSettings===undefined){var i=[],s=this._wijgrid,o=s._leaves()||[],u={};n.each(o,function(n,s){if(s instanceof t.c1field){var o=s.options,a=e.grid.deepExtend({},{foo:o.filterValue}).foo,f=e.grid.deepExtend({},{foo:o.filterOperator}).foo,l=e.grid.filterHelper.verify(f,a,o.dataType,r._filterCache);l&&i.push({owner:s,dataKey:o.dataKey,value:l.value,operator:l.operator,customProps:{travIdx:o._travIdx}}),u[(o.dataKey+"").toLowerCase()]=s}});if(!s._isRoot()){var a=s.options.relation,f=s._masterInfo(),l=f.master.details()[f.dataRowIndex].masterKey();for(var c=0;c<a.length;c++){var h=a[c],p=u[h.detailDataKey.toLowerCase()];i.push({owner:p,dataKey:h.detailDataKey,value:l[h.masterDataKey.toLowerCase()],operator:"Equals"})}}this._wgFilteringSettings=i.length?i:null}return this._wgFilteringSettings},r.prototype.WGPagingSettings=function(){return this._wgPagingSettings===undefined&&(this._wgPagingSettings=this._wijgrid.options.allowPaging?{pageSize:this._wijgrid.options.pageSize,pageIndex:this._wijgrid.options.pageIndex}:null),this._wgPagingSettings},r.prototype.WGSortingSettings=function(){if(this._wgSortingSettings===undefined){var e={},r=[],i=this._wijgrid._groupedLeaves(!0),s=this._wijgrid._leaves(),o=0;n.each(i,function(t,n){if(n._isSortable()){var r=n.options;r.sortDirection==="none"&&(r.sortDirection="ascending"),e[r.dataKey]={dataKey:r.dataKey,sortDirection:r.sortDirection,sortOrder:o++,customProps:{travIdx:r._travIdx}}}}),o++,n.each(s,function(n,r){if(r instanceof t.c1field&&r._isSortable()){var i=r.options;if(i.sortDirection==="ascending"||i.sortDirection==="descending")e[i.dataKey]||(e[i.dataKey]={dataKey:i.dataKey,sortDirection:i.sortDirection,sortOrder:(i._sortOrder||0)+o,customProps:{travIdx:i._travIdx}})}}),n.each(e,function(e,t){r.push(t)}),r.sort(function(e,t){return e.sortOrder-t.sortOrder}),n.each(r,function(e,t){delete t.sortOrder}),this._wgSortingSettings=r.length?r:null}return this._wgSortingSettings},r.prototype.MapWGToDV=function(){var e=this,r={},i,s;this._mapPagingParams()&&(i=this.WGPagingSettings())?(r.pageIndex=i.pageIndex,r.pageSize=i.pageSize):r.pageSize=-1;if(this._mapSortingParams()){r.sort=[];if(i=this.WGSortingSettings())r.sort=[],n.each(i,function(e,t){r.sort.push({property:t.dataKey,asc:t.sortDirection==="ascending",customProps:t.customProps})})}this._wijgrid.mDeficientFilters={};if(this._mapFilteringParams()){n.each(this._wijgrid._leaves(),function(n,r){if(r instanceof t.c1field){var i=r.options;i.filterOperator===undefined^i.filterValue===undefined&&(e._wijgrid.mDeficientFilters[i.dataKey]={operator:i.filterOperator,value:i.filterValue})}}),r.filter={};if(i=this.WGFilteringSettings())r.filter=this._convertFilterToDV(i);n.isEmptyObject(r.filter)&&(r.filter=null)}return r},r.prototype.MapDVToWG=function(){var r,i={},s={},o=this._mapSortingParams(),u=this._mapPagingParams(),a=this._mapFilteringParams(),f=e.grid.asPagedDataView(this._dataView),l=this;n.each(this._wijgrid._leaves(),function(e,n){if(n instanceof t.c1field){var r=n.options;o&&(r._sortOrder=0,r.sortDirection="none"),a&&(r.filterOperator="nofilter",r.filterValue=undefined),i[r.dataKey]=n,r._travIdx>=0&&(s[r._travIdx]=n)}}),u&&f&&(this._wijgrid.options.pageSize=f.pageSize(),this._wijgrid.options.pageIndex=f.pageIndex()),o&&(r=this.DVSortingSettings())&&n.each(r,function(e,t){var n;t.customProps&&t.customProps.travIdx>=0&&(n=s[t.customProps.travIdx]);if(!n||n.options.dataKey!==t.dataKey)n=i[t.dataKey];n&&(n.options.sortDirection=t.sortDirection,n.options._sortOrder=e)}),a&&((r=this.DVFilteringSettings())&&n.each(r,function(e,t){var r;t.customProps&&t.customProps.travIdx>=0&&(r=s[t.customProps.travIdx]);if(!r||r.options.dataKey!==t.dataKey)r=i[t.dataKey];if(r&&!r._isDetailRelationField()){var o=r.options;o.filterValue=t.value,o.filterOperator=t.operator,n.isPlainObject(o.filterOperator)&&(o.filterOperator=o.filterOperator.name),delete l._wijgrid.mDeficientFilters[o.dataKey]}}),n.each(this._wijgrid.mDeficientFilters,function(e,t){var n=i[e];if(n){var r=i[e].options;r.filterOperator=t.operator,r.filterValue=t.value}}))},r.prototype._mapPagingParams=function(){return this._wijgrid.options.allowPaging&&!this._wijgrid._customPagingEnabled()&&!this._wijgrid._serverShaping()},r.prototype._mapSortingParams=function(){return!this._wijgrid._serverShaping()},r.prototype._mapFilteringParams=function(){return!this._wijgrid._serverShaping()},r.prototype._getDateValueRequirements=function(e){var n=e.options;return n.inputType?t.TimeUnitConverter.convertInputType(n.inputType):t.TimeUnitConverter.convertFormatString(n.dataFormatString||"d")},r.prototype.makeProxyFilter=function(r,i,s,o){s=s.toLowerCase();var u=this,a=r.options,f=a.dataType==="datetime",l={property:i,operator:s,value:o,customProps:{travIdx:a._travIdx}},c=this._filterCache.getByNameInt(s),h=e.data.filtering.ops[s];if(s!=="nofilter"&&(c.isCustom||f)){l.customProps.originalOperator=l.operator;if(c.isCustom)l.operator=n.extend(!0,{},c.op),l.operator.apply=l.operator.operator;else{l.operator=n.extend(!0,{},h);var p=this._getDateValueRequirements(r);l.operator.apply=function(e,n){return e instanceof Date||(e=u._wijgrid.parse(a,e)),n instanceof Date||(n=u._wijgrid.parse(a,n)),t.TimeUnitConverter.cutDate(e,p),t.TimeUnitConverter.cutDate(n,p),h.apply(e,n)}}}return l},r.prototype._convertFilterToDV=function(e){var r={},i=this;return n.each(e,function(e,s){var o=s.dataKey,u=[],a="and",f,l,c,h;if(!n.isPlainObject(s))return;l=s.operator,c=s.value;if(l==null)return;n.isArray(l)||(l=[l]),n.isArray(c)||(c=[c]);if(l.length!=c.length)throw"The number of filter operators must match the number of filter values";if(l.length==0)return;n.each(l,function(e,r){function p(){h.length>1?h.splice(0,0,"or"):h=h[0]}function d(){a==null&&(a=f,u.splice(0,0,f))}var l;typeof r=="string"&&(r={name:r});if(!n.isPlainObject(r)||!r.name)throw"Invalid filter operator";l=c[e],n.isArray(l)||(l=[l]),h=n.map(l,function(e){return s.owner?(s.owner.options.dataType==="datetime"&&e instanceof Date&&t.TimeUnitConverter.cutDate(e,i._getDateValueRequirements(s.owner)),i.makeProxyFilter(s.owner,o,r.name,e)):{property:o,operator:r.name,value:e}}),a=null,f=r.condition||"or",u.length<=1||a==f?h.length==1||u.length<=1||a=="or"?(u=u.concat(h),d()):(p(),u.push(h),d()):(p(),u=[u,h],d())}),n.each(u,function(e,t){n.isArray(t)&&t.length==2&&(u[e]=t[1])}),u.length==2&&typeof (u[0]==="string")&&u.shift(),u.length==1&&(u=u[0]),r[o]=u}),r},r}();t.settingsManager=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){function i(e){return e&&"pageCount"in e?e:null}function s(e){return e&&"commitEdit"in e?e:null}var n=jQuery,r=function(){function r(e){this._domSource=null,this._ignoreAllEvents=!1,this._ignoreChangeEvent=!1,this._ignoreCurrentChangedEvent=!1,this._userData=null,this._totals=null,this._changeTimer=0,this._toDispose=[],this._isOwnDataView=!1,this._isWijdatasource=!1,this._isKODataView=!1,this._isDynamicWijdatasource=!1,this._wijgrid=e,this._createDataViewWrapper()}return r.getMetadata=function(t){var n;return t&&(n=e.data.Expando.getFrom(t,!1))&&(n=n[e.grid.EXPANDO])?n||null:null},r.testMetaForClass=function(e,t){if(e){var n=e.rowAttributes;return!!(n&&n["class"]&&n["class"].indexOf(t)>=0)}return!1},r.isHierarchyDetailItem=function(n,r){var i=e.grid.dataViewWrapper.getMetadata(n),s=!1;return i&&(s=e.grid.dataViewWrapper.testMetaForClass(i,t.wijgrid.CSS.detailRow)),r&&(r.value=i),s},r.prototype.data=function(){var t=this._getDataViewInst(),n=e.grid.asPagedDataView(t);return{totalRows:n!=null?n.totalItemCount():(t.getSource()||[]).length,totals:this._getTotals(),emptyData:this.isBoundedToDOM()?this._domSource.emptyData:null}},r.prototype.dataView=function(){return this._getDataViewInst()},r.prototype.dispose=function(){var e=this._getDataViewInst();n.each(this._toDispose,function(e,t){t.dispose()}),e&&this._isOwnDataView&&e.dispose(),this._wijgrid.mWijDataView=null},r.prototype.ignoreChangeEvent=function(e){if(!arguments.length)return this._ignoreChangeEvent;this._ignoreChangeEvent=e===!0},r.prototype.ignoreCurrentChangedEvent=function(e){if(!arguments.length)return this._ignoreCurrentChangedEvent;this._ignoreCurrentChangedEvent=e===!0},r.prototype.isDataLoaded=function(){var e=this._getDataViewInst();return e.isLoaded()},r.prototype.isOwnDataView=function(){return this._isOwnDataView},r.prototype.getFieldsInfo=function(){var e=this._getDataViewInst();return this._propDescriptorsToFieldsInfo(e.getProperties())},r.prototype._propDescriptorsToFieldsInfo=function(e){var t={};return e&&n.each(e,function(e,n){if(n.name==="$$hash"||n.name==="$$hashKey")return;t[n.name]={name:n.name,type:n.type||"string"}}),t},r.prototype.isBoundedToDOM=function(){return this._domSource!==null},r.prototype.isKODataView=function(){return this._isKODataView},r.prototype.load=function(t){this._userData=t;var n=this._getDataViewInst();n||(this._createDataViewWrapper(),n=this._getDataViewInst()),this._onDataViewLoading();var r=new e.grid.settingsManager(this._wijgrid);if(t&&t.forceDataLoad||this._needToLoad(r)){var i=r.MapWGToDV(),s=!1;this._isWijdatasource&&!this._isDynamicWijdatasource&&n.isLoaded()&&(s=!0);var o=e.grid.asPagedDataView(n),u=-1;if(o&&i.pageSize>=0&&(u=o.totalItemCount())>=0){if(this._isOwnDataView&&!this._isKODataView&&!this._isDynamicWijdatasource&&o.pageSize()>0){var a=o.getSource();a&&a.length<u&&(u=a.length)}var f=Math.ceil(u/i.pageSize)||1,l=i.pageIndex;l>=f&&(l=Math.max(0,f-1)),i.pageIndex=l}this.ignoreCurrentChangedEvent(!0),n.refresh(i,s)}else this.isDataLoaded()&&(this._onDataViewLoaded(),this._onDataViewReset())},r.prototype.currentPosition=function(e){var t=this._getDataViewInst();if(!arguments.length)return t.currentPosition();this.ignoreCurrentChangedEvent(!0);try{t.currentPosition(e)}finally{this.ignoreCurrentChangedEvent(!1)}},r.prototype.getValue=function(e,t){var n=this._getDataViewInst();return typeof t=="number"&&(t+=""),n.getProperty(e,t)},r.prototype.setValue=function(e,t,n){var r=this._getDataViewInst();this.ignoreChangeEvent(!0);try{typeof t=="number"&&(t+=""),r.setProperty(e,t,n)}finally{this.ignoreChangeEvent(!1)}},r.prototype.makeDirty=function(){this._totals=null},r.prototype._createDataViewWrapper=function(){var t,r=this._wijgrid.options.data,i=this._getDataViewInst(),s=!1;if(i)return;r||(this._domSource=this._processDOM(this._wijgrid.element,this._wijgrid.options.readAttributesFromData),r=this._domSource.items),s=typeof wijdatasource!="undefined"&&r instanceof wijdatasource,this._isKODataView=r instanceof e.grid.koDataView,this._isOwnDataView=n.isArray(r)||s||this._isKODataView,this._isWijdatasource=!!this._isOwnDataView&&!!s,this._isDynamicWijdatasource=!!(this._isOwnDataView&&s&&r.dynamic);if(this._isOwnDataView&&!this._isKODataView){!this._domSource&&this._wijgrid.options.readAttributesFromData&&this._moveAttributesToExpando(r);var o=this.isBoundedToDOM()&&e.grid.getTableSection(this._wijgrid.element,2);i=e.grid.GridLocalDataDataView.create(e.data.asDataView(this._parseOwnData(r,null,o)))}else i=r;this._wijgrid.mWijDataView=i,this._toDispose.push(i.isLoading.subscribe(n.proxy(this._onDataViewLoadingInternal,this))),this._toDispose.push(i.isLoaded.subscribe(n.proxy(this._onDataViewLoadedInternal,this))),this._toDispose.push(i.subscribe(n.proxy(this._onDataViewChangeInternal,this))),this._toDispose.push(i.currentPosition.subscribe(n.proxy(this._onDataViewCurrentChangedInternal,this)))},r.prototype._parseOwnData=function(t,r,i){if(t&&t.length){var s=this._wijgrid,o=[];if(!r){r=n.extend(!0,[],this._wijgrid.options.columns);var u=e.data.ArrayDataViewBase._getProps(t[0])||[],a=this._propDescriptorsToFieldsInfo(u);s._prepareColumns(r,"merge",a,!0,!0,!1)}e.grid.traverse(r,function(e){s._needParseColumnDOM(e)&&o.push(e)});if(o.length&&i){var f=s._getDOMReaderCulture();n.each(t,function(t,n){e.grid.dataViewWrapper.isHierarchyDetailItem(n)||e.grid.dataViewWrapper._parseDataItem(s,n,i&&i.rows[t],o,f)})}}return t},r._parseDataItem=function(t,r,i,s,o){return n.each(s,function(n,s){var u=r[s.dataKey],a=t.parseCtx(s,u,r,i.cells[s.dataKey],o);if(e.grid.isNaN(a)){var f=null;i&&(f=i.cells[s.dataKey]),a=t.parseCtxFailed(s,u,r,f,o)}r[s.dataKey]=a}),r},r.prototype._getDataViewInst=function(){return this._wijgrid.mWijDataView},r.prototype._needToLoad=function(e){var t=this._getDataViewInst();return this._isDynamicWijdatasource||this._isWijdatasource&&!t.isLoaded()?!0:this._isOwnDataView&&!this._isWijdatasource&&this.isDataLoaded()?!0:this.isDataLoaded()||t.isLoading()?!e.compareSettings():!0},r.prototype._validateSettings=function(e){if(!this._isOwnDataView&&this._wijgrid.options.allowPaging&&(e.DVPagingSettings()||{}).pageSize!==(e.WGPagingSettings()||{}).pageSize)throw"The pageSize option of the external dataView can't be changed."},r.prototype._onDataViewLoadingInternal=function(e){if(this._ignoreAllEvents)return;e&&(this._userData||this._onDataViewLoading())},r.prototype._onDataViewLoadedInternal=function(e){if(this._ignoreAllEvents)return;e&&this._onDataViewLoaded()},r.prototype._onDataViewChangeInternal=function(e){var t=this;if(this._ignoreAllEvents||this._ignoreChangeEvent)return;if(e.changes){if(e.length&&e[0].entityState()==="detached")return;n.each(e.changes,function(e,t){switch(t.changeType){case"remove":break;case"add":}})}this._onDataViewChange.apply(this,arguments)},r.prototype._onDataViewCurrentChangedInternal=function(){if(this._ignoreAllEvents||this._ignoreCurrentChangedEvent)return;this._onDataViewCurrentChanged.apply(this,arguments)},r.prototype._onDataViewReset=function(){try{this.ignoreCurrentChangedEvent(!1),this.makeDirty(),this._wijgrid._onDataViewReset(this._userData,this._isKODataView)}finally{this._userData=null}},r.prototype._onPropertyChanged=function(e){var t=this;this._changeTimer>0&&(window.clearTimeout(this._changeTimer),this._changeTimer=0),this._changeTimer!=-1&&(this._changeTimer=window.setTimeout(function(){t._changeTimer=-1,t._wijgrid.mDestroyed||t._onDataViewChange(),t._changeTimer=0},100))},r.prototype._onDataViewChange=function(e){this._onDataViewReset()},r.prototype._onDataViewCurrentChanged=function(e,t){this._wijgrid._onDataViewCurrentPositionChanged(e,t)},r.prototype._onDataViewLoading=function(){this._wijgrid._onDataViewLoading()},r.prototype._onDataViewLoaded=function(){this._wijgrid._onDataViewLoaded()},r.prototype._getTotals=function(){if(!this._totals){var e=this._getDataViewInst();this._totals=this._prepareTotals(e,this._wijgrid._prepareTotalsRequest())}return this._totals||(this._totals={}),this._totals},r.prototype._prepareTotals=function(t,n){if(!n||n.length===0)return{};var r=[],i={};for(var s=0,o=n.length;s<o;s++)r.push(new e.grid.tally(this._wijgrid));for(var s=0,o=t.count();s<o;s++)for(var u=0,a=r.length;u<a;u++){var f=n[u].options;r[u].add(this._wijgrid.parse(f,this.getValue(s,f.dataKey)))}for(var s=0,o=r.length;s<o;s++){var f=n[s].options;i[f.dataKey]=r[s].getValue(n[s])}return i},r.prototype._processDOM=function(t,r){var i={items:[],emptyData:[]};return e.grid.getTableSectionLength(t,2)===1&&n(e.grid.getTableSectionRow(t,2,0)).hasClass(e.grid.wijgrid.CSS.emptyDataRow)?i.emptyData=this._wijgrid._readTableSection(t,2):i.items=this._wijgrid._readTableSection(t,2,r),i},r.prototype._moveAttributesToExpando=function(t){n.each(t,function(t,r){var i=e.data.Expando.getFrom(r,!0),s;s=i[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:{}},r.rowAttributes&&(s.rowAttributes=r.rowAttributes,delete r.rowAttributes),n.each(r,function(e,t){n.isArray(t)&&(s.cellsAttributes[e]=t[1],r[e]=t[0])})})},r.prototype._wrapDataItem=function(e,t){return{values:e,originalRowIndex:t}},r.prototype._refreshSilent=function(){var e=this._getDataViewInst();if(e)try{this._ignoreAllEvents=!0,e.refresh()}finally{this._ignoreAllEvents=!1}},r.prototype._unsafeReplace=function(t,n){var r=this._getDataViewInst();r instanceof e.grid.GridLocalDataDataView||"operation is not supported",r._unsafeReplace(t,n)},r.prototype._unsafeSplice=function(t,n,r){var i=this._getDataViewInst();i instanceof e.grid.GridLocalDataDataView||"operation is not supported",arguments.length===2?i._unsafeSplice(t,n):i._unsafeSplice(t,n,r)},r.prototype._unsafePush=function(t){var n=this._getDataViewInst();n instanceof e.grid.GridLocalDataDataView||"operation is not supported",n._unsafePush(t)},r}();t.dataViewWrapper=r,t.asPagedDataView=i,t.asEditableDataView=s;var o=function(){function e(e){this._subscriptions=[],this._callback=e}return e.prototype.insert=function(e,t){var r=null,i=this;return n.each(t,function(e,t){i._isValidPropName(e)&&t&&n.isFunction(t.subscribe)&&(r=r||[],r.push(t.subscribe(i._callback)))}),r?(this._subscriptions.length<e&&(this._subscriptions.length=e),this._subscriptions.splice(e,0,r),!0):!1},e.prototype.remove=function(e){var t=this._subscriptions[e];t&&n.each(t,function(e,n){n.dispose(),t[e]=null}),this._subscriptions[e]=null,this._subscriptions.splice(e,1)},e.prototype.removeAll=function(){var e,t;while(e=this._subscriptions.length)this.remove(e-1);this._subscriptions=[]},e.prototype.dispose=function(){this.removeAll()},e.prototype._isValidPropName=function(e){return e&&typeof e=="string"?e.match(/^entityState|jQuery/)===null:!0},e}();t.propChangeListener=o})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(t,n,r,i,s){this.cr=new e.grid.cellRange(-1,-1),this.isExpanded=!1,this.position="none",this._sum=-1,this._hasHeaderOrFooter=!0,t!==undefined&&(this.isExpanded=t),n!==undefined&&(this.cr=n),r!==undefined&&(this._sum=r),i!==undefined&&(this.position=i),s!==undefined&&(this._hasHeaderOrFooter=s)}return t.prototype.isSubRange=function(e){return this.cr.r1>=e.cr.r1&&this.cr.r2<=e.cr.r2},t.prototype.toString=function(){return this.cr.r1+"-"+this.cr.r2},t.prototype.collapse=function(t,n){var r=n.options.groupInfo,i=t._leaves();if(e.grid.groupHelper.isParentExpanded(i,this.cr,r.level)&&r.position!=="footer"&&r.outlineMode!=="none"){var s=e.grid.groupHelper.getGroupedColumnsCount(i);this._collapse(t,n,t._rows(),i,this,s,t._allowVVirtualScrolling())}},t.prototype.expand=function(t,n,r){var i=n.options.groupInfo,s=t._leaves();if(e.grid.groupHelper.isParentExpanded(s,this.cr,i.level)){var o=e.grid.groupHelper.getGroupedColumnsCount(s);this._expand(t,n,t._rows(),s,this,o,r,!0,t._allowVVirtualScrolling())}},t.prototype._collapse=function(t,n,r,i,s,o,u){var a=n.options.groupInfo,f=s.cr.r1,l=s.cr.r2;switch(a.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(t.mSketchTable.row(s.cr.r1),undefined,!1),u||this._toggleRowVisibility(t,r.item(s.cr.r1),undefined,!1),f++}for(var c=f;c<=l;c++)this._toggleSketchRowVisibility(t.mSketchTable.row(c),!1,undefined),u||this._toggleRowVisibility(t,r.item(c),!1,undefined);s.isExpanded=!1;for(var c=a.level+1;c<=o;c++){var h=e.grid.groupHelper.getChildGroupRanges(i,s.cr,c-1);if(h){var p=h.ranges;for(var d=0,v=p.length;d<v;d++){var m=p[d];m.isExpanded=!1;switch(h.column.options.groupInfo.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(t.mSketchTable.row(m.cr.r1),!1,!1),u||this._toggleRowVisibility(t,r.item(m.cr.r1),!1,!1)}}}}},t.prototype._expand=function(t,n,r,i,s,o,u,a,f){var l=n.options.groupInfo,c=s.cr.r1,h=s.cr.r2;switch(l.position){case"header":this._toggleSketchRowVisibility(t.mSketchTable.row(c),!0,a||u),f||this._toggleRowVisibility(t,r.item(c),!0,a||u),c++;break;case"footer":this._toggleSketchRowVisibility(t.mSketchTable.row(h),!0,undefined),f||this._toggleRowVisibility(t,r.item(h),!0,undefined),h--;break;case"headerAndFooter":this._toggleSketchRowVisibility(t.mSketchTable.row(c),!0,a||u),f||this._toggleRowVisibility(t,r.item(c),!0,a||u),a&&(this._toggleSketchRowVisibility(t.mSketchTable.row(h),!0,undefined),f||this._toggleRowVisibility(t,r.item(h),!0,undefined)),c++,h--}if(!a)return;s.isExpanded=!0;if(l.level===o)for(var p=c;p<=h;p++)this._toggleSketchRowVisibility(t.mSketchTable.row(p),!0,undefined),f||this._toggleRowVisibility(t,r.item(p),!0,undefined);else{var d=e.grid.groupHelper.getChildGroupRanges(i,s.cr,l.level);if(d){var v=d.ranges,m=d.column;if(v.length&&c!==v[0].cr.r1)for(p=c;p<v[0].cr.r1;p++)this._toggleSketchRowVisibility(t.mSketchTable.row(p),!0,undefined),f||this._toggleRowVisibility(t,r.item(p),!0,undefined);if(u)for(var p=0,g=v.length;p<g;p++){var y=v[p];this._expand(t,m,r,i,y,o,u,!0,f)}else for(var p=0,g=v.length;p<g;p++){var y=v[p],b=m.options.groupInfo.position==="footer"||m.options.groupInfo.outlineMode==="none";this._expand(t,m,r,i,y,o,!1,b,f)}}}},t.prototype._toggleRowVisibility=function(t,n,r,i){if(n){var s=e.grid.renderStateEx,o=t._view(),u=o._getRowInfo(n,!1);r!==undefined&&(r?u._extInfo.state&=-2:u._extInfo.state|=1),i!==undefined&&(i?u._extInfo.state&=-3:u._extInfo.state|=2),o._setRowInfo(u.$rows,u),t.mRowStyleFormatter._groupFormatter(u)}},t.prototype._toggleSketchRowVisibility=function(t,n,r){if(t){var i=e.grid.renderStateEx;n!==undefined&&(n?t.extInfo.state&=-2:t.extInfo.state|=1),r!==undefined&&(r?t.extInfo.state&=-3:t.extInfo.state|=2)}},t}();t.groupRange=r;var i=function(){function r(){this.mGroupRowIdx=0,this.mFirstVisbileLeafIndex=0}return r.prototype.group=function(e,t){var r=this;this.mGrid=e,this.mLeaves=e._leaves(),this.mSketchTable=t,this.mGroupRowIdx=0;var i=!1;n.each(this.mLeaves,function(e,t){var n=t.options;n.groupInfo&&(delete n.groupInfo.level,delete n.groupInfo.expandInfo),!i&&(i=t._isFirstVisible())&&(r.mFirstVisbileLeafIndex=e)}),this._group()},r.prototype._group=function(){var e=this,r=this.mGrid._groupedLeaves(!0),i=1;if(r.length==0)return;this.mSketchTable.ensureNotLazy(),n.each(r,function(n,r){e.mGroupRowIdx=0;if(t.c1field.isGroupedColumn(r)){var s=r.options;s.groupInfo.level=i,s.groupInfo.expandInfo=[],e._processRowGroup(r,i++)}})},r.prototype._processRowGroup=function(t,n){var r=!0,i=e.grid.renderStateEx;for(var s=0;s<this.mSketchTable.count();s++){var o=this.mSketchTable.row(s);if(!o.isPureDataRow())continue;var u=this._getGroupCellRange(s,t,n),a=!0,f=t.options.groupInfo.outlineMode==="startCollapsed",l,c,h,p;if(f||e.grid.groupHelper.isParentCollapsed(this.mLeaves,u,n)){if(t.options.groupInfo.groupSingleRow===!1&&u.r1===u.r2)continue;a=!1}if(n&&this.mGrid.options.groupIndent)for(var d=u.r1;d<=u.r2;d++)this._addIndent(this.mSketchTable.row(d).cell(this.mFirstVisbileLeafIndex),n);r=t.options.groupInfo.groupSingleRow!==!1||u.r1!==u.r2;switch(t.options.groupInfo.position){case"header":h=this._addGroupRange(t.options.groupInfo,u,a,r);for(var v=u.r1;v<=u.r2;v++)o=this.mSketchTable.row(v),o.extInfo.groupLevel=n+1,a||(o.extInfo.state|=1);if(!r)break;this._updateByGroupRange(h,n),p=e.grid.groupHelper.isParentCollapsed(this.mLeaves,h.cr,n),l=this._buildGroupRow(t,h,u,!0,p),this.mSketchTable.insert(u.r1,l),l.extInfo.groupLevel=n,a||(l.extInfo.state|=2),p&&(l.extInfo.state|=1),s=u.r2+1;break;case"footer":h=this._addGroupRange(t.options.groupInfo,u,!0,r);if(!r)break;this._updateByGroupRange(h,n),c=this._buildGroupRow(t,h,u,!1,!1),c.extInfo.groupLevel=n,this.mSketchTable.insert(u.r2+1,c),s=u.r2+1,p=e.grid.groupHelper.isParentCollapsed(this.mLeaves,h.cr,n),p&&(c.extInfo.state|=1);break;case"headerAndFooter":h=this._addGroupRange(t.options.groupInfo,u,a,r);for(v=u.r1;v<=u.r2;v++)o=this.mSketchTable.row(v),o.extInfo.groupLevel=n+1,a||(o.extInfo.state|=1);if(!r)break;this._updateByGroupRange(h,n),p=e.grid.groupHelper.isParentCollapsed(this.mLeaves,h.cr,n),l=this._buildGroupRow(t,h,u,!0,p),c=this._buildGroupRow(t,h,u,!1,!1),this.mSketchTable.insert(u.r2+1,c),c.extInfo.groupLevel=n;if(p||!a)c.extInfo.state|=1;this.mSketchTable.insert(u.r1,l),l.extInfo.groupLevel=n,a||(l.extInfo.state|=2),p&&(l.extInfo.state|=1),s=u.r2+2;break;default:throw e.grid.stringFormat('Unknown Position value: "{0}"',t.options.groupInfo.position)}this.mGroupRowIdx++}},r.prototype._buildGroupRow=function(n,r,i,s,o){var u=n.options,a=u.groupInfo,f=new t.SketchGroupRow(s,null),l=undefined,c="",h="",p=e.grid.wijgrid.CSS;f.extInfo.groupIndex=this.mGroupRowIdx;if((l=this.mSketchTable.valueAt(i.r1,u._leavesIdx))!==null){if(this.mGrid.options.readAttributesFromData){var d=this.mSketchTable.wijgridDataAttrValueAt(i.r1,u._leavesIdx);d&&(l=this.mGrid.parse(u,d))}c=this.mGrid.toStr(u,l)}f.groupByValue=l,this.mGrid._showRowHeader()&&f.add(t.HtmlCell.nbsp());var v=new t.HtmlCell("",null);f.add(v),u.aggregate&&u.aggregate!=="none"&&(h=this._getAggregate(i,n,n,s,c));var m=s?a.headerText:a.footerText;if(m==="custom"){var g={data:this.mSketchTable.getRawTable(),column:u,groupByColumn:u,groupText:c,text:"",groupingStart:i.r1,groupingEnd:i.r2,isGroupHeader:s,aggregate:h};this.mGrid._trigger("groupText",null,g)&&(m=g.text)}else{if(m===undefined||m===null){s&&(m="{1}: {0}");if(h||h===0)m=m?m+" {2}":"{2}"}m=e.grid.stringFormat(m,u.encodeHtml?e.htmlEncode(c):c,u.headerText?u.headerText:"",this._wrapAggregateValue(h))}m||(m="&nbsp;"),v.html+="<span>"+m+"</span>",this._addIndent(v,a.level-1);var y=1,b=this.mGrid._virtualLeaves().length,w=!0;for(;b<this.mLeaves.length;b++){var E=this.mLeaves[b].options;if(E._parentVis){if(w){w=!1;continue}if(E._dynamic!==!0&&E.aggregate&&E.aggregate!=="none")break;y++}}for(;b<this.mLeaves.length;b++){var S=this.mLeaves[b];if(S.options._parentVis){var x="";S instanceof t.c1field&&(x=this._getAggregate(i,S,n,s,c)),x=x||"&nbsp;",f.add(new t.HtmlCell(this._wrapAggregateValue(x),{groupInfo:{leafIndex:S.options._leavesIdx,purpose:1}}))}}return v.ensureAttr().colSpan=y,v.ensureAttr().groupInfo={leafIndex:u._leavesIdx,purpose:0},f},r.prototype._getAggregate=function(t,n,r,i,s){var o="";if(!n.options.aggregate||n.options.aggregate==="none")return o;if(n.options.aggregate==="custom"){var u={data:this.mSketchTable.getRawTable(),column:n.options,groupByColumn:r.options,groupText:s,text:"",groupingStart:t.r1,groupingEnd:t.r2,isGroupHeader:i},a=n.options.dataIndex;try{n.options.dataIndex=n.options._leavesIdx,this.mGrid._trigger("groupAggregate",null,u)&&(o=u.text)}finally{n.options.dataIndex=a}}else{var f=new e.grid.tally(this.mGrid);for(var l=t.r1;l<=t.r2;l++)f.add(this.mSketchTable.valueAt(l,n.options._leavesIdx));o=e.grid.tally.getValueString(f.getValue(n),n,this.mGrid)}return o},r.prototype._getGroupCellRange=function(t,n,r){var i=n.options._leavesIdx,s,o=new e.grid.cellRange(t,i),u=e.grid.groupHelper.getParentGroupRange(this.mLeaves,o,r),a,f,l;s=this.mSketchTable.row(t);if(s.isPureDataRow()){a=s.valueCell(n.options._leavesIdx).value,a instanceof Date&&(a=a.getTime());for(o.r2=t,l=this.mSketchTable.count()-1;o.r2<l;o.r2++){if(!this.mSketchTable.row(o.r2+1).isPureDataRow()||u&&o.r2+1>u.cr.r2)break;f=this.mSketchTable.valueAt(o.r2+1,n.options._leavesIdx),f instanceof Date&&(f=f.getTime());if(a!==f)break}}return o},r.prototype._addGroupRange=function(t,n,r,i){var s=null,o=e.grid.groupHelper.getChildGroupIndex(n,t.expandInfo),u,a,f,l;return o>=0&&o<t.expandInfo.length?s=t.expandInfo[o]:(u=new e.grid.cellRange(n.r1,n.r1,n.r2,n.r2),a=t.position==="footer"||!i?!0:r&&t.outlineMode!=="startCollapsed",s=new e.grid.groupRange(a,u,-1,t.position,i),t.expandInfo.push(s)),s&&i&&(f=n.r1,l=n.r2,t.position==="headerAndFooter"&&(l+=2),t.position!=="headerAndFooter"&&l++,s.cr.r2=l),s},r.prototype._updateByGroupRange=function(e,t){for(var n=0,r=this.mLeaves.length;n<r;n++){var i=this.mLeaves[n].options.groupInfo;if(i&&i.level<t){var s=i.expandInfo?i.expandInfo.length:0;for(var o=0;o<s;o++){var u=i.expandInfo[o],a=e.position==="headerAndFooter"?2:1;u.cr.r1>=e.cr.r1&&(u.cr.r1!==e.cr.r1||u.position!=="footer")&&(u.cr.r1+=a),u.cr.r2>=e.cr.r1&&(u.cr.r2+=a)}}}},r.prototype._addIndent=function(e,t){var n;t>0&&(n=this.mGrid.options.groupIndent)&&(e.ensureStyle().paddingLeft=n*t+"px")},r.prototype._wrapAggregateValue=function(t){return"<span class='"+e.grid.wijgrid.CSS.aggregateContainer+"'>"+t.toString()+"</span>"},r}();t.grouper=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(){}return t.getGroupInfo=function(t){if(t){var n=e.grid.groupHelper._getGroupInfoRegExp.exec(t.id),r,i,s;if(n)return r=parseInt(n[3],10),i=parseInt(n[2],10),s=n[1]==="H",{level:r,index:i,isHeader:s,toString:function(){return(s?"GH":"GF")+i+"-"+r}}}return null},t.getColumnByGroupLevel=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n],s=e[n].options;if(s.groupInfo&&s.groupInfo.level===t)return i}return null},t.getGroupedColumnsCount=function(e){var t=0;for(var n=0,r=e.length;n<r;n++){var i=e[n].options.groupInfo;i&&(i.position==="header"||i.position==="headerAndFooter"||i.position==="footer")&&t++}return t},t.getChildGroupIndex=function(e,t){var n=0,r=t.length-1,i,s;while(n<=r){i=(r-n>>1)+n,s=t[i].cr.r1-e.r1;if(s===0)return i;s<0?n=i+1:r=i-1}return n},t.getParentGroupIndex=function(t,n){var r=e.grid.groupHelper.getChildGroupIndex(t,n);r>0&&r--;if(r<n.length){var i=n[r];if(t.r1>=i.cr.r1&&t.r2<=i.cr.r2)return r}return-1},t.getChildGroupRanges=function(t,n,r){var i=[],s=e.grid.groupHelper.getColumnByGroupLevel(t,r+1);if(s){var o=s.options.groupInfo.expandInfo,u=e.grid.groupHelper.getChildGroupIndex(n,o);for(var a=u,f=o.length;a<f;a++){var l=o[a];if(!(l.cr.r2<=n.r2))break;i.push(l)}return{column:s,ranges:i}}return null},t.getParentGroupRange=function(t,n,r){r===undefined&&(r=65535);if(n&&r-2>=0)for(var i=t.length-1;i>=0;i--){var s=t[i].options.groupInfo;if(!s||!s.expandInfo||s.level<0||s.level!==r-1)continue;var o=e.grid.groupHelper.getParentGroupIndex(n,s.expandInfo);if(o>=0)return s.expandInfo[o]}return null},t.isParentCollapsed=function(t,n,r){if(r===1)return!1;for(var i=r;i>1;i--){var s=e.grid.groupHelper.getParentGroupRange(t,n,i);if(!s)return!1;if(!s.isExpanded)return!0;n=s.cr}return!1},t.isParentExpanded=function(t,n,r){if(r===1)return!0;for(var i=r;i>1;i--){var s=e.grid.groupHelper.getParentGroupRange(t,n,i);if(!s||s&&s.isExpanded)return!0;n=s.cr}return!1},t._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"),t}();t.groupHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function e(e,t,n,r){switch(arguments.length){case 2:this.r1=this.r2=e,this.c1=this.c2=t;break;case 4:this.r1=e,this.r2=n,this.c1=t,this.c2=r;break;default:this.r1=0,this.r2=0,this.c1=0,this.c2=0}}return e.prototype.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2},e}();t.cellRange=r;var i=function(){function n(){}return n.prototype.merge=function(e,t){this._leaves=e._visibleLeaves(),this._data=t,this._merge()},n.prototype._merge=function(){var e=!0;for(var n=0,r=this._leaves.length;n<r;n++)if(this._leaves[n]instanceof t.c1field){var i=this._leaves[n];if(i.options.rowMerge==="free"||i.options.rowMerge==="restricted")e&&(this._data.ensureNotLazy(),e=!1),this._mergeColumn(i)}},n.prototype._mergeColumn=function(e){var t=e.options._leavesIdx;for(var n=0,r=this._data.count();n<r;n++){var i=this._data.row(n);if(!i.isPureDataRow())continue;var s=this._getCellRange(n,e);if(s.r1!==s.r2){var o=s.r2-s.r1+1;this._data.row(s.r1).cell(t).ensureAttr().rowSpan=o;for(var u=s.r1+1;u<=s.r2;u++)this._data.row(u).cell(t).visible(!1)}n=s.r2}},n.prototype._getCellRange=function(t,n){var r=n.options._leavesIdx,i=new e.grid.cellRange(t,r),s=(this._data.valueAt(t,r)||"").toString(),o=this._data.count();for(i.r2=t;i.r2<o-1;i.r2++){var u=this._data.row(i.r2+1);if(!u.isPureDataRow()||(u.valueCell(r).value||"").toString()!==s)break}var a=n.options._leavesIdx;if(a>0&&n.options.rowMerge==="restricted"){var f=this._leaves[a-1];if(f instanceof e.grid.c1field){var l=this._getCellRange(t,f);i.r1=Math.max(i.r1,l.r1),i.r2=Math.min(i.r2,l.r2)}}return i},n}();t.merger=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){function d(e){if(e){while(e.rows.length){var t;while((t=e.rows[0]).cells.length){var n=t.cells[0];while(n.firstChild)n.removeChild(n.firstChild);t.deleteCell(0),t=n=null}e.deleteRow(0)}while(e.firstChild)e.removeChild(e.firstChild)}e=null}function v(t,r){var i;if(n.isArray(t)&&n.isArray(r)){if(t.length===r.length){i=!0;for(var s=0,o=t.length;s<o&&i;s++)i=e.grid.compareObj(t[s],r[s]);return i}}else{if(n.isPlainObject(t)&&n.isPlainObject(r)){for(var u in t)if(t.hasOwnProperty(u)&&!e.grid.compareObj(t[u],r[u]))return!1;for(var u in r)if(r.hasOwnProperty(u)&&!e.grid.compareObj(t[u],r[u]))return!1;return!0}t instanceof Date&&(t=t.getTime()),r instanceof Date&&(r=r.getTime())}return t===r}function m(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];var r,i;if(!e)return"";for(r=0,i=t.length;r<i;r++)e=e.replace(new RegExp("\\{"+r+"\\}","gm"),t[r]);return e}function g(e){return e&&!(e<0)||e===0}function y(e){return e&&e instanceof Date?!k(e.getTime()):!1}function b(e){return e.dataType||"string"}function w(e,t){e&&t&&e.find(".ui-widget,.wijmo-wijgrid-root").each(function(e,r){return n.each(n(r).data(),function(n,r){r.widgetName&&t(e,r)}),!0})}function E(e,t){var r=[];n.each(e.data(),function(e){e.indexOf(t)===0&&r.push(e)}),n.each(r,function(t,n){e.removeData(n)})}function x(e){var t={};return t._dynamic=!0,t._isLeaf=!0,n.extend(!0,t,e)}function T(e,t){if(e){var r=e.nodeType?n(e):e,i=r.offset();if(i)return t?{top:i.top,left:i.left,width:r[0].clientWidth||0,height:r[0].clientHeight||0}:{top:i.top,left:i.left,width:r.outerWidth(),height:r.outerHeight()}}return null}function N(e,t){return e&&(e.start<0&&(e.start=0),e.end<0&&(e.end=0),e.start=Math.min(e.start,t),e.end=Math.min(e.end,t)),e}function C(t,n,r){if(!r&&t.nodeType===3){var i=(t.nodeValue||"").replace(/[\r\t\n]+/g,"");return i}if(t&&n!==0){if(!r&&t.nodeType===3)return t.nodeValue;if(t.nodeType===1){switch(t.type){case"button":case"text":case"textarea":case"select-one":return t.value;case"checkbox":return t.checked.toString()}var s="",o=0,u;while(u=t.childNodes[o++])s+=e.grid._getDOMText(u,n-1,r);return s}}return""}function k(e){return e!==e}function L(e,t,r,i){var s=e.jquery||n.isArray(e),o=t+r;if(arguments.length===3)return s?n.data(e[0],o):n.data(e,o);if(s){var u;for(var a=0,f=e.length;a<f;a++)u=n.data(e[a],o,i);return u}return n.data(e,o,i)}function A(e,t){if(t&&e)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],i=typeof r;(i==="string"||i==="boolean"||i==="number")&&e[n]===undefined&&(e[n]=r)}}function O(e,t){if(e){var n=0,r={};for(var i=0,s=e.attributes.length;i<s;i++){var o=e.attributes[i].name;if(o&&(!t||!t(o))){var u=e.getAttribute(o);o==="style"&&(u=typeof u=="object"?u.cssText:u),!u&&o==="class"&&(u=e.getAttribute("className")),u&&typeof u!="function"&&(r[o]=u,n++)}}if(n)return r}return null}function M(t,r){var i,s,o,u,a;if(t){typeof r!="object"&&!n.isFunction(r)&&(r={});for(i in t){s=t[i],o=r[o];if(s===r)continue;s&&(n.isPlainObject(s)||(u=n.isArray(s)))?(u?(u=!1,a=o&&n.isArray(o)?o:[]):a=o&&n.isPlainObject(o)?o:{},r[i]=e.grid.deepExtend(s,a)):r[i]=s}}return r}function _(e,t){return e&&e.jquery&&(e=e[0]),e?arguments.length===1?n.data(e,"wijgridwidgetName"):n.data(e,"wijgridwidgetName",t):undefined}function P(e,t){typeof t=="undefined"&&(t=99);var r=0;return e&&n.ui&&n.fn.zIndex&&(r=e.zIndex(),r&&r++),Math.max(r,t)}function H(e,t,n){return e>t&&e<t+n}function B(t,n,r,i,s,o){return e.grid.isOverAxis(t,r,s)&&e.grid.isOverAxis(n,i,o)}function F(){return"uid"+j++}function I(){return!!navigator&&!!navigator.userAgent&&navigator.userAgent.match(/Mobile.*Safari/)!==null}function q(){if(navigator){var e=(navigator.userAgent||"").toLowerCase();return!!(e.indexOf("android")>=0||e.match(/iphone|ipad|ipod|mobi/i))}return!1}function R(){return window.orientation||0}function U(e){return!!e&&typeof e=="string"&&e[e.length-1]==="%"}function z(e){return e?e[1]?n(e):n(e[0]):null}function X(){if(!(W>0)){if(document&&document.body&&n.support.isTouchEnabled&&n.support.isTouchEnabled()){var e;try{e=n("<div></div>").css({overflow:"scroll",width:30,height:30,position:"absolute",visibility:"hidden"}).append(n("<div></div>").css({width:100,height:100})).appendTo(document.body),W=e[0].offsetWidth-e[0].clientWidth}catch(t){}finally{e&&e.remove()}}W>0||(W=18)}return W}function V(e,t,r){var i="";if(t&&e.childNodes.length===1&&e.firstChild.nodeType===3){i=e.textContent!==undefined?e.textContent:e.innerText,r&&(i=r===2?n.trim(i):J(i));if(i&&i.length===1){var s=i.charCodeAt(0);if(s===160||s===32&&n.trim(e.innerHTML)==="&nbsp;")i=""}}else i=e.innerHTML,r&&(i=r===2?n.trim(i):J(i)),i==="&nbsp;"&&(i="");return i}function $(e,t,n){t?e.textContent!==undefined?e.textContent=n||"":e.innerText=n||"":e.innerHTML=n||"&nbsp;"}function J(e){return e===null?"":(e+"").replace(r,"")}var n=jQuery;t.EXPANDO="__wijgrid";var r=/^[\f\n\r\t]+|[\f\n\r\t]+$/g;(function(e){e[e.header=1]="header",e[e.data=2]="data",e[e.dataAlt=4]="dataAlt",e[e.filter=8]="filter",e[e.groupHeader=16]="groupHeader",e[e.groupFooter=32]="groupFooter",e[e.footer=64]="footer",e[e.emptyDataRow=128]="emptyDataRow",e[e.dataHeader=256]="dataHeader",e[e.dataDetail=512]="dataDetail",e[e.detail=1024]="detail"})(t.rowType||(t.rowType={}));var i=t.rowType;(function(e){e[e.none=0]="none",e[e.rendering=1]="rendering",e[e.current=2]="current",e[e.hovered=4]="hovered",e[e.selected=8]="selected",e[e.editing=16]="editing"})(t.renderState||(t.renderState={}));var s=t.renderState;(function(e){e[e.none=0]="none",e[e.hidden=1]="hidden",e[e.collapsed=2]="collapsed"})(t.renderStateEx||(t.renderStateEx={}));var o=t.renderStateEx;(function(e){e[e.table=0]="table",e[e.head=1]="head",e[e.body=2]="body",e[e.foot=3]="foot"})(t.rowScope||(t.rowScope={}));var u=t.rowScope;(function(e){e[e.none=0]="none",e[e.column=1]="column",e[e.row=2]="row"})(t.cellRangeExtendMode||(t.cellRangeExtendMode={}));var a=t.cellRangeExtendMode;(function(e){e[e.createIfNull=0]="createIfNull",e[e.createAlways=1]="createAlways",e[e.dispose=2]="dispose"})(t.objectMode||(t.objectMode={}));var f=t.objectMode;(function(e){e[e.groupCell=0]="groupCell",e[e.aggregateCell=1]="aggregateCell"})(t.groupRowCellPurpose||(t.groupRowCellPurpose={}));var l=t.groupRowCellPurpose;(function(e){e[e.sketch=0]="sketch",e[e.rendered=1]="rendered",e[e.renderable=2]="renderable"})(t.dataRowsRangeMode||(t.dataRowsRangeMode={}));var c=t.dataRowsRangeMode;(function(e){e[e.none=0]="none",e[e.overlapTop=1]="overlapTop",e[e.overlapBottom=2]="overlapBottom",e[e.reset=3]="reset"})(t.intersectionMode||(t.intersectionMode={}));var h=t.intersectionMode;(function(e){e[e.none=0]="none",e[e.control=1]="control",e[e.all=2]="all"})(t.trimMethod||(t.trimMethod={}));var p=t.trimMethod;t.emptyTable=d,t.compareObj=v,t.stringFormat=m,t.validDataKey=g,t.validDate=y,t.getDataType=b,t.iterateChildrenWidgets=w,t.remove$dataByPrefix=E;var S=function(){function e(e){this._dom=e}return e.prototype.getSelection=function(){var e=0,t=0,n;return this._dom.selectionStart!==undefined?(e=this._dom.selectionStart,t=this._dom.selectionEnd):document.selection&&(n=document.selection.createRange().duplicate(),t=n.text.length,e=Math.abs(n.moveStart("character",-this._dom.value.length)),t+=e),{start:e,end:t,length:t-e}},e.prototype.setSelection=function(e){if(this._dom.selectionStart!==undefined)this._dom.setSelectionRange(e.start,e.end);else{var t=this._dom.createTextRange();t.collapse(!0),t.moveStart("character",e.start),t.moveEnd("character",e.end),t.select()}},e.prototype.toggleSelection=function(e){var t=n(this._dom),r="onselectstart"in this._dom;e?r?t.unbind(".wijgrid-disableSelection"):t.css({MozUserSelect:"",WebkitUserSelect:""}):r?t.bind("selectstart.wijgrid-disableSelection",function(e){e.preventDefault()}):t.css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})},e}();t.domSelection=S,t.createDynamicField=x,t.bounds=T,t.ensureBounds=N,t._getDOMText=C,t.isNaN=k,t.dataPrefix=L,t.shallowMerge=A,t.getAttributes=O,t.deepExtend=M,t.widgetName=_;var D=function(){function t(){}return t.isExtendSupportRequired=function(t){return t=(t||"").toLowerCase(),t in e.grid.HTML5InputSupport._requiresExtendedSupport},t.getDefaultInputType=function(n,r){var i=(r.inputType||"").toLowerCase();if(!i&&n)switch(e.grid.getDataType(r)){case"number":case"currency":i="number";break;case"datetime":i="datetime"}if(!i||i!=="text"&&!t._isSupportedByBrowser(i))i="text";return i},t.toStr=function(t,n){var r=t;n=(n||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(n))switch(n){case"datetime":r=t?r=Globalize.format(t,"yyyy-MM-ddTHH:mm:ssZ"):"";break;case"datetime-local":r=t?r=Globalize.format(t,"yyyy-MM-ddTHH:mm:ss"):"";break;case"date":r=t?r=Globalize.format(t,"yyyy-MM-dd"):"";break;case"month":r=t?r=Globalize.format(t,"yyyy-MM"):"";break;case"time":r=t?r=Globalize.format(t,"HH:mm:ss"):""}else r=t+"";return r},t.parse=function(t,n){var r,i=function(t){return t=new Date(t),e.grid.validDate(t)||(t=null),t};n=(n||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(n))switch(n){case"datetime":r=Globalize.parseDate(t,"yyyy-MM-ddTHH:mm:ssZ")||Globalize.parseDate(t,"yyyy-MM-ddTHH:mmZ")||i(t);break;case"datetime-local":r=Globalize.parseDate(t,"yyyy-MM-ddTHH:mm:ss")||Globalize.parseDate(t,"yyyy-MM-ddTHH:mm")||i(t);break;case"date":r=Globalize.parseDate(t,"yyyy-MM-dd")||i(t);break;case"month":r=Globalize.parseDate(t,"yyyy-MM");break;case"time":r=Globalize.parseDate(t,"HH:mm:ss")||Globalize.parseDate(t,"HH:mm");break;case"number":r=parseFloat(t)}else r=t;return r},t.extend=function(e,t,n){if(!e)e=t;else{n=(n||"").toLowerCase();switch(n){case"date":e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate());break;case"month":e.setFullYear(t.getFullYear(),t.getMonth());break;case"time":e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds());break;default:e=t}}return e},t._isSupportedByBrowser=function(e){if(e){if(this._supportedInputTypesCache[e]===undefined){var t;try{var r=n("<input type='"+e+"' style='display:none' />");t=!0}catch(i){t=!1}this._supportedInputTypesCache[e]=t&&r[0].type===e}return this._supportedInputTypesCache[e]}return!1},t._requiresExtendedSupport={date:"",datetime:"","datetime-local":"",month:"",time:""},t._supportedInputTypesCache={},t}();t.HTML5InputSupport=D,t.getZIndex=P,t.isOverAxis=H,t.isOver=B;var j=0;t.getUID=F,t.isMobileSafari=I,t.isMobile=q,t.getWindowOrientation=R,t.isPercentage=U,t.rowObjToJQuery=z;var W=0;t.getSuperPanelScrollBarSize=X,t.getContent=V,t.setContent=$;var K=function(){function e(){}return e.persistAndClear=function(e){var t={},n=function(e,t){e&&(e.data&&(t.data=e.data,e.data=undefined),e.detail&&(t.detail={},n(e.detail,t.detail)))};return n(e,t),t},e.restore=function(e,t){var n=function(e,t){e&&t&&(t.data&&(e.data=t.data),n(e.detail,t.detail))};n(e,t)},e.persistAndClearIntoElement=function(e,t){n.data(e,this.DATA_STORAGE_KEY,this.persistAndClear(t))},e.restoreFromElement=function(e,t,r){typeof r=="undefined"&&(r=!1),this.restore(t,n.data(e,this.DATA_STORAGE_KEY)),r&&n.removeData(e,this.DATA_STORAGE_KEY)},e.DATA_STORAGE_KEY="wijgridDataStorage",e}();t.DataOptionPersister=K,n.extend(n.wijmo.wijgrid,{rowType:e.grid.rowType,renderState:e.grid.renderState,bounds:e.grid.bounds})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){function i(e,t){var n=!1,r;return function(){return n||(r=t?e.call(t):e(),n=!0),r}}(function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=2]="Second",e[e.Minute=4]="Minute",e[e.Hour=8]="Hour",e[e.Day=16]="Day",e[e.Month=32]="Month",e[e.Year=64]="Year",e[e.DATE=112]="DATE",e[e.TIME=15]="TIME",e[e.ALL=e.DATE|e.TIME]="ALL"})(t.TimeUnit||(t.TimeUnit={}));var n=t.TimeUnit,r=function(){function t(){}return t.convertInputType=function(t){var n=e.grid.TimeUnitConverter.convertInputTypeToFormatString(t),r=e.grid.TimeUnitConverter.convertFormatString(n);return r},t.convertInputTypeToFormatString=function(e){switch((e||"").toLowerCase()){case"datetime":case"datetime-local":return"f";case"date":return"d";case"month":return"Y";case"time":return"t"}return""},t.convertFormatString=function(e){var t=0;if(e){if(e.length===1)switch(e[0]){case"t":return 12;case"T":return n.TIME;case"d":case"D":return n.DATE;case"Y":return 96;case"M":return 48;case"f","F","S":return n.ALL}var r,i;(r=e.indexOf("'"))>=0&&(i=e.lastIndexOf("'"))>=0&&r!==i&&(e=e.substr(0,r)+e.substring(i+1,e.length-1));for(var s=0,o=e.length;s<o;s++)switch(e[s]){case"d":t|=16;break;case"M":t|=32;break;case"y":t|=64;break;case"m":t|=4;break;case"h":case"H":t|=8;break;case"s":t|=2;break;case"f":t|=1}}return t||n.ALL},t.cutDate=function(e,t){return e&&(t=~t,t&1&&e.setMilliseconds(0),t&2&&e.setSeconds(0),t&4&&e.setMinutes(0),t&8&&e.setHours(0),t&16&&e.setDate(1),t&32&&e.setMonth(0),t&64&&e.setFullYear(0)),e},t}();t.TimeUnitConverter=r,t.lazy=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function e(){}return e.NoFilterOp={applicableTo:null,name:"NoFilter",displayName:"No filter",arity:1,operator:function(){return!0}},e}(),i=function(){function t(t){this._cache={};var i=this;this._wijgrid=t,this._addOperator(null,r.NoFilterOp),n.each(e.data.filtering.ops,function(e,t){i._addOperator(e,t)}),n.each(t.options.customFilterOperators,function(e,t){i._addOperator(null,t,!0)})}return t.prototype.getByName=function(e){var t=this.getByNameInt(e);return t?t.op:null},t.prototype.getByNameInt=function(e){return this._cache[(e||"").toLowerCase()]},t.prototype.getByDataType=function(e){var t=[],r;n.each(this._cache,function(r,i){var s=i.op;(!s.applicableTo||n.inArray(e,s.applicableTo)>=0)&&t.push(i)});switch(this._wijgrid.options.filterOperatorsSortMode.toLowerCase()){case"alphabetical":t.sort(this._sortAlpha);break;case"alphabeticalcustomfirst":t.sort(this._sortAlphaCustomFirst);break;case"alphabeticalembeddedFirst":t.sort(this._sortAlphaEmbeddedFirst);break;case"none":break;default:}return r=n.map(t,function(e,t){return e.op}),r},t.prototype._addOperator=function(e,t,n){typeof n=="undefined"&&(n=!1),e&&!t.name&&(t.name=e),e=(e||t.name).toLowerCase(),this._cache[e]||(this._cache[e]={op:t,isCustom:n===!0})},t.prototype._sortAlpha=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaEmbeddedFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return 1;if(t.isCustom)return-1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaCustomFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return-1;if(t.isCustom)return 1}return n===r?0:n<r?-1:1},t}();t.filterOperatorsCache=i;var s=function(){function t(){}return t.getSingleValue=function(e){return n.isArray(e)&&(e=e[0],n.isArray(e)&&(e=e[0])),e},t.getSingleOperatorName=function(e){return n.isArray(e)&&(e=e[0]),e.name||e||""},t.verify=function(t,r,i,s){if(t)if(n.isArray(t)){var o=[],u=[];n.isArray(r)||(r=[r]);for(var a=0,f=t.length;a<f;a++)e.grid.filterHelper._verifySingleOp(t[a],r[a],i,s)&&(o.push({name:t[a].name||t[a],condition:t[a].condition||"or"}),u.push(r?r[a]:undefined));if(o.length)return{operator:o,value:u}}else if(e.grid.filterHelper._verifySingleOp(t,r,i,s))return{operator:t,value:r};return null},t._verifySingleOp=function(t,r,i,s){if(t&&(t=t.name||t)){var o;t=(t||"").toLowerCase();if((t!=="nofilter"||r!==undefined)&&(o=s.getByName(t)))if(o.applicableTo===null||n.inArray(i||"string",o.applicableTo)>=0)if(o.arity===1||o.arity>1&&e.grid.filterHelper.getSingleValue(r)!==undefined)return!0}return!1},t.marker="_wijgrid",t}();t.filterHelper=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){function r(e,t){e&&!e.nodeType&&(e=e[0]);if(e)switch(t){case 1:return e.tHead;case 2:if(e.tBodies)return e.tBodies[0]||null;break;case 3:return e.tFoot;default:return e}return null}function i(e,t){var n;return e&&!e.nodeType&&(e=e[0]),e&&(n=this.getTableSection(e,t))?n.rows.length:0}function s(e,t,n){var r;return e&&!e.nodeType&&(e=e[0]),e&&(r=this.getTableSection(e,t))?r.rows[n]||null:null}function o(t,n,r,i,s){var o=[],u=function(e){return e=e.toLowerCase(),e==="rowspan"||e==="colspan"},a;t&&!t.nodeType&&(t=t[0]);if(t&&(a=this.getTableSection(t,n)))for(var f=0,l=a.rows.length;f<l;f++){var c=a.rows[f],h=[],p;if(s){var d=e.data.Expando.getFrom(h,!0);p=d[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:e.grid.getAttributes(c)||{}}}for(var v=0,m=c.cells.length;v<m;v++){var g=e.grid.getContent(c.cells[v],r,i);h[v]=g,s&&(p.cellsAttributes[v]=e.grid.getAttributes(c.cells[v],u)||{})}o[f]=h}return o}function u(e){var t=e.parentNode.parentNode;switch(t.tagName.toLowerCase()){case"thead":return 1;case"tbody":return 2;case"tfoot":return 3}return null}var n=jQuery;t.getTableSection=r,t.getTableSectionLength=i,t.getTableSectionRow=s,t.readTableSection=o,t.determineSection=u;var a=function(){function t(e,t,n,r){this._width=0,this._table=e,this._offsets=[],r&&this.ensureColGroup(),n&&this.ensureTBody(),t||this._buildOffsets()}return t.prototype.element=function(){return this._table},t.prototype.width=function(){return this._width},t.prototype.getCellIdx=function(e,t){return e<this._width&&t>=0&&t<this._offsets.length?this._offsets[t][e].cellIdx:-1},t.prototype.getColumnIdx=function(e,t){if(typeof e!="number"){var n=e;e=n.cellIndex,t=n.parentNode.rowIndex}return e<this._width?this._offsets[t][e].colIdx:-1},t.prototype.clearContent=function(){if(this._table){while(this._table.firstChild)this._table.removeChild(this._table.firstChild);this.ensureColGroup(),this.ensureTBody()}},t.prototype.clearSection=function(t){var r,i,s=e.grid.getTableSection(this._table,t);switch(t){case 2:r=this.getSectionLength(0),i=r+this.getSectionLength(t)-1;break;case 3:r=this.getSectionLength(0)+this.getSectionLength(1),i=r+this.getSectionLength(t)-1;break;default:r=0,i=this.getSectionLength(t)-1}while(s.rows.length)n(s.rows[0]).remove();this._offsets.splice(r,i-r+1)},t.prototype.getSectionLength=function(t){return e.grid.getTableSectionLength(this._table,t)},t.prototype.getSectionRow=function(t,n){return e.grid.getTableSectionRow(this._table,n,t)},t.prototype.forEachColumnCellNatural=function(e,t,n){for(var r=0,i=this._table.rows.length;r<i;r++){var s=this._table.rows[r];if(e<s.cells.length){var o=t(s.cells[e],r,n);if(o!==!0)return o}}return!0},t.prototype.forEachColumnCell=function(e,t,n){for(var r=0,i=this._offsets.length;r<i;r++){var s=this._table.rows[r],o=this.getCellIdx(e,r);if(o>=0){var u=t(s.cells[o],r,n);if(u!==!0)return u}}return!0},t.prototype.forEachRowCell=function(e,t,n){var r=this._table.rows[e];for(var i=0,s=r.cells.length;i<s;i++){var o=t(r.cells[i],i,n);if(o!==!0)return o}return!0},t.prototype.colGroupTag=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||null},t.prototype.colTags=function(){var e=this.colGroupTag();return e&&e.getElementsByTagName("col")||[]},t.prototype.ensureTBody=function(){return this._table.tBodies&&this._table.tBodies[0]||this._table.appendChild(document.createElement("tbody"))},t.prototype.ensureTHead=function(){return this._table.tHead&&this._table.tHead[0]||this._table.createTHead()},t.prototype.ensureTFoot=function(){return this._table.tFoot&&this._table.tFoot[0]||this._table.createTFoot()},t.prototype.ensureColGroup=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||this._table.appendChild(document.createElement("colgroup"))},t.prototype.appendCol=function(e){var t=this.ensureColGroup();return e&&t.appendChild(e)||t.appendChild(document.createElement("col"))},t.prototype.removeOffset=function(e){if(e>=0&&e<this._offsets.length){if(e<0||!e&&e!==0)e=this._offsets.length-1;this._offsets.splice(e,1)}},t.prototype.insertOffset=function(e){var t,n;if(this._width>0){t=[];for(n=0;n<this._width;n++)t.push({cellIdx:n,colIdx:n});if(e<0||!e&&e!==0)e=this._offsets.length;this._offsets.splice(e,0,t)}},t.prototype.rebuildOffsets=function(){this._offsets=[],this._width=0,this._buildOffsets()},t.prototype._buildOffsets=function(){var e=[];for(var t=0,n=this._table.rows.length;t<n;t++){var r=[],i=0,s=this._table.rows[t];this._offsets[t]=r;for(var o=0,u=s.cells.length;o<u;o++,i++){var a=s.cells[o];for(;e[i]>1;i++)e[i]--,r[i]={cellIdx:-1,colIdx:-1};e[i]>1||(e[i]=a.rowSpan),r[i]={cellIdx:o,colIdx:-1},r[o].colIdx=i;var f=a.colSpan;for(;f>1;f--)r[++i]={cellIdx:-1,colIdx:-1}}var l=e.length;for(;i<l;i++)e[i]--,r[i]={cellIdx:-1,colIdx:-1};this._width=Math.max(this._width,l)}},t}();t.htmlTableAccessor=a})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function r(e,t,n,r,i){typeof n=="undefined"&&(n=null),typeof r=="undefined"&&(r=!1),typeof i=="undefined"&&(i=!0),this.mIsPreparingForEditing=!1,this.mIsEdit=!1,this._wijgrid=n,this._virtualize=i,r?(this._ci=e-this._wijgrid._getDataToAbsOffset().x,this._ri=t-this._wijgrid._getDataToAbsOffset().y,this._virtualize&&(this._ci>=0&&(this._ci=this._wijgrid._renderedLeaves()[this._ci].options._visLeavesIdx),this._ri>=0&&(this._ri=this._wijgrid._renderableRowsRange().getAbsIndex(this._ri+this._wijgrid._viewPortBounds().start)))):(this._ci=e,this._ri=t)}return r.prototype.cellIndexAbs=function(){var e=this._wijgrid._getDataToAbsOffset().x,t=this._virtualize?this._wijgrid._visibleLeaves()[this._ci+e].options._renderedIndex:this._ci+e;return t},r.prototype.rowIndexAbs=function(){var e=this._virtualize?this._wijgrid._renderableRowsRange().getRenderedIndex(this._ri)-this._wijgrid._viewPortBounds().start:this._ri;return e+=this._wijgrid._getDataToAbsOffset().y,e},r.prototype.cellIndex=function(e){if(!arguments.length)return this._ci;this._ci=e},r.prototype.column=function(){var e=this.columnInst();return e?e.options:null},r.prototype.columnInst=function(){if(this._wijgrid&&this._isValid()){var e=this._wijgrid._getDataToAbsOffset();return this._wijgrid._visibleLeaves()[this.cellIndex()+e.x]}return null},r.prototype.container=function(){var t=this.tableCell(),r;if(t){r=n(t).children("div."+e.grid.wijgrid.CSS.cellContainer);if(r)return r}return null},r.prototype.isEqual=function(e){return e&&e.rowIndex()===this.rowIndex()&&e.cellIndex()===this.cellIndex()},r.prototype.row=function(){var e=null,t=null;return this._wijgrid&&(this._virtualize?t=this._wijgrid._view()._getRowInfoBySketchRowIndex(this.rowIndex()):(e=this._wijgrid._view().rows().item(this.rowIndexAbs()),e&&e.length&&(t=this._wijgrid._view()._getRowInfo(e)))),t},r.prototype.rowIndex=function(e){if(!arguments.length)return this._ri;this._ri=e},r.prototype.tableCell=function(){if(this._wijgrid&&this._isValid())if(!this._virtualize||this._isRendered())return this._wijgrid._view().getCell(this.cellIndexAbs(),this.rowIndexAbs());return null},r.prototype.value=function(n){var r,i,s;if(this._wijgrid&&this._isValid()){i=this.row();if(i.type&2){r=this.column();if(arguments.length===0)return s=this._wijgrid.mDataViewWrapper.getValue(i.data,r.dataKey),this._wijgrid.parse(r,s);n=this._wijgrid.parse(r,n);if(n===null&&r.valueRequired||e.grid.getDataType(r)!=="string"&&t.isNaN(n))throw"invalid value";this._wijgrid.mDataViewWrapper.setValue(i.dataItemIndex,r.dataKey,n);var o=this._sketchRow();if(o){var u=o.cell(r._leavesIdx);u.value=n}}}},r.prototype.toString=function(){return this.cellIndex()+":"+this.rowIndex()},r.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=!1,r;return t?(this.cellIndexAbs()<(r=e.topLeft().cellIndexAbs())&&(n=!0,this._ci=e.topLeft().cellIndex()),this.cellIndexAbs()>(r=e.bottomRight().cellIndexAbs())&&(n=!0,this._ci=e.bottomRight().cellIndex()),this.rowIndexAbs()<(r=e.topLeft().rowIndexAbs())&&(n=!0,this._ri=e.topLeft().rowIndex()),this.rowIndexAbs()>(r=e.bottomRight().rowIndexAbs())&&(n=!0,this._ri=e.bottomRight().rowIndex())):(this.cellIndex()<(r=e.topLeft().cellIndex())&&(n=!0,this._ci=r),this.cellIndex()>(r=e.bottomRight().cellIndex())&&(n=!0,this._ci=r),this.rowIndex()<(r=e.topLeft().rowIndex())&&(n=!0,this._ri=r),this.rowIndex()>(r=e.bottomRight().rowIndex())&&(n=!0,this._ri=r)),n},r.prototype._clone=function(){return new e.grid.cellInfo(this.cellIndex(),this.rowIndex(),this._wijgrid,!1,this._virtualize)},r.prototype._isValid=function(){return this.cellIndex()>=0&&this.rowIndex()>=0},r.prototype._isRowRendered=function(){var e;if(this._wijgrid&&(e=this._wijgrid._view())&&this._isValid()){var t=e._isRowRendered(this.rowIndex());return t>=0}return!1},r.prototype._isRendered=function(){var e;if(this._wijgrid&&(e=this._wijgrid._view())&&this._isValid()&&this.columnInst()._isRendered()){var t=e._isRowRendered(this.rowIndex());return t>=0}return!1},r.prototype._isPreparingForEditing=function(e){return arguments.length&&(this.mIsPreparingForEditing=e),this.mIsPreparingForEditing},r.prototype._isEdit=function(t){var r=null,i=e.grid.wijgrid.CSS.editedCellMarker;if(this._isValid())try{r=this.tableCell()}catch(s){}if(!arguments.length)return r?n(r).hasClass(i):this.mIsEdit;r&&n(r)[t?"addClass":"removeClass"](i);var o=this._wijgrid;if(o&&this._wijgrid._showRowHeader()&&this._isRowRendered()){var u=this.row(),a=n(u.$rows[0].cells[0]).children("div."+e.grid.wijgrid.CSS.cellContainer);t?a.empty().append(n("<div>&nbsp;</div>").addClass(o.options.wijCSS.icon+" "+o.options.wijCSS.iconPencil)):a.html("&nbsp;")}this.mIsEdit=t},r.prototype._setGridView=function(e){this._wijgrid=e},r.prototype._sketchRow=function(){var e=this._wijgrid,t=this.row();return e&&t&&t.sketchRowIndex>=0?e.mSketchTable.row(t.sketchRowIndex):null},r.outsideValue=new r(-1,-1,null),r}();t.cellInfo=r;var i=function(){function e(e,t){if(!e||!t)throw"invalid arguments";this._topLeft=e._clone(),this._bottomRight=t._clone()}return e.prototype.bottomRight=function(){return this._bottomRight},e.prototype.isEqual=function(e){return e&&this._topLeft.isEqual(e.topLeft())&&this._bottomRight.isEqual(e.bottomRight())},e.prototype.topLeft=function(){return this._topLeft},e.prototype.toString=function(){return this._topLeft.toString()+" - "+this._bottomRight.toString()},e.prototype._isIntersect=function(e){var t,n,r,i;if(e){t=e.bottomRight().rowIndex()-e.topLeft().rowIndex()+1,n=this._bottomRight.rowIndex()-this._topLeft.rowIndex()+1;if(e.topLeft().rowIndex()+t-this._topLeft.rowIndex()<t+n)return r=e.bottomRight().cellIndex()-e.topLeft().cellIndex()+1,i=this._bottomRight.cellIndex()-this._topLeft.cellIndex()+1,e.topLeft().cellIndex()+r-this._topLeft.cellIndex()<r+i}return!1},e.prototype._isValid=function(){return this._topLeft._isValid()&&this._bottomRight._isValid()},e.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=this._topLeft._clip(e,t),r=this._bottomRight._clip(e,t);return n||r},e.prototype._clone=function(){return new e(this._topLeft._clone(),this._bottomRight._clone())},e.prototype._containsCellInfo=function(e){return e&&e.cellIndex()>=this._topLeft.cellIndex()&&e.cellIndex()<=this._bottomRight.cellIndex()&&e.rowIndex()>=this._topLeft.rowIndex()&&e.rowIndex()<=this._bottomRight.rowIndex()},e.prototype._containsCellRange=function(e){return e&&this._containsCellInfo(e.topLeft())&&this._containsCellInfo(e.bottomRight())},e.prototype._extend=function(e,t){return e===1?(this._topLeft.rowIndex(t.topLeft().rowIndex()),this._bottomRight.rowIndex(t.bottomRight().rowIndex())):e===2&&(this._topLeft.cellIndex(t.topLeft().cellIndex()),this._bottomRight.cellIndex(t.bottomRight().cellIndex())),this},e.prototype._normalize=function(){var e=this._topLeft.cellIndex(),t=this._topLeft.rowIndex(),n=this._bottomRight.cellIndex(),r=this._bottomRight.rowIndex();this._topLeft.cellIndex(Math.min(e,n)),this._topLeft.rowIndex(Math.min(t,r)),this._bottomRight.cellIndex(Math.max(e,n)),this._bottomRight.rowIndex(Math.max(t,r))},e.prototype._height=function(){return this._bottomRight.rowIndex()-this._topLeft.rowIndex()},e.prototype._width=function(){return this._bottomRight.cellIndex()-this._topLeft.cellIndex()},e}();t.cellInfoRange=i,n.extend(n.wijmo.wijgrid,{cellInfo:e.grid.cellInfo,cellInfoRange:e.grid.cellInfoRange})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function r(t,n){this.mIsRendered=!1,this.mIsLiveUpdate=!1,this.mDetailsToInstantiate=[],this._sizesAdjCache={th:0,col:0,subTable:0};if(!t)throw"'wijgrid' must be specified";this._wijgrid=t,this._bounds=n,this._wijgrid.element.addClass(e.grid.wijgrid.CSS.table).addClass(this._wijgrid.options.wijCSS.wijgridTable)}return r.prototype.dispose=function(){this.toggleDOMSelection(!0),this._wijgrid.element.removeClass(e.grid.wijgrid.CSS.table).removeClass(this._wijgrid.options.wijCSS.wijgridTable)},r.prototype.currentRenderableColumns=function(e){return arguments.length&&(this.mCurrentRenderableColumns=e),this.mCurrentRenderableColumns},r.prototype.ensureDisabledState=function(){var e="wijmo-wijgrid-disabled "+this._wijgrid.options.wijCSS.stateDisabled,t=this._wijgrid.options.disabled,r=this;n.each(this.subTables(),function(i,s){if(s){var o=n(s.element());t?(o.addClass(e),r._wijgrid._setAttr(o,"aria-disabled",!0)):(o.removeClass(e),r._wijgrid._setAttr(o,"aria-disabled",!1))}})},r.prototype.ensureHeight=function(e){},r.prototype.getScrollValue=function(){return null},r.prototype.getVisibleAreaBounds=function(e){throw"not implemented"},r.prototype.getVisibleContentAreaBounds=function(){throw"not implemented"},r.prototype.getFixedAreaVisibleBounds=function(){throw"not implemented"},r.prototype.isLiveUpdate=function(){return this.mIsLiveUpdate},r.prototype.isRendered=function(){return this.mIsRendered},r.prototype.render=function(e){this.mIsLiveUpdate=e,e||this._provideRealColumnsWidth(),this._ensureRenderBounds(),this._ensureRenderHBounds(),this._preRender(),this._renderContent(),this._postRender(),this.mIsLiveUpdate=!1,this._ensureRenderHBounds()},r.prototype.toggleDOMSelection=function(t){n.each(this.subTables(),function(n,r){(new e.grid.domSelection(r.element())).toggleSelection(t)}),(new e.grid.domSelection(this._wijgrid.mOuterDiv)).toggleSelection(t)},r.prototype.updateSplits=function(e,t){throw"not implemented"},r.prototype.updateSplitsLive=function(){throw"not implemented"},r.prototype.getInlineTotalWidth=function(){throw"not implemented"},r.prototype.bodyRows=function(){if(!this._bodyRowsAccessor){if(!this.isRendered())throw"not rendered yet";this._bodyRowsAccessor=new e.grid.rowAccessor(this,2,0,0)}return this._bodyRowsAccessor},r.prototype.filterRow=function(){if(this._wijgrid.options.showFilter){if(!this.isRendered())throw"not rendered yet";var t=new e.grid.rowAccessor(this,1,0,0);return t.item(t.length()-1)}return null},r.prototype.footerRow=function(){if(this._wijgrid.options.showFooter){if(!this.isRendered())throw"not rendered yet";var t=new e.grid.rowAccessor(this,3,0,0);return t.item(0)}},r.prototype.headerRows=function(){var t;if(!this._headerRowsAccessor){if(!this.isRendered())throw"not rendered yet";t=this._wijgrid.options.showFilter?1:0,this._headerRowsAccessor=new e.grid.rowAccessor(this,1,0,t)}return this._headerRowsAccessor},r.prototype.rows=function(){if(!this._rowsAccessor){if(!this.isRendered())throw"not rendered yet";this._rowsAccessor=new e.grid.rowAccessor(this,0,0,0)}return this._rowsAccessor},r.prototype.focusableElement=function(){return this._wijgrid.mOuterDiv},r.prototype.forEachColumnCell=function(e,t,n){throw"not implemented"},r.prototype.forEachRowCell=function(e,t,n){throw"not implemented"},r.prototype.getAbsoluteCellInfo=function(e,t){throw"not implemented"},r.prototype.getAbsoluteCellIndex=function(e){throw"not implemented"},r.prototype.getAbsoluteRowIndex=function(e){throw"not implemented"},r.prototype.getCell=function(e,t){throw"not implemented"},r.prototype.getColumnIndex=function(e){throw"not implemented"},r.prototype.getHeaderCell=function(e){throw"not implemented"},r.prototype.getJoinedCols=function(e){throw"not implemented"},r.prototype.getJoinedRows=function(e,t){throw"not implemented"},r.prototype.getJoinedTables=function(e,t){throw"not implemented"},r.prototype.subTables=function(){throw"not implemented"},r.prototype._getMappedScrollMode=function(){var e=this._wijgrid._lgGetScrollMode(),t="auto",n="auto";switch(e){case"horizontal":t="hidden",n="visible";break;case"vertical":t="visible",n="hidden";break;case"both":t="visible",n="visible"}return{vScrollBarVisibility:t,hScrollBarVisibility:n}},r.prototype._postRender=function(){this.mIsRendered=!0;if(this.isLiveUpdate()){this.updateSplitsLive();return}this.ensureDisabledState(),this._sizesAdjCache.col=0,this._sizesAdjCache.th=0,this._sizesAdjCache.subTable=0;var e=this._wijgrid._visibleLeaves();if(e.length>0){var t=this.getHeaderCell(0),r=this.getJoinedCols(0);t&&(this._sizesAdjCache.th=n(t).leftBorderWidth()+n(t).rightBorderWidth()),r&&r.length&&(this._sizesAdjCache.col=n(r[0]).leftBorderWidth()+n(r[0]).rightBorderWidth())}var i=this.subTables()[0];this._sizesAdjCache.subTable=n(i.element()).leftBorderWidth()+n(i.element()).rightBorderWidth()},r.prototype._preRender=function(){this.mIsRendered=!1;var e=0,t=this._wijgrid._renderedLeaves();n.each(this._wijgrid._leaves(),function(n,r){r._isRendered()?(r.options._renderedIndex=e++,t.push(r)):r.options._renderedIndex=-1})},r.prototype._addDetailInstantiator=function(e){this.mDetailsToInstantiate.push(e)},r.prototype._ensureRenderBounds=function(){var e=this._wijgrid._getDataCellsRange(0);this._bounds.start=0,this._bounds.end=e.bottomRight().rowIndex()},r.prototype._ensureRenderHBounds=function(){var e=this._wijgrid._renderableColumnsRange();e.clear(),e.add(0,this._wijgrid._leaves().length-1),this.currentRenderableColumns(e)},r.prototype._provideRealColumnsWidth=function(){var t=this,r=this._wijgrid._visibleLeaves(),i=this._wijgrid.mOuterDiv,s=this._wijgrid._allowHVirtualScrolling();n.each(r,function(n,r){var o=r.options.width;!o&&o!==0&&s&&(o=t._wijgrid.options.scrollingSettings.virtualizationSettings.columnWidth);if(o||o===0)o=e.grid.isPercentage(o)?i.width()*parseFloat(o)/100:parseFloat(o),r.options._realWidth=o})},r.prototype._renderContent=function(){this._renderCOLS(),this._renderHeader(),this._wijgrid.options.showFilter&&this._renderFilter(),this.mDetailsToInstantiate=[],this._renderBody();for(var e=0;e<this.mDetailsToInstantiate.length;e++)this.mDetailsToInstantiate[e]();this._wijgrid.options.showFooter&&this._renderFooter()},r.prototype._renderCOLS=function(){var e=this,t=this._wijgrid._leaves();this.currentRenderableColumns().forEachIndex(function(n){var r=t[n],i,s;r._visible()&&(s=r.options._visLeavesIdx,i=e._createCol(r,s),e._appendCol(i,r,s))})},r.prototype._renderHeader=function(){var r=this,i=r._wijgrid._columnsHeadersTable(),s,o,u,a,f,l,c,h;if(i&&i.length){s=-r._wijgrid._virtualLeaves().length;for(var p=0,d=i.length;p<d;p++){o=r._insertEmptyRow(1,1,p,-1,-1,-1,-1,undefined,{}),u=r._wijgrid._tHead(),a=u&&e.grid.dataViewWrapper.getMetadata(u[o.sectionRowIndex]),f=a&&a.rowAttributes?new t.SketchHeaderRow(a.rowAttributes):new t.SketchHeaderRow(undefined);for(var v=0,m=i[p].length;v<m;v++)l=i[p][v],h=l.column||undefined,h&&(c=a&&a.cellsAttributes&&a.cellsAttributes[s++]?a.cellsAttributes[s++]:{},n.extend(c,{colSpan:l.colSpan,rowSpan:l.rowSpan})),f.add(new t.HeaderCell(h,c));r._renderRow(o,null,f)}}},r.prototype._renderFilter=function(){var e=this._insertEmptyRow(8,1,-1,-1,-1,-1,-1,undefined,{});this._renderRow(e,this._wijgrid._leaves(),null)},r.prototype._renderBody=function(){var t=e.grid.renderState,n=this._wijgrid._leaves(),r=this._wijgrid.mSketchTable,i=-1,s=0,o=0,u=this._wijgrid.mDataOffset,a=this;this._bounds.start>=0&&this._bounds.end>=0&&this._wijgrid._renderableRowsRange().forEachIndex(this._bounds.start,this._bounds.end-this._bounds.start+1,function(e){var t=e-u,f=r.row(t);if(f){var l=f.isDataRow(),c=f.groupByValue,h=a._insertEmptyRow(f.rowType,1,o++,l?++i:-1,f.dataItemIndex(),f.dataItemIndex(s),t,c,f.extInfo);a._renderRow(h,n,f)}})},r.prototype._renderFooter=function(){var e=this._insertEmptyRow(64,1,-1,-1,-1,-1,-1,undefined,{});this._renderRow(e,this._wijgrid._leaves(),null)},r.prototype._insertEmptyRow=function(e,t,n,r,i,s,o,u,a){var f=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),l=this._insertRow(e,n,f);return t===undefined&&(t=1),this._createRowInfo(l,e,t,n,r,i,s,o,u,a)},r.prototype._createEmptyCell=function(t,n,r){var i=e.grid.rowType,s=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(t.type,s)},r.prototype._insertRow=function(e,t,n){throw"not implemented"},r.prototype._createCell=function(t,r){var i=e.grid.rowType,s,o;r?o=n(r).css("white-space"):t===1?r=document.createElement("th"):r=document.createElement("td");if(t!==8){s=document.createElement("div"),s.className=e.grid.wijgrid.CSS.cellContainer+" "+this._wijgrid.options.wijCSS.wijgridCellContainer;if(r.firstChild)while(r.firstChild)s.appendChild(r.firstChild);o&&o!=="normal"&&(n(s).css("white-space",o),n(r).css("white-space","")),r.appendChild(s)}return n(r)},r.prototype._appendCell=function(e,t,n){throw"not implemented"},r.prototype._createCol=function(e,t){throw"not implemented"},r.prototype._appendCol=function(e,t,n){throw"not implemented"},r.prototype._renderRow=function(t,n,r){var i=e.grid.rowType,s,o;switch(t.type&-261){case 8:this._renderFilterRow(t,n);break;case 64:this._renderFooterRow(t,n);break;case 1:this._renderHeaderRow(t,r),s=r.attr(),o=r.style();break;case 2:this._renderDataRow(t,n,r),s=r.attr(),o=r.style();break;case 1024:case 514:case 128:case 16:case 32:this._renderSpannedRow(t,n,r),s=r.attr(),o=r.style();break;default:throw"unknown rowType"}this._rowRendered(t,s,o)},r.prototype._renderCell=function(e,t,r,i,s,o,u,a){var f=this._createEmptyCell(e,s.options.dataIndex,s),l=e.type===8?f:n(f[0].firstChild);this._appendCell(e,t,f),i?l.html(r!==undefined?r:"&nbsp;"):this._wijgrid.mCellFormatter.format(f,t,l,s,r,e),this._cellRendered(e,f,l,t,s,o,u,a)},r.prototype._renderDataRow=function(e,n,r){var i=this;this.currentRenderableColumns().forEachIndex(function(s){var o=n[s];if(o._visible()){var u=r.cell(s),a=u.attr(),f=u.style(),l,c=e.state;if(o instanceof t.c1field){if(!u||!u.visible())return;l=i._wijgrid.toStr(o.options,u.value),a=u.attr(),f=u.style()}else l=null;o.options.readOnly&&(c&=-17),i._renderCell(e,s,l,!1,o,c,a,f)}})},r.prototype._renderFilterRow=function(t,n){var r=this;this.currentRenderableColumns().forEachIndex(function(i){var s=n[i];s._visible()&&r._renderCell(t,i,e.grid.filterHelper.getSingleValue(s.options.filterValue),!1,s,t.state)})},r.prototype._renderFooterRow=function(e,t){var n=this;this.currentRenderableColumns().forEachIndex(function(r){var i=t[r];i._visible()&&n._renderCell(e,r,"",!1,t[r],e.state)})},r.prototype._renderHeaderRow=function(e,t){var n=this,r=0,i=-n._wijgrid._virtualLeaves().length;this.currentRenderableColumns().forEachIndex(function(s){var o=t.cell(s),u=o.column,a;u&&(u._thX2=i++,u._parentVis&&(u._thX=r++,u._thY=e.sectionRowIndex,a=n._wijgrid._findInstance(u),n._renderCell(e,s,u.headerText,!1,a,e.state,o.attr())))})},r.prototype._renderSpannedRow=function(e,t,n){var r=Math.min(t.length,n.cellCount());for(var i=0;i<r;i++){var s=t[i],o=e.type===128,u=n.cell(i);this._renderCell(e,i,u.html,o,s,e.state,u.attr(),u.style())}},r.prototype._cellRendered=function(e,t,n,r,i,s,o,u){this._wijgrid.mCellStyleFormatter.format(t,r,i,e,s,o,u),this._changeCellRenderState(t,s,!1),this._wijgrid._onViewCellRendered(t,n,e,r,i),i._cellRendered(t,n,e)},r.prototype._rowRendered=function(e,t,n){this._wijgrid.mRowStyleFormatter.format(e,t,n),e.state&=-2,this._setRowInfo(e.$rows,e),this._wijgrid._onViewRowRendered(e,t,n)},r.prototype._makeRowEditable=function(r){var i=this._wijgrid._visibleLeaves(),s=new e.grid.cellEditorHelper;if(i)for(var o=0;o<i.length;o++){var u=i[o];if(u instanceof t.c1field&&!u.options.readOnly){var a=this.getAbsoluteRowIndex(r.$rows[0]),f=this.getCell(o,a);if(f){var l=n(f),c=this.getAbsoluteCellInfo(f,!0);this._changeCellRenderState(l,16,s.cellEditStart(this._wijgrid,c,null))}}}},r.prototype._isBodyRow=function(t){var n=e.grid.rowType,r=t.type;return r&2||r===16||r===32||r===128||r===1024},r.prototype._changeRowRenderState=function(e,t,n){n?e.state|=t:e.state&=~t,this._setRowInfo(e.$rows,e)},r.prototype._changeCellRenderState=function(t,n,r){var i=e.grid.dataPrefix,s=this._wijgrid.mDataPrefix,o=i(t,s,"renderState");return r?(n=o|n,i(t,s,"renderState",n)):(n=o&~n,i(t,s,"renderState",n)),n},r.prototype._resetWidth=function(){var e=this,t=this._wijgrid._visibleLeaves();n.each(t,function(t,n){e._setColumnWidth(n,null)}),n.each(this.subTables(),function(e,t){t.element().style.width="100%"})},r.prototype._adjustWidthArray=function(e,t,r,i){var s=this._sumWidthArray(e),o=this._sumWidthArray(t),u=[],a,f=0,l,c,h=!0;if(s<=r){n.extend(!0,u,e);if(s===r||i)return u;a=r-s}else{n.extend(!0,u,t);if(o>=r)return u;a=r-o}return n.each(u,function(e,t){t.real||f++}),f!==0&&(l=Math.floor(a/f),c=a-l*f,n.each(u,function(e,t){t.real||(t.width+=l,h&&(t.width+=c,h=!1))})),u},r.prototype._getColumnWidth=function(r){var i=this._wijgrid._visibleLeaves()[r];if(i instanceof t.c1rowheaderfield)return{width:t.c1rowheaderfield.COLUMN_WIDTH,real:!0};if(i.options._realWidth!==undefined&&i._strictWidthMode())return{width:i.options._realWidth,real:!0,realPercent:e.grid.isPercentage(i.options.width)};var s=0,o=this.getJoinedTables(!0,r),u=o[2];for(var a=0;a<2;a++){var f=o[a];if(f!==null){var l=f.element().rows,c=null,h=l.length;if(h>0){for(var p=h-1;p>=0;p--)if(l[p].cells.length===f.width()){c=l[p];if(c.style.display!=="none")break}if(c){var d=c.cells[u];s=Math.max(s,n(d).outerWidth())}}}}return{width:s,real:!1}},r.prototype._setColumnWidth=function(e,t){var r=this;if(!e||!e._isRendered())return;var i=e.options._visLeavesIdx,s=this.getHeaderCell(i),o=this.getJoinedCols(i),u;t||t===0?(s&&(u=t-this._sizesAdjCache.th,u<0&&(u=0),s.style.width=u+"px"),n.each(o,function(e,n){n&&(u=t-r._sizesAdjCache.col,u<0&&(u=0),n.style.width=u+"px")})):(s&&(s.style.width=""),n.each(o,function(e,t){t&&(t.style.width="")}))},r.prototype._setTableWidth=function(e,t,r,i){var s,o,u=this;n.each(e,function(e,n){n[0].style.tableLayout="fixed",n[0].style.width=t-u._sizesAdjCache.subTable+"px"}),s=e[0].outerWidth(),o=s-t,o!==0&&this._setColumnWidth(i,r-o)},r.prototype._sumWidthArray=function(e,t,r){var i=0,s=this._wijgrid._visibleLeaves();return n.each(e,function(e,n){if(t!==undefined&&r!==undefined&&(e<t||e>r||t>=0&&!s[e]._isRendered()))return!0;i+=n.width}),i},r.prototype._clearBody=function(){n.each(this.subTables(),function(e,t){t.clearSection(2)})},r.prototype._rebuildOffsets=function(){n.each(this.subTables(),function(e,t){t.rebuildOffsets()})},r.prototype._removeBodyRow=function(e,t){typeof t=="undefined"&&(t=!0);var n=this._wijgrid._rows(),r;if(e>=0&&e<(r=n.length())){var i=this._getRowInfo(n.item(e),!1),s=this.getAbsoluteRowIndex(i.$rows[0]);i.$rows.remove();if(t){var o=this.getJoinedTables(!1,s),u;(u=o[0])&&u.removeOffset(o[2]),(u=o[1])&&u.removeOffset(o[2])}}},r.prototype._insertBodyRow=function(t,n,r,i,s){var o=this._wijgrid._leaves(),u=e.grid.rowType,a=this._wijgrid._view(),f=this._wijgrid._rows(),l=f.length(),c=t.isDataRow(),h,p;if(n<0||n>=l||!n&&n!==0)n=l;h=this._insertEmptyRow(t.rowType,t.renderState,n,-1,r,i,s,t.groupByValue,t.extInfo),this._renderRow(h,o,t),p=this.getAbsoluteRowIndex(h.$rows[0]);var d=this.getJoinedTables(!1,p),v;return(v=d[0])&&v.insertOffset(d[2]),(v=d[1])&&v.insertOffset(d[2]),h},r.prototype._setRowInfo=function(t,n){if(!t)return;var r=n.$rows,i=n.data;n.$rows=undefined,n.data=undefined,e.grid.dataPrefix(t,this._wijgrid.mDataPrefix,"rowInfo",n),n.$rows=r,n.data=i},r.prototype._getRowInfo=function(t,r){typeof r=="undefined"&&(r=!0);var i=this._wijgrid,s=t[1]?n(t):n(t[0]),o=e.grid.dataPrefix(s,i.mDataPrefix,"rowInfo");o.$rows=s;if(r&&o.dataItemIndex>=0&&o.type&2)try{o.data=i._getDataItem(o.dataItemIndex)}catch(u){o.data=null}return o},r.prototype._getRowInfoBySketchRowIndex=function(e,t){typeof t=="undefined"&&(t=!0);if(e>=0){var n=this._isRowRendered(e);if(!(n>=0)){var i=this._wijgrid.mSketchTable.row(e),s=null;if(i){s=i.getRowInfo();if(t&&s.dataItemIndex>=0&&i.isDataRow())try{s.data=this._wijgrid._getDataItem(s.dataItemIndex)}catch(o){s.data=null}}return s}var r=this.bodyRows().item(n);if(r)return this._getRowInfo(r,t)}return null},r.prototype._createRowInfo=function(e,t,r,i,s,o,u,a,f,l){var c={type:t,state:r,sectionRowIndex:i,dataRowIndex:s,dataItemIndex:o,virtualDataItemIndex:u,sketchRowIndex:a,$rows:e?n(e):null,_extInfo:l};return f!==undefined&&(c.groupByValue=f),o>=0&&t&2&&(c.data=this._wijgrid._getDataItem(o)),c},r.prototype._isRowRendered=function(e){var t=this._wijgrid._renderableRowsRange().getRenderedIndex(e);return t>=0&&t>=this._bounds.start&&t<=this._bounds.end?t-this._bounds.start:-1},r}();t.baseView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(t){function r(e,n){t.call(this,e,n),this._dataTable=null,this._contentArea=null}return __extends(r,t),r.prototype.getVisibleAreaBounds=function(t){var n=e.grid.bounds(this._dataTable.element(),t);return n},r.prototype.getVisibleContentAreaBounds=function(){return this.getVisibleAreaBounds()},r.prototype.updateSplits=function(e,t){var r=this,i=this,s=this._wijgrid,o=s.options,u=s.element,a=[],f=[],l=[],c=s._visibleLeaves(),h=s.mOuterDiv,p,d;u.css({"table-layout":"",width:"auto"}),n.each(c,function(e,t){t.options._realWidth!==undefined&&r._setColumnWidth(t,t.options._realWidth),a.push(r._getColumnWidth(e))}),u.css("width","1px"),n.each(c,function(e,t){f.push(i._getColumnWidth(e))}),p=h.width(),l=this._adjustWidthArray(a,f,p,o.ensureColumnsPxWidth),n.each(l,function(e,t){var n=c[e];if(n.options._realWidth!==undefined&&n._strictWidthMode())return;i._setColumnWidth(n,t.width)}),u.css("table-layout","fixed"),d=l.length-1;if(d!==-1){var v=h.width()-p;l[d].width+=v,this._setTableWidth([u],this._sumWidthArray(l,0,d),l[d].width,c[d])}},r.prototype.getInlineTotalWidth=function(){var e=this._dataTable.element(),t=e.style.width;return t&&t!=="auto"?t:""},r.prototype.forEachColumnCell=function(e,t,n){return this._dataTable.forEachColumnCell(e,t,n)},r.prototype.forEachRowCell=function(e,t,n){return this._dataTable.forEachRowCell(e,t,n)},r.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getColumnIndex(t),t.parentNode.rowIndex,this._wijgrid,!0,n)},r.prototype.getAbsoluteCellIndex=function(e){return this.getColumnIndex(e)},r.prototype.getAbsoluteRowIndex=function(e){return e.rowIndex},r.prototype.getCell=function(e,t){var n=this._dataTable.getCellIdx(e,t),r;if(n>=0){r=this.getJoinedRows(t,0);if(r[0])return r[0].cells[n]}return null},r.prototype.getColumnIndex=function(e){return this._dataTable.getColumnIdx(e)},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._visibleLeaves()[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.options._thY),n.options._thX):null},r.prototype.getJoinedCols=function(e){var t=n(this._dataTable.element()).find("> colgroup");return t.length&&e<t[0].childNodes.length?[t[0].childNodes[e],null]:[null,null]},r.prototype.getJoinedRows=function(e,t){return[this._dataTable.getSectionRow(e,t),null]},r.prototype.getJoinedTables=function(e,t){return[this._dataTable,null,t]},r.prototype.subTables=function(){return[this._dataTable]},r.prototype._preRender=function(){t.prototype._preRender.call(this),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0],!0,!0,!0)},r.prototype._postRender=function(){this._wijgrid.element.find("> tbody").addClass(this._wijgrid.options.wijCSS.content),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0]),this._wijgrid._setAttr(this._wijgrid.element,{role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}),this._wijgrid.element.css("border-collapse","separate"),t.prototype._postRender.call(this)},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s;switch(t){case 1:case 8:s=this._dataTable.ensureTHead();break;case 64:s=this._dataTable.ensureTFoot();break;default:s=this._dataTable.ensureTBody()}return r?[s.appendChild(r)]:(n>s.rows.length&&(n=-1),[s.insertRow(n)])},r.prototype._rowRendered=function(e,n,r){var i=e.$rows[0];!i.cells.length&&this._isBodyRow(e)?i.parentNode.removeChild(i):t.prototype._rowRendered.call(this,e,n,r)},r.prototype._appendCell=function(e,t,n){e.$rows[0].appendChild(n[0])},r.prototype._createCol=function(e,t){return[document.createElement("col")]},r.prototype._appendCol=function(e,t,n){this._dataTable.appendCol(e[0])},r}(t.baseView);t.flatView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=function(r){function i(t,i){r.call(this,t,i),this._verScrollBarSize=e.grid.getSuperPanelScrollBarSize(),this._viewTables={},this._splitAreas={},this._superPanelElementsCache={},this.mHVSOffset=0,this.mRowsHeights=[],this.element=t.element,this._staticDataRowIndex=t._getStaticIndex(!0),this._staticRowIndex=t._getRealStaticRowIndex(),this._staticColumnIndex=t._getRealStaticColumnIndex(),this._staticAllColumnIndex=this._staticColumnIndex===-1?-1:t._visibleLeaves()[this._staticColumnIndex].options._leavesIdx,this._mouseWheelHandler=n.proxy(this._onMouseWheel,this)}return __extends(i,r),i.prototype.dispose=function(){r.prototype.dispose.call(this),this.element.css({width:"",height:""}),this._wijgrid.mOuterDiv.unbind("mousewheel",this._mouseWheelHandler)},i.prototype.render=function(e){e||this.resetRowsHeightsCache(),r.prototype.render.apply(this,arguments)},i.prototype._resetWidth=function(){this._getSuperPanelContentWrapper().width(""),r.prototype._resetWidth.apply(this,arguments)},i.prototype.resetRowsHeightsCache=function(){this.mRowsHeights=[]},i.prototype.ensureHeight=function(e){var t=this._wijgrid,r=n(this._viewTables.nw.element()),i=n(this._viewTables.ne.element()),s=n(this._viewTables.sw.element()),o=n(this._viewTables.se.element()),u=this.getScrollValue();this._destroySuperPanel(),o.css("height",""),s.css("height","");if(arguments.length>0){var a=this.getJoinedRows(e,2);this._setRowHeight(a,this._getRowHeight(a))}var f=Math.max(o.height(),s.height());o.height(f),s.height(f);try{this._staticRowIndex>=0?t.mSplitDistanceY=Math.max(r[0].offsetHeight,i[0].offsetHeight):t.mSplitDistanceY=0}catch(l){}this._updateSplitAreaBounds(1),this._refreshPanel(u),t._UIFrozener().refresh()},i.prototype.getScrollValue=function(){var e=this._getSuperPanel();return e?{x:e.options.hScroller.scrollValue,y:e.options.vScroller.scrollValue}:null},i.prototype.getVisibleAreaBounds=function(t){var n=this._isNativeSuperPanel()?e.grid.bounds(this._getSuperPanelStateContainer(),t):e.grid.bounds(this._getSuperPanelContentWrapper(),t);return n||(n=e.grid.bounds(this._wijgrid.mOuterDiv,t)),n},i.prototype.getVisibleContentAreaBounds=function(){var t=this.getVisibleAreaBounds(!0),n=e.grid.bounds(this._viewTables.nw.element())||{},r=e.grid.bounds(this._viewTables.ne.element())||{},i=e.grid.bounds(this._viewTables.sw.element())||{},s=e.grid.bounds(this._viewTables.se.element())||{},o={top:t.top,left:t.left,width:Math.max(n.width+r.width,i.width+s.width),height:Math.max(n.height+i.height,r.height+s.height)};return o.width=Math.min(t.width,o.width),o.height=Math.min(t.height,o.height),o},i.prototype._getRowAreaHeight=function(){var e=this._getSuperPanelContentWrapper();e.length==0&&(e=this._wijgrid.mOuterDiv);var t=e.height(),r=this._wijgrid.mSplitDistanceY;r&&(t-=r);if(this._wijgrid.options.showFooter){var i,s=this.isRendered()&&(i=this.footerRow())?n(i).height():this.getDefaultRowHeight();t-=s}return t},i.prototype.getVirtualPageSize=function(e){typeof e=="undefined"&&(e=!0);var t=this._wijgrid.mRowOuterHeight&&this._wijgrid.mRowOuterHeight>0?this._wijgrid.mRowOuterHeight:this.getDefaultRowHeight(),n=this._getRowAreaHeight()/t;return e?Math.ceil(n):Math.floor(n)},i.prototype.getFixedAreaVisibleBounds=function(){var t=this.getVisibleAreaBounds(),n=e.grid.bounds(this._splitAreas.ne),r=e.grid.bounds(this._splitAreas.nw),i=null,s=null;if(n.height||r.height)i={left:t.left,top:t.top,width:t.width,height:Math.min(n.height||r.height,t.height)};return r.width&&(s={left:r.left,top:t.top,width:Math.min(r.width,t.width),height:t.height}),[i,s]},i.prototype.getDefaultRowHeight=function(){return this._wijgrid._lgGetRowHeight()},i.prototype._refreshPanel=function(t){var r=this,i=this._wijgrid,s=i.options,o=this._getMappedScrollMode(),u=i._rows().item(0),a=!1,f=e.grid.wijgrid.CSS,l,c;i.mRowOuterHeight=u&&u[0]?n(u[0]).outerHeight():this.getDefaultRowHeight(),this.mHVSOffset&&this.mHVSOffset>0&&(l=n(this._viewTables.ne.element()).closest("."+f.scrollableContent)[0],c=n(this._viewTables.se.element()).closest("."+f.scrollableContent)[0],l.style.marginLeft="",c.style.marginLeft="");if(!this._scroller.data("wijmo-wijsuperpanel")){a=!0,this._wijgrid._allowVirtualScrolling()&&(this.vsUI=new e.grid.uiVirtualScroller(i,this._splitAreas.se,i.mSplitDistanceY,i.mRowOuterHeight)),t&&o.hScrollBarVisibility==="hidden"&&(t.x=0),this._scroller.wijsuperpanel({disabled:i.options.disabled,scroll:n.proxy(this._onScroll,this),bubbleScrollingEvent:!0,customScrolling:this._wijgrid._allowVVirtualScrolling(),vScroller:{scrollBarVisibility:o.vScrollBarVisibility,scrollValue:t?t.y:null},hScroller:{scrollBarVisibility:o.hScrollBarVisibility,scrollValue:t?t.x:null},hScrollerActivating:n.proxy(this._onHScrollerActivating,this),animationOptions:this._wijgrid._allowHVirtualScrolling()?{disabled:!0}:undefined});if(this._isNativeSuperPanel()){var h=this._getSuperPanelStateContainer();h.length&&h[0].offsetHeight!==h[0].clientHeight&&this._onHScrollerActivating(null,{contentLength:h[0].clientHeight})}this._isNativeSuperPanel()||this._getSuperPanelContentWrapper().bind("scroll",function(e){e.target.scrollLeft=0,e.target.scrollTop=0,e.preventDefault()}),this._wijgrid._allowVirtualScrolling()&&this.vsUI.attach(this._scroller)}else this._scroller.wijsuperpanel("paintPanel");if(!this._wijgrid._allowVirtualScrolling()){var p=this._splitAreas.se.find("table").find("tr").length,d=this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer").height(),v=this._splitAreas.ne.height(),m=i.mRowOuterHeight,g=(i.mBottomPagerDiv?i.mBottomPagerDiv.outerHeight():0)+(i.mTopPagerDiv?i.mTopPagerDiv.outerHeight():0),y=(this._scroller.height()-v-d-g)/m,b=Math.floor(y),w=Math.floor(b/2),E=this._scroller.wijsuperpanel("option","vScroller");E.scrollLargeChange=b,E.scrollSmallChange=w,E.scrollMax=p,n.browser.msie&&this._scroller.wijsuperpanel("option","keyDownInterval",Math.max(p/5,100))}var S=this._testNeedVBar(i.mOuterDiv,i.element,n(this._viewTables.ne.element()),i._lgGetScrollMode(),i.mAutoHeight),x=S&&!this._testAutohiddenScrollbars(),T=this.getVisibleContentAreaBounds().width;this._splitAreas.ne.width(T-i.mSplitDistanceX);if(a&&t&&t.x&&this._wijgrid.element.is(":visible")){var N=this._scroller.wijsuperpanel("scrollValueToPx",t.x,"h");this._setFixedAreaPosition(this._splitAreas.ne,"h",N,null,!0)}i._lgGetStaticColumnsAlignment()==="right"&&(this._splitAreas.nw.css({left:"",right:x?this._verScrollBarSize:0}),this._splitAreas.sw.css({left:"",right:x?this._verScrollBarSize:0})),this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5),this._wijgrid._allowVVirtualScrolling()&&this._wijgrid._handleVerticalVirtualScrolling(this._bounds.start),l&&c&&(l.style.marginLeft=this.mHVSOffset+"px",c.style.marginLeft=this.mHVSOffset+"px")},i.prototype._getLeftOffset=function(e){var t=0,n=this._wijgrid._leaves();for(var r=0;r<n.length;r++){var i=n[r];if(e.options._leavesIdx<=i.options._visLeavesIdx)break;i._visible()&&(t+=i.options._realWidth)}return t},i.prototype.scrollTo=function(e,t,r){var i=this._wijgrid,s=null,o=null;if(i._allowVVirtualScrolling()){var u=i._renderableRowsRange().getRenderedIndex(e.rowIndex()),a,f=i._rows().length(),l,c=u-i._viewPortBounds().start>=f-1;if(!e._isRowRendered()||c&&(a=this.getVisibleAreaBounds(!0))&&(l=e.row().$rows)&&l.offset().top+l.outerHeight()>a.top+a.height)s=u,e.rowIndex()>r.changingEventArgs.oldRowIndex&&(s-=f-1,s+=1)}i._allowHVirtualScrolling()&&!e._isRendered()&&(o=e.columnInst());var h=this._getSuperPanel();if(s!==null||o)r.setFocus=!0,r.hasFocusedChild=!1;if(s!==null)h?this.vsUI.scrollToRow(s,function(){t()}):t();else{var p=o?null:n(e.tableCell()),d=null,v=null;if(h&&(o||p.is(":visible"))){var m=h.getContentElement(),g=m.parent(),y,b,w=i._getStaticIndex(!0),E=i._getStaticIndex(!1),S=e.rowIndex(),x=e.cellIndex();if(this._isNativeSuperPanel())o?y={left:this._getLeftOffset(o),top:0,height:0,width:o.options._realWidth}:y={left:p[0].offsetLeft,top:p[0].offsetTop,height:p.outerHeight(),width:p.outerWidth()},b={left:g[0].scrollLeft,top:g[0].scrollTop,height:g[0].clientHeight-i.mSplitDistanceY,width:g[0].clientWidth-i.mSplitDistanceX};else{if(o)y={left:this._getLeftOffset(o),top:0,height:0,width:o.options._realWidth};else{var T=p.position();y={left:i._allowHVirtualScrolling()?this._getLeftOffset(e.columnInst()):T.left,top:T.top,height:p.outerHeight(),width:p.outerWidth()}}b={left:-(parseInt((m.css("left")+"").replace("px",""),10)||0),top:-(parseInt((m.css("top")+"").replace("px",""),10)||0),height:g.outerHeight()-i.mSplitDistanceY,width:g.outerWidth()-i.mSplitDistanceX}}S<=w?x<=E?(d=null,v=null):(y.left+=b.left,y.left+y.width>b.left+b.width&&(b.left=d=y.left+y.width-b.width),y.left<b.left&&(d=y.left),v=null):x<=E?(y.top+=this._splitAreas.sw.scrollTop(),y.top+y.height>b.top+b.height&&(b.top=v=y.top+y.height-b.height),y.top<b.top&&(v=y.top),d=null):(y.left-=i.mSplitDistanceX,y.top+y.height>b.top+b.height&&(b.top=v=y.top+y.height-b.height),y.left+y.width>b.left+b.width&&(b.left=d=y.left+y.width-b.width),y.top<b.top&&(v=y.top),y.left<b.left&&(d=y.left));if(d!==null){v=null;if(o){this.vsUI.scrollToColumn(o,d,function(){t()});return}h.hScrollTo(d)}v!==null&&h.vScrollTo(v)}t()}},i.prototype.updateSplits=function(t,r){var i=this,s=this._wijgrid,o=[],u=[],a=s._visibleLeaves(),f=n(this._viewTables.se.element()),l=n(this._viewTables.ne.element()),c=n(this._viewTables.sw.element()),h=n(this._viewTables.nw.element()),p=s.mOuterDiv,d=!1,v=this._strictWidthMode(),m=this.isLiveUpdate(),g=e.grid.wijgrid.CSS;m||(this._destroySuperPanel(),p.unbind("mousewheel",this._mouseWheelHandler),this._clearNorthTablesHeight());var y=f[0].tBodies&&f[0].tBodies[0];if(y){for(var b=0;b<y.rows.length;b++)if(!n(y.rows[b]).hasClass(e.grid.wijgrid.CSS.groupHeaderRow)){d=!0;break}d||s.element.css("width","100%")}n.each([f,l,c,h],function(e,t){t.css({"table-layout":"",width:""})}),n.each(a,function(e,t){t.options._realWidth!==undefined&&i._setColumnWidth(t,t.options._realWidth),u.push(i._getColumnWidth(e))}),n.each([f,l,c,h],function(e,t){t.css({width:"1px"})}),n.each(a,function(e,t){o.push(i._getColumnWidth(e))});var w=p.width(),E=this._adjustWidthArray(u,o,w,v);this._setResultWidth(E,w,r);if(this._testNeedVBar(s.mOuterDiv,f,l,s._lgGetScrollMode(),s.mAutoHeight)){var S=!1;w-=this._verScrollBarSize,v?n.each(a,function(t,n){var r=n.options;e.grid.isPercentage(r.width)&&(u[t].width=o[t].width=w*parseFloat(r.width)/100,S=!0)}):S=!0,S&&(E=this._adjustWidthArray(u,o,w,v),this._setResultWidth(E,w,r))}this._setNorthTablesHeight();if(this._wijgrid._allowHVirtualScrolling()){var x=this._sumWidthArray(E);l.closest("."+g.scrollableContent).width(x-s.mSplitDistanceX),f.closest("."+g.scrollableContent).width(x-s.mSplitDistanceX)}m||(this._refreshPanel(t),p.bind("mousewheel",n.proxy(this._mouseWheelHandler,this))),this.mResultWidths=E},i.prototype.updateSplitsLive=function(){var e=this,t=this._wijgrid._leaves(),r=this._wijgrid._visibleLeaves(),i=0;this.currentRenderableColumns().forEachIndex(function(n){var r=t[n];if(r._isRendered()){var s=e.mResultWidths[r.options._visLeavesIdx].width;e._setColumnWidth(r,s),i+=s}});var s=n(this._viewTables.ne.element()),o=n(this._viewTables.se.element()),u=this.mResultWidths.length-1;this._setTableWidth([s,o],i,this.mResultWidths[u].width,r[u])},i.prototype._setResultWidth=function(e,t,r){var i=this,s=this._wijgrid,o=s._visibleLeaves(),u=this._staticColumnIndex,a=this._strictWidthMode(),f,l,c=n(this._viewTables.se.element()),h=n(this._viewTables.ne.element()),p=n(this._viewTables.sw.element()),d=n(this._viewTables.nw.element()),v=this.isLiveUpdate();n.each(e,function(e,t){(!t.real||t.realPercent)&&i._setColumnWidth(o[e],t.width)}),(f=u)>=0&&(l=this._sumWidthArray(e,0,f),this._setTableWidth([d,p],l,e[f].width,o[f]));if(!v){try{s.mSplitDistanceX=u>=0?d[0].offsetWidth:0}catch(m){}this._updateSplitAreaBounds(0)}a||this._splitAreas.ne.width(t-s.mSplitDistanceX),(f=e.length-1)>=0&&(l=this._sumWidthArray(e,u+1,f),this._setTableWidth([h,c],l,e[f].width,o[f]));if(!v){this._adjustRowsHeights(r);try{s.mSplitDistanceY=this._staticRowIndex>=0?Math.max(d[0].offsetHeight,h[0].offsetHeight):0}catch(m){}this._updateSplitAreaBounds(1)}},i.prototype.getInlineTotalWidth=function(){if(this._scroller){var e=this._getSuperPanelStateContainer();if(e.length){var t=e[0].style.width;if(t&&t!=="auto")return t}}return""},i.prototype._clearBody=function(){r.prototype._clearBody.call(this)},i.prototype.bodyRows=function(){var e=r.prototype.bodyRows.call(this);return e},i.prototype.forEachColumnCell=function(e,t,n){var r=this.getJoinedTables(!0,e),i,s;if(r[0]!==null){i=r[2],s=r[0].forEachColumnCell(i,t,n);if(s!==!0)return s;if(r[1]!==null){s=r[1].forEachColumnCell(i,t,n);if(s!==!0)return s}}return!0},i.prototype.forEachRowCell=function(e,t,n){var r=this.getJoinedTables(!1,e),i=r[0],s=r[1],o,u;if(i!==null){o=r[2];if(o<i.element().rows.length){u=i.forEachRowCell(o,t,n);if(u!==!0)return u}if(s!==null&&o<s.element().rows.length){u=s.forEachRowCell(o,t,n);if(u!==!0)return u}}return!0},i.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getAbsoluteCellIndex(t),this.getAbsoluteRowIndex(t.parentNode),this._wijgrid,!0,n)},i.prototype.getAbsoluteCellIndex=function(e){var t=e.cellIndex,n=e.parentNode;while(n&&n.tagName&&n.tagName.toLowerCase()!=="table")n=n.parentNode;return n===this._viewTables.se.element()?(t=this._viewTables.se.getColumnIdx(e)+this._staticColumnIndex+1,t):n===this._viewTables.sw.element()?(t=this._viewTables.sw.getColumnIdx(e),t):n===this._viewTables.ne.element()?(t=this._viewTables.ne.getColumnIdx(e)+this._staticColumnIndex+1,t):n===this._viewTables.nw.element()?(t=this._viewTables.nw.getColumnIdx(e),t):t},i.prototype.getAbsoluteRowIndex=function(e){var t=e.rowIndex,n=e.parentNode;while(n&&n.tagName&&n.tagName.toLowerCase()!=="table")n=n.parentNode;return n===this._viewTables.nw.element()||n===this._viewTables.ne.element()?t:t+this._staticRowIndex+1},i.prototype.getCell=function(e,t){var n=this.getJoinedTables(!1,t),r,i,s,o,u;if(n[0]!==null){r=this.getJoinedTables(!0,e);if(r[0]!==null){i=n[2],s=r[2],o=null,n[1]!==null?o=e===s?n[0]:n[1]:o=n[0],u=o.getCellIdx(s,i);if(u>=0)return o.element().rows[i].cells[u]}}return null},i.prototype.getColumnIndex=function(e){var t=null,n=null,r=!1,i;for(t=e.parentNode;t.tagName.toLowerCase()!=="table";t=t.parentNode);if(t!==null){t===this._viewTables.nw.element()?n=this._viewTables.nw:t===this._viewTables.ne.element()?(n=this._viewTables.ne,r=!0):t===this._viewTables.sw.element()?n=this._viewTables.sw:t===this._viewTables.se.element()&&(n=this._viewTables.se,r=!0);if(n!==null)return i=n.getColumnIdx(e),r&&(i+=this._staticColumnIndex+1),this._wijgrid._renderedLeaves()[i].options._visLeavesIdx}return-1},i.prototype.getHeaderCell=function(t){var n=this._wijgrid._visibleLeaves()[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.options._thY),n.options._thX):null},i.prototype.getJoinedCols=function(e){var t=this._wijgrid._visibleLeaves()[e],r=[],i=this.getJoinedTables(!0,t.options._renderedIndex),s=i[2];return i.splice(i.length-1,1),n.each(i,function(e,t){r.push(t?n(t.element()).find("col")[s]:null)}),r},i.prototype.getJoinedRows=function(e,t){var n=null,r=null,i=null,s=null,o=this._staticRowIndex,u=this._staticColumnIndex,a=this._wijgrid._visibleLeaves().length-1,f=this._rowsCountRaw()-1,l=o===f,c=o<0,h=!l&&!c,p=0;if(l||h)u>=0&&u<a?(i=this._viewTables.nw,s=this._viewTables.ne):i=u<0?this._viewTables.ne:this._viewTables.nw,p=i.getSectionLength(t),e<p&&(n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t)));if(c||h&&n===null)c||(e-=p),u>=0&&u<a?(i=this._viewTables.sw,s=this._viewTables.se):i=u<0?this._viewTables.se:this._viewTables.sw,n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t));return n===null&&r===null?null:[n,r]},i.prototype.getJoinedTables=function(e,t){var n=null,r=null,i=t,s=this._wijgrid,o=this._staticRowIndex,u=this._staticColumnIndex;return e?(t<=u?(n=this._viewTables.nw,r=this._viewTables.sw):(n=this._viewTables.ne,r=this._viewTables.se,i-=u+1),o<0&&(n=null),o===this._rowsCountRaw()-1&&(r=null)):(t<=o?(n=this._viewTables.nw,r=this._viewTables.ne):(n=this._viewTables.sw,r=this._viewTables.se,i-=o+1),u<0&&(n=null),u===s._leaves().length-1&&(r=null)),n===null&&(n=r,r=null),[n,r,i]},i.prototype.subTables=function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},i.prototype._getSuperPanel=function(){return this._scroller?this._scroller.data("wijmo-wijsuperpanel"):null},i.prototype._ensureRenderHBounds=function(){if(this._wijgrid._allowHVirtualScrolling()){var e=this._wijgrid._renderableColumnsRange();this.mHVSOffset=this._getRenderableColumnsBounds(e,this._wijgrid.mScrollingState.scrollLeft);if(this.isLiveUpdate()){var n=new t.renderableColumnsCollection;n.add(e.item(1)),this.currentRenderableColumns(n)}else this.currentRenderableColumns(e)}else r.prototype._ensureRenderHBounds.call(this)},i.prototype._getRenderableColumnsBounds=function(e,t){var n=this._staticAllColumnIndex,r={start:-1,end:-1},i={start:-1,end:-1};e.clear(),e.add(r),e.add(i),n>=0&&(r.start=0,r.end=n);var s=this._wijgrid._leaves(),o=!1,u=0,a=this.getVisibleAreaBounds(!0).width,f=0;if(n>=0)for(var l=0;l<=n;l++){var c=s[l];c._visible()&&(a-=c.options._realWidth)}for(var l=n+1;l<s.length;l++){var c=s[l];if(c._visible()){var h=s[l].options._realWidth;f+=h,f<=t&&(u=f);if(!o)f-t>0&&(i.start=l,o=!0);else{i.end=l;if(f-t>=a)break}}}return i.end<i.start&&(i.end=i.start),u},i.prototype._ensureRenderBounds=function(){if(this._wijgrid._allowVVirtualScrolling()){var e=this.getVirtualPageSize(),t=this._bounds;this._wijgrid._ensureRenderableBounds(t),t.end=t.start+e-1;if(this._wijgrid._serverSideVirtualScrolling()){var n=t.end-t.start+1-this._wijgrid.mSketchTable.count();n>0&&(t.end-=n)}else if(this._wijgrid.mRenderCounter==0)t.end=t.start;else{this._wijgrid._ensureRenderableBounds(t),this._isLastItemRendered()&&(e=this.getVirtualPageSize(!1));var i=Math.max(Math.min(this._wijgrid._renderableRowsCount(),e),0),n=i-(t.end-t.start+1);n>0&&(t.start=t.start-n)}this._wijgrid._ensureRenderableBounds(t),this._isLastItemRendered()&&(this._canRenderMoreItems()&&(e=this.getVirtualPageSize(!1),t.start=t.end-e+1),this._wijgrid._ensureRenderableBounds(t),t.start!==this._wijgrid.mScrollingState.index&&(this._wijgrid.mScrollingState.index=this._wijgrid.mScrollingState.y=t.start))}else r.prototype._ensureRenderBounds.call(this)},i.prototype._isLastItemRendered=function(){return this._bounds.start>0&&this._bounds.end===this._wijgrid.mSketchTable.count()-1},i.prototype._canRenderMoreItems=function(){var e=this.getVirtualPageSize(!1),t=this._bounds.end-this._bounds.start+1;return t<e},i.prototype._preRender=function(){r.prototype._preRender.call(this);var t=e.grid.wijgrid.CSS;if(this.isLiveUpdate())this._viewTables.ne.clearContent(),this._viewTables.se.clearContent(),n(this._viewTables.ne.element()).closest("."+t.scrollableContent)[0].style.marginLeft=this.mHVSOffset+"px",n(this._viewTables.se.element()).closest("."+t.scrollableContent)[0].style.marginLeft=this.mHVSOffset+"px";else{var i=document.createDocumentFragment(),s=e.grid.htmlTableAccessor,o=this._wijgrid.options.wijCSS;this._wijgrid.mOuterDiv.wrapInner('<div class="'+t.fixedView+" "+o.wijgridFixedView+'"><div class="'+t.scroller+" "+o.wijgridScroller+'"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>'),this._scroller=this._wijgrid.mOuterDiv.find("."+t.scroller),this._scroller.css("padding",0),this._scroller.after(this._splitAreas.nw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.ne=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.sw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first"),this._viewTables={nw:new s(i.appendChild(document.createElement("table")),!0,!0,!0),ne:new s(i.appendChild(document.createElement("table")),!0,!0,!0),sw:new s(i.appendChild(document.createElement("table")),!0,!0,!0),se:new s(i.appendChild(this._wijgrid.element[0]),!0,!0,!0)};var u=this._viewTables,a=u.sw.element(),f=u.se.element(),l=u.nw.element(),c=u.ne.element(),h=this._wijgrid._allowHVirtualScrolling(),t=e.grid.wijgrid.CSS;this._splitAreas.nw.empty().append(l),h?this._splitAreas.ne.empty().append(n('<div class="'+t.scrollableContent+'"></div>').append(c)):this._splitAreas.ne.empty().append(c),this._splitAreas.sw.empty().append(a),h?this._splitAreas.se.empty().append(n('<div class="'+t.scrollableContent+'"></div>').append(f)):this._splitAreas.se.empty().append(f)}},i.prototype._postRender=function(){var t=this._viewTables.sw.element(),i=this._viewTables.se.element(),s=t.rows,o=i.rows;if(!this.isLiveUpdate()){var u=this._viewTables.nw.element(),a=this._viewTables.ne.element(),f=e.grid.htmlTableAccessor,l=this._wijgrid._allowHVirtualScrolling(),c=e.grid.wijgrid.CSS,h=this;this._viewTables={nw:new f(u),ne:new f(a),sw:new f(t),se:new f(i)},n.each(this._viewTables,function(t,r){var i=n(r.element());h._wijgrid._setAttr(i,{role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}),i.addClass(e.grid.wijgrid.CSS.table).addClass(h._wijgrid.options.wijCSS.wijgridTable).css("border-collapse","separate").find("> tbody").addClass(h._wijgrid.options.wijCSS.content)}),this._setNorthTablesHeight()}else this._rebuildOffsets();s!=null&&o!=null&&s.length>0&&o.length>0&&s[0].offsetHeight!==o[0].offsetHeight&&this._adjustRowsHeights(),r.prototype._postRender.call(this)},i.prototype._setNorthTablesHeight=function(){n(this._viewTables.ne.element()).height("100%"),n(this._viewTables.nw.element()).height("100%")},i.prototype._clearNorthTablesHeight=function(e){typeof e=="undefined"&&(e=!1);var t=n([this._viewTables.ne.element(),this._viewTables.nw.element()]);t.height(""),e&&t.find("> thead > tr").height("")},i.prototype._rowsCountRaw=function(){var e=this._viewTables.nw.element(),t=this._viewTables.ne.element(),n=this._viewTables.sw.element(),r=this._viewTables.se.element(),i;return i=Math.max(e.rows.length,t.rows.length)+Math.max(n.rows.length,r.rows.length),i},i.prototype._createCol=function(e,t){return[document.createElement("col"),document.createElement("col")]},i.prototype._appendCol=function(e,t,n){n<=this._staticColumnIndex?(this._viewTables.nw.appendCol(e[0]),this._viewTables.sw.appendCol(e[1])):(this._viewTables.ne.appendCol(e[0]),this._viewTables.se.appendCol(e[1]))},i.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s,o,u=this._viewTables;switch(t){case 1:case 8:s=u.nw.ensureTHead(),o=u.ne.ensureTHead();break;case 64:s=u.sw.ensureTFoot(),o=u.se.ensureTFoot();break;default:n<=this._staticDataRowIndex?(s=u.nw.ensureTBody(),o=u.ne.ensureTBody()):(n-=this._staticDataRowIndex+1,s=u.sw.ensureTBody(),o=u.se.ensureTBody())}return r?[s.appendChild(r),o.appendChild(r.cloneNode(!1))]:[s.insertRow(n>s.rows.length?-1:n),o.insertRow(n>o.rows.length?-1:n)]},i.prototype._rowRendered=function(e,t,i){var s=e.$rows[0],o=e.$rows[1],u=this.isLiveUpdate();!s.cells.length&&(this._isBodyRow(e)||u)&&(s.parentNode.removeChild(s),s=null),!o.cells.length&&this._isBodyRow(e)&&(o.parentNode.removeChild(o),o=null);if(s||o){if(!s||!o)e.$rows=s?n(s):n(o);if(this.mRowsHeights.length){var a=e.sectionRowIndex;e.type===64?a=this.mRowsHeights.length-1:e.type!==1&&e.type!==8&&(a+=this._wijgrid._columnsHeadersTable().length,a+=this._wijgrid.options.showFilter?1:0),this.mRowsHeights[a]&&this._setRowHeight(e.$rows,this.mRowsHeights[a])}r.prototype._rowRendered.call(this,e,t,i)}},i.prototype._appendCell=function(e,t,n){t<=this._staticAllColumnIndex?e.$rows[0].appendChild(n[0]):e.$rows[1].appendChild(n[0])},i.prototype._getRowHeight=function(e,t){if(e[0]&&e[1]){var r=e[0],i=e[1],s=n(r),o=n(i),u,a,f,l=function(e){var t,r=e[0],i;for(t=0;t<r.cells.length;t++){i=r.cells[t];if(!i.rowSpan||i.rowSpan===1)return n(i).outerHeight()}return e.height()};return(f=n.data(r,"customHeight"))?u=a=parseInt(f):(s.css("height",""),o.css("height",""),t?(u=l(s),a=l(o)):(u=s.height(),a=o.height())),Math.max(u,a)}return null},i.prototype._setRowHeight=function(t,r){var i=this.isLiveUpdate();if(t[0]&&(r||r===0))if(t[1]||i){var s=e.grid.rowObjToJQuery(t);r+=1;for(var o=0;o<s.length;o++){var u=n(s[o]);u.height(r);if(!i){var a=r-u.height();a&&u.height(r+a)}}}},i.prototype._adjustRowHeight=function(e){var t=this._wijgrid,n=this._staticColumnIndex,r=t._visibleLeaves().length-1;this.resetRowsHeightsCache();if(n>-1&&n<r){var i=this._viewTables.ne.element(),s=i.parentNode,o,u=this._viewTables.nw.element(),a=u.parentNode,f=this._viewTables.se.element(),l=f.parentNode,c=this._viewTables.sw.element(),h=c.parentNode,p,d,v=this._staticRowIndex,m=this._rowsCountRaw()-1,g=Math.max(Math.max(i.rows.length,f.rows.length),Math.max(u.rows.length,c.rows.length));e&&e.r2-e.r1+1>g*.9&&(e=null);if(e)for(y=e.r1;y<=e.r2;y++)this.mRowsHeights.push(this._getRowHeight(this.getJoinedRows(y,2)));else{if(v>-1&&v<=m){p=u.rows,d=i.rows;for(var y=0,b=p.length;y<b;y++)this.mRowsHeights.push(this._getRowHeight([p[y],d[y]],!0))}if(v>=-1&&v<m){p=c.rows,d=f.rows;for(var y=0,b=p.length;y<b;y++)this.mRowsHeights.push(this._getRowHeight([p[y],d[y]]))}}v>-1&&v<=m&&(a.removeChild(u),o=s.scrollLeft,s.style.visibility="hidden",s.removeChild(i)),v>=-1&&v<m&&(h.removeChild(c),l.removeChild(f));if(e){var w=0;for(var y=e.r1;y<=e.r2;y++,w++)this._setRowHeight(this.getJoinedRows(y,2),this.mRowsHeights[w])}else{var w=0;if(v>-1&&v<=m){p=u.rows,d=i.rows;for(var y=0,b=p.length,w=0;y<b;y++,w++)this._setRowHeight([p[y],d[y]],this.mRowsHeights[w])}if(v>=-1&&v<m){p=c.rows,d=f.rows;for(var y=0,b=p.length;y<b;y++)this._setRowHeight([p[y],d[y]],this.mRowsHeights[w++])}}v>-1&&v<=m&&(a.appendChild(u),s.appendChild(i),o&&(s.scrollLeft=o),s.style.visibility="visible"),v>=-1&&v<m&&(h.appendChild(c),l.appendChild(f))}},i.prototype._adjustRowsHeights=function(e){var t=n(this._viewTables.sw.element()),r=n(this._viewTables.se.element()),i;r.css("height",""),t.css("height",""),this._adjustRowHeight(e),i=Math.max(r.height(),t.height()),t.height(i),r.height(i)},i.prototype._destroySuperPanel=function(){this._scroller.data("wijmo-wijsuperpanel")&&(this.vsUI&&this.vsUI.dispose(),this._superPanelElementsCache={},this._scroller.wijsuperpanel("destroy"))},i.prototype._onScroll=function(e,t){var n=this._getSuperPanel();this._wijgrid._allowVVirtualScrolling()?t.dir==="h"&&(this._setFixedAreaPosition(n.getContentElement(),t.dir,t.position,t.animationOptions,!1),this._setFixedAreaPosition(this._splitAreas.ne,t.dir,t.position,t.animationOptions,!0)):this._setFixedAreaPosition(t.dir==="h"?this._splitAreas.ne:this._splitAreas.sw,t.dir,t.position,t.animationOptions,!0),this._wijgrid._trackScrollingPosition(n.options.hScroller.scrollValue,n.options.vScroller.scrollValue,t.dir==="h"?t.position:null)},i.prototype._onHScrollerActivating=function(e,t){if(this._wijgrid.mAutoHeight){var n=this._wijgrid.element.height()+this._wijgrid.mSplitDistanceY-t.contentLength;if(n>0)return this._scroller.height(this._scroller.height()+n),this._scroller.wijsuperpanel("paintPanel"),!1}this._splitAreas.sw.height(t.contentLength-this._wijgrid.mSplitDistanceY)},i.prototype._onMouseWheel=function(t,r){var i,s=r>0?"top":"bottom",o=!1,u;this._wijgrid._canInteract()&&(i=this.getFixedAreaVisibleBounds(),n.each(i,function(n,r){if(r&&e.grid.isOver(t.pageY,t.pageX,r.top,r.left,r.height,r.width))return o=!0,!1}),o&&this._scroller.data("wijmo-wijsuperpanel")&&(u=this._scroller.wijsuperpanel("option","vScroller").scrollValue,this._scroller.wijsuperpanel("doScrolling",s),u!==this._scroller.wijsuperpanel("option","vScroller").scrollValue&&(t.stopPropagation(),t.preventDefault())))},i.prototype._setFixedAreaPosition=function(e,t,n,r,i){var s={},o;t==="h"?o=i?"scrollLeft":"left":o=i?"scrollTop":"top",i||(n=-n),r?(s[o]=n,e.animate(s,r)):i?e[0][o]=n:e.css(o,n)},i.prototype._testNeedVBar=function(e,t,n,r,i){var s=!1,o=this._wijgrid,u=n.width()+o.mSplitDistanceX,a=t.height()+o.mSplitDistanceY,f=e.width(),l=e.height(),c,h=0,p=0;o.mSuperPanelHeader!==null&&(h=o.mSuperPanelHeader.outerHeight(!0)),o.mBottomPagerDiv!==null&&(p=o.mBottomPagerDiv.outerHeight(!0)),c=l-h-p;switch(r){case"both":case"vertical":s=!0;break;case"auto":s=a>c||!i&&u>f&&a>c-this._verScrollBarSize;if(!s&&this._wijgrid._allowVVirtualScrolling()){var d=o._view().getVirtualPageSize();s=d>0&&d<o._totalRowsCount()}}return s},i.prototype._updateSplitAreaBounds=function(e){var t=this._wijgrid,n,r,i=0,s=0,o;if(e===0||e===2)this._splitAreas.nw.width(t.mSplitDistanceX),this._splitAreas.sw.width(t.mSplitDistanceX),t._lgGetStaticColumnsAlignment()==="right"?(this._splitAreas.se.css("marginRight",t.mSplitDistanceX),this._splitAreas.ne.css("marginRight",t.mSplitDistanceX)):(this._splitAreas.se.css("marginLeft",t.mSplitDistanceX),this._splitAreas.ne.css("marginLeft",t.mSplitDistanceX));if(e===1||e===2)this._scroller.css("height",""),this._splitAreas.se.css("marginTop",0),o=t.mOuterDiv[0].getBoundingClientRect(),n=Math.ceil(o.height||o.bottom-o.top),t.mAutoHeight?this._scroller.height(n+t.mSplitDistanceY):this._scroller.height(n),this._splitAreas.nw.height(t.mSplitDistanceY),this._splitAreas.ne.height(t.mSplitDistanceY),t.mSuperPanelHeader!==null&&(i=t.mSuperPanelHeader.outerHeight(!0)),t.mBottomPagerDiv!==null&&(s=t.mBottomPagerDiv.outerHeight(!0)),r=n-i-s,t.mSuperPanelHeader!==null&&(this._splitAreas.nw.css("top",i+"px"),this._splitAreas.ne.css("top",i+"px")),t.mAutoHeight?this._splitAreas.sw.height(r):this._splitAreas.sw.height(r-t.mSplitDistanceY),this._splitAreas.sw.css("top",t.mSplitDistanceY+i),this._splitAreas.se.css("marginTop",t.mSplitDistanceY)},i.prototype._strictWidthMode=function(){return this._wijgrid.options.ensureColumnsPxWidth||this._wijgrid._allowHVirtualScrolling()},i.prototype._getSuperPanelContentWrapper=function(){if(!this._superPanelElementsCache.contentWrapper||!this._superPanelElementsCache.contentWrapper.length)this._superPanelElementsCache.contentWrapper=this._wijgrid.mOuterDiv.find(".wijmo-wijsuperpanel-contentwrapper:first");return this._superPanelElementsCache.contentWrapper},i.prototype._getSuperPanelStateContainer=function(){if(!this._superPanelElementsCache.stateContainer||!this._superPanelElementsCache.stateContainer.length)this._superPanelElementsCache.stateContainer=this._wijgrid.mOuterDiv.find(".wijmo-wijsuperpanel-statecontainer:first");return this._superPanelElementsCache.stateContainer},i.prototype._getSuperPanelTemplateWrapper=function(){if(!this._superPanelElementsCache.templateWrapper||!this._superPanelElementsCache.templateWrapper.length)this._superPanelElementsCache.templateWrapper=this._wijgrid.mOuterDiv.find(".wijmo-wijsuperpanel-templateouterwrapper:first");return this._superPanelElementsCache.templateWrapper},i.prototype._isNativeSuperPanel=function(){return this._wijgrid._isTouchEnv()},i.prototype._testAutohiddenScrollbars=function(){if(this._isNativeSuperPanel()){var e=this._getSuperPanelStateContainer();if(e.length)return e[0].offsetWidth===e[0].clientWidth}return!1},i}(t.baseView);t.fixedView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(e){this._updates=0,this._selectedColumns=null,this._selectedRows=null,this._extend_rules={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};if(!e)throw"invalid arguments";this._wijgrid=e,this._addedCells=new i(e),this._removedCells=new i(e),this._selectedCells=new i(e),this._addedDuringCurTransactionCells=new i(e)}return t.prototype.selectedCells=function(){return this._selectedCells},t.prototype.selectedRows=function(){return this._selectedRows||(this._selectedRows=new s(this._wijgrid)),this._selectedRows},t.prototype.addColumns=function(e,t){!t&&t!==0&&(t=e),this.addRange(e,0,t,16777215)},t.prototype.addRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._currentCell()),this._selectRange(s,!1,!0,0,null),this.endUpdate()},t.prototype.addRows=function(e,t){!t&&t!==0&&(t=e),this.addRange(0,e,16777215,t)},t.prototype.removeRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._currentCell()),this._clearRange(s,0),this.endUpdate()},t.prototype.removeColumns=function(e,t){!t&&t!==0&&(t=e),this.removeRange(e,0,t,16777215)},t.prototype.removeRows=function(e,t){!t&&t!==0&&(t=e),this.removeRange(0,e,16777215,t)},t.prototype.clear=function(){this.beginUpdate(),this._removedCells._clear(),this._removedCells._addFrom(this._selectedCells),this.endUpdate()},t.prototype.selectAll=function(){this.beginUpdate(),this._selectRange(this._wijgrid._getDataCellsRange(0),!1,!1,0,null),this.endUpdate()},t.prototype.beginUpdate=function(){this._updates++},t.prototype.endUpdate=function(t){if(this._updates>0){this._updates--;if(this._updates===0){this.doSelection();if(this._addedCells.length()||this._removedCells.length())this._selectedColumns!==null&&this._selectedColumns.UnderlyingDataChanged(),this._selectedRows!==null&&this._selectedRows._setDirty(),this._wijgrid._trigger("selectionChanged",t,{addedCells:this._addedCells,removedCells:this._removedCells});this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._removedCells._clear()}}},t.prototype._multipleRangesAllowed=function(){var e=this._wijgrid.options.selectionMode;return e&&((e=e.toLowerCase())==="multicolumn"||e==="multirow"||e==="multirange")},t.prototype._multipleEntitiesAllowed=function(){var e=this._wijgrid.options.selectionMode;return e&&((e=e.toLowerCase())==="multicolumn"||e==="multirow"||e==="multirange"||e==="singlerange")},t.prototype._anchorCell=function(){return this.__anchorCell},t.prototype._startNewTransaction=function(t){t&&(this.__anchorCell=t._clone(),this._addedDuringCurTransactionCells=new e.grid.cellInfoOrderedCollection(this._wijgrid))},t.prototype._clearRange=function(e,t){var n=this._wijgrid.options.selectionMode.toLowerCase(),r=this._wijgrid._getDataCellsRange(0);if(e._isValid()&&n!=="none"&&this._selectedCells.length()>0){var i=e._clone();i._normalize(),i._clip(r);if(!e._isValid())return;i._extend(this._extend_rules[n][t],r),this.beginUpdate();for(var s=0,o=this._selectedCells.length();s<o;s++){var u=this._selectedCells.item(s);i._containsCellInfo(u)&&this._removedCells._add(u)}this.endUpdate()}},t.prototype._selectRange=function(t,n,r,i,s){var o=this._wijgrid.options.selectionMode.toLowerCase(),u,a=this._wijgrid._getDataCellsRange(0);if(o!=="none"&&t._isValid()){u=t._clone(),u._normalize(),u._clip(a);if(!u._isValid())return;this.beginUpdate(),this._multipleRangesAllowed()?n||r?r&&(this._removedCells._clear(),this._removedCells._addFrom(this._addedDuringCurTransactionCells)):this.clear():this.clear();switch(o){case"singlecell":case"singlecolumn":case"singlerow":u=s===null?new e.grid.cellInfoRange(u.topLeft(),u.topLeft()):new e.grid.cellInfoRange(s,s)}u._extend(this._extend_rules[o][i],a),this.doRange(u,!0),this.endUpdate()}},t.prototype._ensureSelection=function(){var e=this._wijgrid._view(),t=-2,n;for(var r=0;r<this._selectedCells.length();r++){var i=this._selectedCells.item(r);i._isRendered()&&(t!==i.rowIndex()&&(n=i.row(),t=i.rowIndex()),this.selectCell(i,n,e,!0))}},t.prototype._ensureSelectionInRow=function(e){var t=this,n=this._wijgrid._view();if(n._isRowRendered(e)>=0){var r=n._getRowInfoBySketchRowIndex(e,!1),i=this.selectedCells();r&&i&&i.length()>0&&r.$rows.children("td, th").each(function(s,o){var u=i.indexOf(s,e);u>=0&&t.selectCell(i.item(u),r,n,!0)})}},t.prototype.doSelection=function(){var e=this._wijgrid._view(),t=this._wijgrid.options.wijCSS,n,r=-1;for(var i=0,s=this._removedCells.length();i<s;i++){var o=this._removedCells.item(i);this._addedCells.indexOf(o)<0?(r!==o.rowIndex()&&(n=o.row(),r=o.rowIndex()),this.selectCell(o,n,e,!1),n.$rows&&n.$rows.removeClass(t.stateDefault+" "+t.stateHover),this._selectedCells._remove(o),this._addedDuringCurTransactionCells._remove(o)):(this._removedCells._removeAt(i),i--,s--)}r=-1;for(var i=0,s=this._addedCells.length();i<s;i++){var o=this._addedCells.item(i),u=this._selectedCells.indexOf(o);u<0?(r!==o.rowIndex()&&(n=o.row(),r=o.rowIndex()),this.selectCell(o,n,e,!0),this._selectedCells._insertUnsafe(o,~u),this._addedDuringCurTransactionCells._add(o)):(this._addedCells._removeAt(i),i--,s--)}},t.prototype.selectCell=function(e,t,r,i){if(e._isRendered()){var s=this._wijgrid._viewPortBounds(),o=r.getCell(e.cellIndexAbs(),e.rowIndexAbs());if(o){var u=n(o),a=r._changeCellRenderState(u,8,i===!0);this._wijgrid.mCellStyleFormatter.format(u,e.cellIndex(),e.columnInst(),t,a)}}},t.prototype.doRange=function(t,n){var r=t.topLeft().cellIndex(),i=t.topLeft().rowIndex(),s=t.bottomRight().cellIndex(),o=t.bottomRight().rowIndex(),u=this._wijgrid._view(),a=this._wijgrid._viewPortBounds();if(n){var f=this._addedCells.length(),l=this._wijgrid._rows();for(var c=i;c<=o;c++){var h=u._getRowInfoBySketchRowIndex(c);if(h&&h.type&2)for(var p=r;p<=s;p++){var d=new e.grid.cellInfo(p,c);f===0?this._addedCells._appendUnsafe(d):this._addedCells._add(d)}}}else{var f=this._removedCells.length();for(var c=i;c<=o;c++)for(var p=r;p<=s;p++){var d=new e.grid.cellInfo(p,c);f===0?this._removedCells._appendUnsafe(d):this._removedCells._add(d)}}},t}();t.selection=r;var i=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e,this._list=[]}return t.prototype.item=function(e){return this._list[e]},t.prototype.length=function(){return this._list.length},t.prototype.indexOf=function(e,t){arguments.length===1&&(t=e.rowIndex(),e=e.cellIndex());var n=0,r=this._list.length-1,i,s,o;while(n<=r){i=n+(r-n>>1),s=this._list[i],o=s.rowIndex()-t,o===0&&(o=s.cellIndex()-e);if(o<0)n=i+1;else{if(!(o>0))return i;r=i-1}}return~n},t.prototype.toString=function(){var e="";for(var t=0,n=this._list.length;t<n;t++)e+=this._list[t].toString()+"\n";return e},t.prototype._add=function(e){var t=this.indexOf(e);return t<0?(this._list.splice(~t,0,e),e._setGridView(this._wijgrid),!0):!1},t.prototype._addFrom=function(e){if(e){var t=e.length(),n=this._list.length,r;if(n===0){this._list.length=t;for(r=0;r<t;r++)this._list[r]=e.item(r),this._list[r]._setGridView(this._wijgrid)}else for(r=0;r<t;r++)this._add(e.item(r))}},t.prototype._appendUnsafe=function(e){this._list[this._list.length]=e,e._setGridView(this._wijgrid)},t.prototype._insertUnsafe=function(e,t){this._list.splice(t,0,e)},t.prototype._clear=function(){this._list.length=0},t.prototype._remove=function(e){var t=this.indexOf(e);return t>=0?(this._list.splice(t,1),!0):!1},t.prototype._removeAt=function(e){this._list.splice(e,1)},t.prototype._getCellsIndicies=function(){var e=[],t=this._list,n=t.length;if(n){var r={};for(var i=0;i<n;i++){var s=t[i].cellIndex();r[s]=s}for(var o in r)r.hasOwnProperty(o)&&e.push(r[o])}return e},t.prototype._getSelectedRowsIndicies=function(){var e=[],t=this._list,n=t.length;if(n){var r={};for(var i=0;i<n;i++){var s=t[i].rowIndex();r[s]=s}for(var o in r)r.hasOwnProperty(o)&&e.push(r[o])}return e},t.prototype._rectangulate=function(){var t=4294967295,n=4294967295,r=0,i=0,s=this._list.length;if(s){for(var o=0;o<s;o++){var u=this._list[o];t=Math.min(t,u.cellIndex()),n=Math.min(n,u.rowIndex()),r=Math.max(r,u.cellIndex()),i=Math.max(i,u.rowIndex())}return new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i))}return null},t}();t.cellInfoOrderedCollection=i;var s=function(){function e(e){this.mLength=0,this.mDirty=!0,this.mRowIndicies=[],this.mWijgrid=e}return e.prototype.length=function(){return this._ensure(),this.mLength},e.prototype.item=function(e){this._ensure();var t=this.mWijgrid._view()._getRowInfoBySketchRowIndex(this.mRowIndicies[e]);return t},e.prototype._ensure=function(){this.mDirty&&(this.mRowIndicies=this.mWijgrid.selection().selectedCells()._getSelectedRowsIndicies(),this.mLength=this.mRowIndicies.length,this.mDirty=!1)},e.prototype._setDirty=function(){this.mDirty=!0},e}();t.selectedRowsAccessor=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(t){this._gap_to_start=10,this._inProgress=!1,this._additionalEventsAttached=!1,this._wijgrid=t,this._evntFormat="{0}."+this._wijgrid.widgetName+".selectionui",this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._view=this._wijgrid._view(),this._rootElement=this._view.focusableElement(),this._rootElement.bind(this._eventKey("mousedown"),n.proxy(this._onGridMouseDown,this))}return t.prototype.dispose=function(){this._rootElement.unbind(this._eventKey("mousedown"),this._onGridMouseDown),this._detachAdditionalEvents()},t.prototype._onGridMouseDown=function(t){if(!this._wijgrid._canInteract()||this._wijgrid.options.selectionMode.toLowerCase()==="none")return;var r=this._view.getVisibleContentAreaBounds(),i={x:t.pageX,y:t.pageY},s=t.target&&t.target.tagName!==undefined?t.target.tagName.toLowerCase():undefined,o=n(t.target),u=e.grid.wijgrid.CSS;(!s||o.is("td."+u.TD+", th."+u.TD+", div."+u.cellContainer))&&i.x>r.left&&i.x<r.left+r.width&&i.y>r.top&&i.y<r.top+r.height&&(this._attachAdditionalEvents(),this._startPos=i,this._startCellInfo=this._coordToDataCellInfo(this._startPos))},t.prototype._onDocumentMouseMove=function(t){if(!this._startCellInfo||!this._startCellInfo._isValid())return;var r={x:t.pageX,y:t.pageY},i,s=this._wijgrid._view(),o=e.grid.renderState;this._inProgress||(this._inProgress=Math.abs(this._startPos.x-r.x)>this._gap_to_start||Math.abs(this._startPos.y-r.y)>this._gap_to_start);if(this._inProgress){var u=this._coordToDataCellInfo(r);if(!u._isValid())return;this._endCellInfo=u;var a=new e.grid.cellInfoRange(this._startCellInfo,this._endCellInfo);a._normalize(),a._clip(this._wijgrid._getDataCellsRange(0));if(a._isValid()&&!a.isEqual(this._prevMouseMoveRange)){this._prevMouseMoveRange=a;var f=new e.grid.cellInfoOrderedCollection(this._wijgrid);for(var l=a.topLeft().rowIndex(),c=a.bottomRight().rowIndex();l<=c;l++){i=s._getRowInfoBySketchRowIndex(l);if(i.type&2)for(var h=a.topLeft().cellIndex(),p=a.bottomRight().cellIndex();h<=p;h++)f._appendUnsafe(new e.grid.cellInfo(h,l))}var d=-1;for(var l=0,c=this._addedCells.length();l<c;l++){var v=this._addedCells.item(l);if(f.indexOf(v)<0){if(this._wijgrid.selection().selectedCells().indexOf(v)<0){var m=this._view.getCell(v.cellIndexAbs(),v.rowIndexAbs());if(m){d!==v.rowIndex()&&(i=v.row(),d=v.rowIndex());var g=n(m),y=s._changeCellRenderState(g,8,!1);this._wijgrid.mCellStyleFormatter.format(g,v.cellIndex(),v.columnInst(),i,y)}}this._addedCells._removeAt(l),l--,c--}}d=-1;for(var l=0,c=f.length();l<c;l++){var v=f.item(l);if(this._addedCells.indexOf(v)<0&&this._wijgrid.selection().selectedCells().indexOf(v)<0&&this._addedCells._add(v)){var m=this._view.getCell(v.cellIndexAbs(),v.rowIndexAbs());if(m){d!==v.rowIndex()&&(i=v.row(),d=v.rowIndex());var g=n(m),y=s._changeCellRenderState(g,8,!0);this._wijgrid.mCellStyleFormatter.format(g,v.cellIndex(),v.columnInst(),i,y)}}}}}},t.prototype._onDocumentMouseUp=function(t){this._detachAdditionalEvents();if(this._inProgress){this._inProgress=!1;if(this._prevMouseMoveRange&&this._prevMouseMoveRange._isValid()){this._wijgrid._changeCurrentCell(t,this._endCellInfo,{changeSelection:!1,setFocus:!1}),(!t.shiftKey||!this._wijgrid.selection()._multipleEntitiesAllowed())&&this._wijgrid.selection()._startNewTransaction(this._startCellInfo),this._wijgrid.selection().beginUpdate(),this._wijgrid.selection()._selectRange(this._prevMouseMoveRange,t.shiftKey,t.ctrlKey,0,this._endCellInfo),this._wijgrid.selection().endUpdate();var r=this._wijgrid._view(),i=-1,s,o=e.grid.renderState;for(var u=0,a=this._addedCells.length();u<a;u++){var f=this._addedCells.item(u);if(this._wijgrid.selection().selectedCells().indexOf(f)<0){var l=r.getCell(f.cellIndexAbs(),f.rowIndexAbs());if(l!==null){i!==f.rowIndex()&&(s=f.row(),i=f.rowIndex());var c=n(l),h=r._changeCellRenderState(c,8,!1);this._wijgrid.mCellStyleFormatter.format(c,f.cellIndex(),f.columnInst(),s,h)}}}return this._addedCells._clear(),this._startCellInfo=this._endCellInfo=this._prevMouseMoveRange=null,!1}}},t.prototype._attachAdditionalEvents=function(){if(!this._additionalEventsAttached)try{this._view.toggleDOMSelection(!1),n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this))}finally{this._additionalEventsAttached=!0}},t.prototype._detachAdditionalEvents=function(){if(this._additionalEventsAttached)try{this._view.toggleDOMSelection(!0),n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp)}finally{this._additionalEventsAttached=!1}},t.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},t.prototype._coordToDataCellInfo=function(t){var n=0,r=this._wijgrid._renderedLeaves().length-1,i=0,s=-1,o,u=new e.grid.rowAccessor(this._view,2,0,0),a;while(n<=r){i=(r-n>>1)+n,o=e.grid.bounds(this._view.getHeaderCell(i)),o||(a=u.item(0),o=e.grid.bounds(e.grid.rowAccessor.getCell(a,i)));if(!o)break;if(t.x<o.left)r=i-1;else{if(!(t.x>o.left+o.width)){s=i;break}n=i+1}}if(s===-1)return e.grid.cellInfo.outsideValue;u=new e.grid.rowAccessor(this._view,0,0,0);var f=-1;n=0,r=u.length()-1,i=0;while(n<=r){i=(r-n>>1)+n,a=u.item(i),o=e.grid.bounds(e.grid.rowAccessor.getCell(a,0));if(t.y<o.top)r=i-1;else{if(!(t.y>o.top+o.height)){f=i;break}n=i+1}}if(f===-1)return e.grid.cellInfo.outsideValue;var l=new e.grid.cellInfo(s,f,this._wijgrid,!0);return l},t}();t.uiSelection=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(e,t,n,r){this._view=e,this._scope=t,this._offsetBottom=r,this._offsetTop=n}return t.prototype.item=function(e){var t=this.length();return e>=0&&e<t?this._view.getJoinedRows(e+this._offsetTop,this._scope):null},t.prototype.length=function(){var e=this._view.getJoinedTables(!0,0),t=0,n;if(n=e[0])t=n.getSectionLength(this._scope);if(n=e[1])t+=n.getSectionLength(this._scope);return t-=this._offsetTop+this._offsetBottom,t<0&&(t=0),t},t.prototype.find=function(e,t,n){typeof n=="undefined"&&(n=!1);var r=this.findEx(e,t,n);return r?r.val:null},t.prototype.findIndex=function(e,t,n){typeof n=="undefined"&&(n=!1);var r=this.findEx(e,t,n);return r?r.at:-1},t.prototype.findRowObj=function(e,t,n){typeof n=="undefined"&&(n=!1);var r=this.findEx(e,t,n);return r?this.item(r.at):null},t.prototype.findEx=function(e,t,n){typeof n=="undefined"&&(n=!1);var r=this.length();for(var i=0;i<r;i++){var s=this.item(i),o=this._view._getRowInfo(s,n);if(t(o)===!0)return{at:i,val:o}}return null},t.iterateCells=function(e,t,n){if(e&&t){var r=0;for(var i=0,s=e.length;i<s;i++){var o=e[i];if(o)for(var u=0,a=o.cells.length;u<a;u++){var f=t(o.cells[u],r++,n);if(f!==!0)return}}}},t.getCell=function(e,t){var n,r;if(e&&(n=e[0])){r=n.cells.length;if(t<r)return n.cells[t];t-=r;if(n=e[1]){r=n.cells.length;if(t<r)return n.cells[t]}}return null},t.getCell$=function(t,r){var i=e.grid.rowAccessor.getCell(t,r);return i?n(i):n([])},t.cellsCount=function(e){var t=0,n;if(e&&(n=e[0])){t=n.cells.length;if(n=e[1])t+=n.cells.length}return t},t}();t.rowAccessor=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery;(function(e){e[e.error=0]="error",e[e.continueEditing=1]="continueEditing",e[e.success=2]="success",e[e.cancel=4]="cancel",e[e.notEdited=8]="notEdited"})(t.updateCellResult||(t.updateCellResult={}));var r=t.updateCellResult,i=function(){function t(){this._timeout=25}return t.prototype.cellEditStart=function(t,n,r){var i=!1,s=t._view();if(n._isValid()&&!n._isPreparingForEditing()&&!n._isEdit()&&n.columnInst()instanceof e.grid.c1field){var o=n.row();if(o){var u=o.type;if(u&2){var a={cell:n,event:r,handled:!1};n._isPreparingForEditing(!0);if(i=t._onBeforeCellEdit(a)||t.options.editingMode==="row")a.handled||(i=this._defaultBeforeCellEdit(t,a));i&&n._isEdit(!0),n._isPreparingForEditing(!1)}}}return i},t.prototype.updateCell=function(t,n,r,i){var s;if(n&&!n._isEdit())return 10;if(!n||!n._isValid()||!(s=n.row())||!(s.type&2))return 0;if(i||!n._isRendered())return 6;var o=2,u=n.column(),a={cell:n,value:undefined};if(!t._onBeforeCellUpdate(a)&&t.options.editingMode!=="row")return 1;a.value===undefined&&(a.value=this._getCellValue(t,n));var f=a.value,l=n.value();try{var c=this._getHTMLInputElementType(n);e.grid.HTML5InputSupport.isExtendSupportRequired(c)?(a.value=e.grid.HTML5InputSupport.parse(a.value,c),a.value=e.grid.HTML5InputSupport.extend(l,a.value,c)):a.value=t.parse(n.column(),a.value),f=a.value}catch(h){a.value=f}e.grid.getDataType(u)==="datetime"&&(f instanceof Date&&(f=f.getTime()),l instanceof Date&&(l=l.getTime()));if(f!==l){try{n.value(a.value)}catch(h){var p={cell:n,value:a.value};o=0,t._onInvalidCellValue(p)}if(o&2){var d={cell:n};t._onAfterCellUpdate(d)}}return o},t.prototype.cellEditEnd=function(e,t,n){var r=t.row(),i={cell:t,event:n,handled:!1};t._isEdit(!1),t._isRendered()&&(e._onAfterCellEdit(i),i.handled||this._defaultAfterCellEdit(e,i))},t.prototype._defaultBeforeCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u;if(i.dataIndex>=0){var a=r.cell.value(),f=e.getKeyCodeEnum(),l=e.grid.HTML5InputSupport.getDefaultInputType(t._isMobileEnv(),i),c=t._allowCellEditing(),h=!1;s=!0;try{o=r.cell.container();if(e.grid.getDataType(i)==="boolean"){var p=o.children("span");if(h=!!p.length&&!!(p.prop("disabled")||t.options._aspNetDisabledClass&&p.hasClass(t.options._aspNetDisabledClass)))n.data(p[0],"serverSideCheckbox",!0),p.prop("disabled",!1),t.options._aspNetDisabledClass&&p.removeClass(t.options._aspNetDisabledClass);u=o.find(":checkbox"),(h||!c)&&u.prop("disabled",!1),r.event&&r.event.type==="keypress"&&u.one("keyup",function(e){e.which===f.SPACE&&(e.preventDefault(),u[0].checked=!a)})}else{u=n("<input type='"+l+"' />").css("ime-mode",i.imeMode||"auto").attr("aria-label",l).addClass(e.grid.wijgrid.CSS.inputMarker).addClass("wijmo-wijinput "+t.options.wijCSS.stateFocus).bind("keydown",t,n.proxy(this._checkBoxOrInputKeyDown,this)),u.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()});if(!r.event||r.event.type!=="keydown"||r.event.which===113)switch(e.grid.getDataType(i)){case"currency":case"number":if(a!==null){u.val(a);break};case"datetime":if(e.grid.HTML5InputSupport.isExtendSupportRequired(l)){u.val(e.grid.HTML5InputSupport.toStr(a,l));break};default:u.val(t.toStr(i,a))}o.empty().append(u);if(c){var d=u.val().length;l==="text"&&(new e.grid.domSelection(u[0])).setSelection({start:d,end:d})}}c&&(u.focus(),setTimeout(function(){u.focus()},this._timeout*2))}catch(v){alert(v.message),s=!1}}return s},t.prototype._defaultAfterCellEdit=function(t,r){var i=r.cell.columnInst(),s=i.options,o=!1;if(s.dataIndex>=0){o=!0;var u=t._view();try{var a=r.cell.container(),f=t.toStr(s,r.cell.value()),l=u._getRowInfoBySketchRowIndex(r.cell.rowIndex());if(e.grid.getDataType(s)==="boolean"){var c=a.children("span"),h=c.length&&n.data(c[0],"serverSideCheckbox"),p=a.find(":checkbox");p.prop("checked",f==="true"),h&&(c.prop("disabled",!0),t.options._aspNetDisabledClass&&c.addClass(t.options._aspNetDisabledClass),p.prop("disabled",!0))}else t.mCellFormatter.format(n(r.cell.tableCell()),r.cell.cellIndex(),a,i,f,l)}catch(d){alert("defaultAfterCellEdit: "+d.message),o=!1}}return o},t.prototype._checkBoxOrInputKeyDown=function(t){var n=e.getKeyCodeEnum();if(t.which===n.ENTER){var r=t.data;if(r)return r._endEditInternal(t),!1}},t.prototype._getCellValue=function(e,t){var n=t.container().find(":input:first"),r=null;return n.length&&(r=n.attr("type")==="checkbox"?n[0].checked:n.val()),r},t.prototype._getHTMLInputElementType=function(e){return e.container().find(":input:first").attr("type")},t}();t.cellEditorHelper=i;var s=function(){function r(t,r){this.mGrid=t,this.mWrapper=n("<div />"),this.mGrid._allowCellEditing()?this.mHiddenElement=n('<input type="text" />').keydown(n.proxy(this._onKeyDown,this)):this.mHiddenElement=n('<input type="button" />'),this.mHiddenElement.css({position:"relative",border:0,padding:0,margin:0,width:1,height:1,"font-size":e.grid.isMobileSafari()?"0em":"1px"}),this.mHiddenElement.attr("aria-label","hiddenElement"),this.mFakeFocusable=n('<input tabindex="-1" type="button" />').css({position:"relative",width:1,height:1,border:0,padding:0,margin:0}),this.mFakeFocusable.attr("aria-label","fakeFocusable"),this.mWrapper.append(this.mHiddenElement).append(this.mFakeFocusable).css({position:"absolute",width:"0px",height:"0px",overflow:"hidden","z-index":999999}),r.append(this.mWrapper)}return r.prototype.dispose=function(){if(this.mWrapper)try{this.mWrapper.remove()}catch(e){}finally{this.mWrapper=null,this.mHiddenElement=null,this.mGrid=null}},r.prototype.focus=function(e,r){if(e&&e.length){var i=e.offset();this.mWrapper.offset({top:i.top,left:i.left}),n.browser.msie&&this.mFakeFocusable.focus(),this.mHiddenElement.css("ime-mode",r&&r instanceof t.c1field&&r.options.imeMode||"auto").focus()}},r.prototype.isHiddenInput=function(e){return e&&(e[0]===this.mHiddenElement[0]||e[0]===this.mFakeFocusable[0])},r.prototype.canHandle=function(e){return this.mGrid._allowCellEditing()&&this.isPrintableKeyCode(e)},r.prototype.isPrintableKeyCode=function(e){var t=e.keyCode;return!e.ctrlKey&&!e.altKey&&(t>=65&&t<=90||t>=48&&t<=57||t>=96&&t<=105||t>=186&&t<=192||t>=220&&t<=222||t===219||t>=106&&t<=111||t===32||t===61||t===173||t===229||e.keyCode===0)},r.prototype._onKeyDown=function(t){if(this.canHandle(t))this.mGrid._beginEditInternal(t);else{var n=e.getKeyCodeEnum();switch(t.keyCode){case n.ESCAPE:case n.ENTER:t.preventDefault()}}},r}();t.keyDownEventListener=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(){this._div=document.createElement("div"),this._div.style.display="none",document&&document.body&&document.body.appendChild(this._div)}return t.prototype.dispose=function(){try{this._div&&this._div.parentNode&&this._div.parentNode.removeChild(this._div)}catch(e){}finally{this._div=null}},t.prototype.format=function(e,t,n,r,i,s){r._initializeCell(e,t,n,i,s)},t.prototype.updateHTML=function(t,n,r){typeof r=="undefined"&&(r=!1);var i=t[0];if(i.firstChild)while(i.firstChild)i.removeChild(i.firstChild);e.grid.setContent(this._div,r,n);while(this._div.firstChild)i.appendChild(this._div.firstChild)},t}();t.cellFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(e){this.MIN_WIDTH=5,this._elements=[],this._gap=10,this._step=1,this._inProgress=!1,this._hoveredColumn=null,this._startLocation=null,this._lastLocation=null,this._proxy=null,this._wijgrid=e,this._evntFormat="{0}."+this._wijgrid.widgetName+".resizer"}return t.prototype.addElement=function(e){e&&e.element&&(e.element.bind(this._eventKey("mousemove"),n.proxy(this._onMouseMove,this)).bind(this._eventKey("mousedown"),n.proxy(this._onMouseDown,this)).bind(this._eventKey("mouseout"),n.proxy(this._onMouseOut,this)),this._elements.push(e))},t.prototype.dispose=function(){var e=this;n.each(this._elements,function(t,n){n.element.unbind(e._eventKey("mousemove"),e._onMouseMove).unbind(e._eventKey("mousedown"),e._onMouseDown).unbind(e._eventKey("mouseout"),e._onMouseOut)}),this._detachDocEvents()},t.prototype.inProgress=function(){return this._inProgress},t.prototype._onMouseMove=function(e){if(!this._inProgress){var t=this._getFieldByPos({x:e.pageX,y:e.pageY});t&&t._canSize()&&this._wijgrid._canInteract()?(t.element.css("cursor","e-resize"),this._hoveredColumn=t,e.stopPropagation()):this._onMouseOut(e)}},t.prototype._onMouseOut=function(e){this._inProgress||this._hoveredColumn&&(this._hoveredColumn.element.css("cursor",""),this._hoveredColumn=null)},t.prototype._onMouseDown=function(t){this._hoveredColumn=this._getFieldByPos({x:t.pageX,y:t.pageY});if(this._hoveredColumn&&this._hoveredColumn._canSize()&&this._wijgrid._canInteract())try{var r=this._wijgrid.options.wijCSS,i=e.grid.wijgrid.CSS;this._hoveredColumn.element.css("cursor",""),this._docCursor=document.body.style.cursor,document.body.style.cursor="e-resize",this._startLocation=this._lastLocation=e.grid.bounds(this._hoveredColumn.element),this._proxy=n('<div class="'+i.resizingHandle+" "+r.wijgridResizingHandle+" "+r.stateHighlight+'">&nbsp;</div>');var s=this._wijgrid._view().getVisibleAreaBounds(!0);this._proxy.css({left:t.pageX,top:this._startLocation.top,height:s.height+s.top-this._startLocation.top}),n(document.body).append(this._proxy)}finally{this._attachDocEvents(),this._inProgress=!0,t.stopPropagation()}},t.prototype._onDocumentMouseMove=function(e){var t=this._step*Math.round((e.pageX-this._lastLocation.left)/this._step);this._lastLocation={left:this._lastLocation.left+t,top:e.pageY,width:undefined,height:undefined},this._proxy.css("left",this._lastLocation.left)},t.prototype._onDocumentMouseUp=function(e){try{document.body.style.cursor=this._docCursor,this._proxy.remove(),this._startLocation!==this._lastLocation&&this._wijgrid._fieldResized(this._hoveredColumn,this._startLocation.width,Math.max(this._lastLocation.left-this._startLocation.left,this.MIN_WIDTH))}finally{this._hoveredColumn=null,this._proxy=null,this._detachDocEvents(),this._inProgress=!1}},t.prototype._onSelectStart=function(e){e.preventDefault()},t.prototype._attachDocEvents=function(){this._inProgress||(n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this)),n.fn.disableSelection&&n(document.body).disableSelection(),"onselectstart"in document&&n(document.body).bind("selectstart",this._onSelectStart))},t.prototype._detachDocEvents=function(){this._inProgress&&(n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp),n.fn.enableSelection&&n(document.body).enableSelection(),"onselectstart"in document&&n(document.body).unbind("selectstart",this._onSelectStart))},t.prototype._getFieldByPos=function(t){for(var n=0,r=this._elements.length;n<r;n++){var i=this._elements[n],s=e.grid.bounds(i.element),o=e.grid.isOver(t.y,t.x,s.top,s.left+s.width-this._gap,s.height,this._gap);if(o)return i}return null},t.prototype._eventKey=function(t){var n=this._wijgrid._isTouchEnv()?"wij":"";return n+e.grid.stringFormat(this._evntFormat,t)},t}();t.uiResizer=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function r(t){this._scope_guid="scope_"+e.grid.getUID(),this._dragEnd=!1,this.mZIndex=1e3;var n=e.grid.wijgrid.CSS;this._wijgrid=t,this._wijCSS=this._wijgrid.options.wijCSS,this._wrapHtml='<div class="'+this._wijCSS.widget+" "+n.wijgrid+" "+this._wijCSS.wijgrid+" "+this._wijCSS.content+" "+this._wijCSS.cornerAll+'">'+'<table class="'+n.root+" "+n.table+" "+this._wijCSS.wijgridTable+'">'+'<tr class="'+n.headerRow+" "+this._wijCSS.wijgridHeaderRow+'">'+"</tr>"+"</table>"+"</div>"}return r.prototype.attachGroupArea=function(e){var t,r=this;if(!n.ui||!n.ui.droppable||!n.ui.draggable)return;e.droppable({scope:this._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(r._wijgrid.options.allowColMoving){t=r._getColumnInstance(e);if(t)return t._canDropToGroupArea()}return!1},drop:function(e,n){!r._isInElement(e,n.draggable)&&(t=r._getColumnInstance(n.draggable))&&(r._dragEnd=!0)},over:function(t,n){var i=r._wijgrid._groupAreaColumns().length;r._dropTargetRedirected=i>0,r._droppableColumn=i>0?r._wijgrid._groupAreaColumns()[i-1]:e,e.data("thisDroppableWijField",r._droppableColumn)},out:function(t,n){r._droppableColumn===e.data("thisDroppableWijField")&&(r._droppableColumn=null)}})},r.prototype.attach=function(r){var i,s,o=e.grid.wijgrid.CSS,u=this;if(!n.ui.droppable||!n.ui.draggable)return;if(!r||!(i=r.element))return;i.draggable({helper:function(n){var s;return r instanceof t.c1groupedfield?s=i.clone():s=i.clone().wrap(u._wrapHtml).width(i.width()).height(i.height()).closest("."+o.wijgrid),s.addClass(o.dndHelper+" "+u._wijCSS.wijgridDndHelper).css("z-index",u.mZIndex=e.grid.getZIndex(u._wijgrid.mOuterDiv,1e3)),s},appendTo:"body",scope:u._scope_guid,drag:function(e,t){u._hideArrows();if(u._droppableColumn&&!u._isInElement(e,i)){var n=u._droppableColumn.element;n||(n=u._droppableColumn),u._showArrows(n,u._getPosition(r,u._droppableColumn,e,t))}},start:function(e,n){if(u._wijgrid._canInteract()&&u._wijgrid.options.allowColMoving&&(u._wijgrid._UIResizer()==null||!u._wijgrid._UIResizer().inProgress())){var i=r,s=r instanceof t.c1groupedfield,o=s?"groupArea":"columns";s&&(i=u._wijgrid._findInstance(r.options));var a=i.options;if(r._canDrag()&&u._wijgrid._trigger("columnDragging",null,{drag:a,dragSource:o}))return u._wijgrid._trigger("columnDragged",null,{drag:a,dragSource:o}),!0}return!1},stop:function(e,n){u._hideArrows();try{u._dragEnd&&(u._droppableColumn.element?u._wijgrid._handleDragnDrop(r,u._droppableColumn,u._getPosition(r,u._droppableColumn,e,n),r instanceof t.c1groupedfield,u._droppableColumn instanceof t.c1groupedfield):u._wijgrid._handleDragnDrop(r,null,"left",r instanceof t.c1groupedfield,!0))}finally{u._droppableColumn=null,u._dragEnd=!1}}}).droppable({hoverClass:u._wijCSS.stateHover,scope:u._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(u._wijgrid.options.allowColMoving&&i[0]!==e[0]){s=u._getColumnInstance(e);if(s)return s._canDropTo(r)}return!1},drop:function(e,t){if(s=u._getColumnInstance(t.draggable))u._dragEnd=!0},over:function(e,t){u._dropTargetRedirected=!1,u._droppableColumn=r,i.data("thisDroppableWijField",u._droppableColumn)},out:function(e,t){u._droppableColumn===r.element.data("thisDroppableWijField")&&(u._droppableColumn=null)}})},r.prototype.detach=function(e){var t;e&&(t=e.element)&&(t.data("ui-draggable")&&t.draggable("destroy"),t.data("ui-droppable")&&t.droppable("destroy"))},r.prototype.dispose=function(){this._$topArrow&&(this._$topArrow.remove(),this._$topArrow=null),this._$bottomArrow&&(this._$bottomArrow.remove(),this._$bottomArrow=null)},r.prototype._getColumnInstance=function(e){var n=e.data(t.widgetEmulator.DATA_INSTANCE_PROP);if(!n)throw"Unable to get a column instance";return n},r.prototype._showArrows=function(e,t){this._topArrow().css("z-index",this.mZIndex).show().position({my:"center",at:t+" top",of:e,collision:"none"}),this._bottomArrow().css("z-index",this.mZIndex).show().position({my:"center",at:t+" bottom",of:e,collision:"none"})},r.prototype._hideArrows=function(){this._topArrow().hide(),this._bottomArrow().hide()},r.prototype._topArrow=function(){return this._$topArrow||(this._$topArrow=n("<div />").addClass(e.grid.wijgrid.CSS.dndArrowTopContainer+" "+this._wijCSS.wijgridDndArrowTopContainer).append(n("<span />").addClass(this._wijCSS.icon+" "+this._wijCSS.iconArrowThickDown)).hide().appendTo(document.body)),this._$topArrow},r.prototype._bottomArrow=function(){return this._$bottomArrow||(this._$bottomArrow=n("<div />").addClass(e.grid.wijgrid.CSS.dndArrowBottomContainer+" "+this._wijCSS.wijgridDndArrowBottomContainer).append(n("<span />").addClass(this._wijCSS.icon+" "+this._wijCSS.iconArrowThickUp)).hide().appendTo(document.body)),this._$bottomArrow},r.prototype._isInElement=function(t,n){var r=e.grid.bounds(n,!1);return t.pageX>r.left&&t.pageX<r.left+r.width&&t.pageY>r.top&&t.pageY<r.top+r.height},r.prototype._getPosition=function(n,r,i,s){if(!r.element)return"left";if(this._dropTargetRedirected)return"right";var o=e.grid.bounds(r.element,!1),u=o.width/6,a=o.left+o.width/2,f="right",l;return i.pageX<a&&(f="left"),r instanceof t.c1groupedfield?(n instanceof t.c1groupedfield&&(l=r.options.groupedIndex-n.options.groupedIndex,Math.abs(l)===1&&(f=l<0?"left":"right")),f):(l=r.options._linearIdx-n.options._linearIdx,t.c1bandfield.test(r.options)&&n.options._parentIdx!==r.options._travIdx&&Math.abs(i.pageX-a)<u?"center":(n.options._parentIdx===r.options._parentIdx&&Math.abs(l)===1&&(f=l<0?"left":"right"),f))},r}();t.uiDragndrop=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i,s,o,u,a){var f=e.grid.renderState,l=e.grid.rowType,c=s.type,h=null;r<this._wijgrid._virtualLeaves().length&&(i=null);if(c===16||c===32)i=null,u&&(h=u.groupInfo)&&(i=this._wijgrid._leaves()[h.leafIndex]);var p={$cell:t,state:o,row:s,column:i&&i.options,_cellIndex:r,_purpose:h?h.purpose:undefined};o&1?this._renderingStateFormatter(p,u,a):(this._currentStateFormatter(p,o&2),this._selectedStateFormatter(p,o&8),c!==1&&(o&2||o&8?p.$cell.addClass(this._wijgrid.options.wijCSS.stateDefault):p.$cell.removeClass(this._wijgrid.options.wijCSS.stateDefault))),n.isFunction(this._wijgrid.options.cellStyleFormatter)&&this._wijgrid.options.cellStyleFormatter(p)},t.prototype._renderingStateFormatter=function(t,n,r){var i=e.grid.rowType,s,o,u=t.column,a=t.row.type,f=e.grid.wijgrid.CSS,l=this._wijgrid.options.wijCSS;switch(a){case 1:t.$cell.addClass(f.TH+" "+l.wijgridTH);break;default:t.$cell.addClass(f.TD+" "+l.wijgridTD)}if(a&2&&u&&u.textAlignment)switch(u.textAlignment.toLowerCase()){case"left":t.$cell.addClass(f.cellAlignLeft+" "+l.wijgridCellAlignLeft);break;case"right":t.$cell.addClass(f.cellAlignRight+" "+l.wijgridCellAlignRight);break;case"center":t.$cell.addClass(f.cellAlignCenter+" "+l.wijgridCellAlignCenter)}if(n)for(s in n)if(n.hasOwnProperty(s)){o=n[s];if(!(s!=="groupInfo"&&s!=="colSpan"&&s!=="rowSpan"||o>1))continue;s==="class"?t.$cell.addClass(o):t.$cell.attr(s,o)}if(r)for(s in r)if(r.hasOwnProperty(s)){if(s==="paddingLeft"){t.$cell.children("."+f.cellContainer).css(s,r[s]);continue}t.$cell.css(s,r[s])}if(t._cellIndex<this._wijgrid._virtualLeaves().length)t.$cell.attr({role:"rowheader",scope:"row"}).addClass(l.stateDefault+" "+l.content+" "+f.rowHeader+" "+l.wijgridRowHeader);else switch(a){case 1:t.$cell.attr({role:"columnheader",scope:"col"});break;case 64:t.$cell.attr({role:"gridcell",scope:"col"});break;default:t.$cell.attr("role","gridcell")}a&2&&t._cellIndex>=0&&u&&(t.$cell.attr("headers",window.escape(u.headerText)),u.readOnly&&t.$cell.attr("aria-readonly",!0),u.dataIndex>=0&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))),(a===16||a===32)&&u&&t._purpose===1&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))},t.prototype._currentStateFormatter=function(t,n){var r=e.grid.rowType,i=e.grid.wijgrid.CSS,s=this._wijgrid.options.wijCSS;n?(t.$cell.addClass(s.stateActive),t.row.type===1?t.$cell.addClass(i.currentHeaderCell+" "+s.wijgridCurrentHeaderCell):t.$cell.addClass(i.currentCell+" "+s.wijgridCurrentCell)):(t.$cell.removeClass(s.stateActive),t.row.type===1?t.$cell.removeClass(i.currentHeaderCell+" "+s.wijgridCurrentHeaderCell):t.$cell.removeClass(i.currentCell+" "+s.wijgridCurrentCell))},t.prototype._hoveredStateFormatter=function(e,t){t},t.prototype._selectedStateFormatter=function(e,t){var n=this._wijgrid.options.wijCSS;t?e.$cell.addClass(n.stateHighlight).attr("aria-selected","true"):e.$cell.removeClass(n.stateHighlight).removeAttr("aria-selected")},t}();t.cellStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i){var s=e.grid.renderState,o=e.grid.rowType,u=t.state,a=t;u&1?this._renderingStateFormatter(a,r,i):(this._currentStateFormatter(a,(u&2)!==0),this._hoveredStateFormatter(a,(u&4)!==0),this._selectedStateFormatter(a,(u&8)!==0)),n.isFunction(this._wijgrid.options.rowStyleFormatter)&&this._wijgrid.options.rowStyleFormatter(a),u&1&&a.$rows[0].style.height&&a.$rows.each(function(){n.data(this,"customHeight",this.style.height)})},t.prototype._groupFormatter=function(t){var n=e.grid.renderStateEx,r=t._extInfo,i=e.grid.wijgrid.CSS,s=this._wijgrid.options.wijCSS;r.state&1?t.$rows.css("display","none"):t.$rows.css("display","");if(t.type&16){var o=this._wijgrid._groupedLeaves()[t._extInfo.groupLevel-1].options.groupInfo,u=o.expandedImageClass||s.iconArrowRightDown,a=o.collapsedImageClass||s.iconArrowRight,f=e.grid.rowAccessor.getCell$(t.$rows,this._wijgrid._showRowHeader()?1:0).find("."+i.groupToggleVisibilityButton);r.state&2?(t.$rows.attr("aria-expanded",!1),t.$rows.removeClass(i.groupHeaderRowExpanded+" "+s.wijgridGroupHeaderRowExpanded).addClass(i.groupHeaderRowCollapsed+" "+s.wijgridGroupHeaderRowCollapsed),f.removeClass(u).addClass(a)):(t.$rows.attr("aria-expanded",!0),t.$rows.removeClass(i.groupHeaderRowCollapsed+" "+s.wijgridGroupHeaderRowCollapsed).addClass(i.groupHeaderRowExpanded+" "+s.wijgridGroupHeaderRowExpanded),f.removeClass(a).addClass(u))}},t.prototype._masterFormatter=function(t){var n=e.grid.wijgrid.CSS,r=this._wijgrid.options.wijCSS,i=t.$rows.find("."+n.groupToggleVisibilityButton),s=r.iconArrowRightDown,o=r.iconArrowRight;t._extInfo.state&2?(t.$rows.attr("aria-expanded",!1),i.removeClass(s).addClass(o)):(t.$rows.attr("aria-expanded",!0),i.removeClass(o).addClass(s))},t.prototype._renderingStateFormatter=function(t,r,i){var s=e.grid.wijgrid.CSS,o=this._wijgrid.options.wijCSS,u,a=s.row+" "+o.wijgridRow+" "+o.content,f=e.grid.rowType,l=e.grid.renderStateEx,c;n.each(t.$rows,function(e,t){n(t).children().length>0&&n(t).attr("role","row")});if(r)for(c in r)r.hasOwnProperty(c)&&(c==="class"?t.$rows.addClass(r[c]):t.$rows.attr(c,r[c]));if(i)for(c in i)i.hasOwnProperty(c)&&t.$rows.css(c,i[c]);t._extInfo.groupLevel&&t.$rows.attr("aria-level",t._extInfo.groupLevel),t._extInfo.state&1&&t.$rows.css("display","none");switch(t.type&-773){case 1:u=s.headerRow+" "+o.wijgridHeaderRow;break;case 2:u=a+" "+s.dataRow+" "+o.wijgridDataRow,t.type&4&&(u+=" "+s.altRow+" "+o.wijgridAltRow);break;case 128:u=a+" "+s.emptyDataRow+" "+o.wijgridEmptyDataRow;break;case 8:u=s.filterRow+" "+o.wijgridFilterRow;break;case 16:n(t.$rows.last()).attr({id:"GH"+t._extInfo.groupIndex+"-"+t._extInfo.groupLevel,"aria-expanded":(t._extInfo.state&2)===0}),u=a+" "+s.groupHeaderRow+" "+o.wijgridGroupHeaderRow+" ",u+=t._extInfo.state&2?s.groupHeaderRowCollapsed+" "+o.wijgridGroupHeaderRowCollapsed:s.groupHeaderRowExpanded+" "+o.wijgridGroupHeaderRowExpanded;break;case 32:n(t.$rows.last()).attr("id","GF"+t._extInfo.groupIndex+"-"+t._extInfo.groupLevel),u=a+" "+s.groupFooterRow+" "+o.wijgridGroupFooterRow;break;case 1024:u=a+" "+s.detailRow+" "+o.wijgridDetailRow;break;case 64:u=s.footerRow+" "+o.wijgridFooterRow+" "+o.stateDefault+" "+o.stateHighlight;break;default:throw e.grid.stringFormat("unknown rowType: {0}",t.type)}t.$rows.addClass(u)},t.prototype._currentStateFormatter=function(t,r){if(this._wijgrid._showRowHeader()){var i=this._wijgrid.options.wijCSS,s=e.grid.wijgrid.CSS;r?n(t.$rows[0].cells[0]).addClass(i.stateActive+" "+s.currentRowHeaderCell+" "+i.wijgridCurrentRowHeaderCell):n(t.$rows[0].cells[0]).removeClass(i.stateActive+" "+s.currentRowHeaderCell+" "+i.wijgridCurrentRowHeaderCell)}},t.prototype._hoveredStateFormatter=function(e,t){var n=this._wijgrid.options.wijCSS;t?e.$rows.addClass(n.stateDefault+" "+n.stateHover):(e.$rows.removeClass(n.stateDefault+" "+n.stateHover),e.type&2&&e.$rows.addClass(n.wijgridDataRow))},t.prototype._selectedStateFormatter=function(e,t){t},t}();t.rowStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function r(e){this._sum=0,this._sum2=0,this._cntNumbers=0,this._cntStrings=0,this._cntDates=0,this._max=0,this._min=0,this._minDate=0,this._maxDate=0,this._parser=e}return r.getValueString=function(e,t,n){var r=t.options;return typeof e!="string"&&(r.aggregate==="count"&&r.dataType!=="number"&&(r={dataType:"number",dataFormatString:"n0"}),e=n.toStr(r,e)),e},r.prototype.add=function(t){if(t===null)return;var n=t instanceof Date?"datetime":typeof t,r=t.toString();this._cntStrings++===0&&(this._minString=this._maxString=r),r<this._minString&&(this._minString=r),r>this._maxString&&(this._maxString=r);var i=this._parseValue(t);typeof i=="number"&&!e.grid.isNaN(i)?(t=i,this._cntNumbers++===0&&(this._min=this._max=t),this._sum+=t,this._sum2+=t*t,t<this._min&&(this._min=t),t>this._max&&(this._max=t)):n==="datetime"&&(r=t.getTime(),this._cntDates++===0&&(this._minDate=this._maxDate=r),r<this._minDate&&(this._minDate=r),r>this._maxDate&&(this._maxDate=r))},r.prototype.getValue=function(e){var t=e.options;if(!this._cntNumbers||t.dataType!=="number"&&t.dataType!=="currency"&&this._cntNumbers!=this._cntStrings){if(this._cntDates&&t.dataType==="datetime")switch(t.aggregate){case"max":return new Date(this._maxDate);case"min":return new Date(this._minDate);case"count":return this._cntStrings}if(this._cntStrings)switch(t.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings}return""}return this._getValue(t.aggregate)},r.prototype._parseValue=function(e){var r=typeof e;if(r==="number")return e;if(r==="string"&&n.trim(e)==="")return 0;if(this._parser){var i;try{i=this._parser.parse({dataType:"currency"},e)}catch(s){i=NaN}t.isNaN(i)&&(i=parseFloat(e));if(!t.isNaN(i))return i}return e},r.prototype._getValue=function(e){switch(e){case"average":return this._cntNumbers===0?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("var"));case"stdPop":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("varPop"));case"var":if(this._cntNumbers<=1)return 0;return this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1)return 0;var t=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-t*t}return 0},r}();t.tally=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function r(t){this._docEventsUID="wijgridfrozener"+e.grid.getUID(),this._docEventsAttached=!1,this._newStaticIndex=-1,this._staticColumnIndex=-1,this._staticRowIndex=-1,this._staticOffsetH=0,this._staticOffsetV=0,this._inProgress=!1,this._wijgrid=t,this.refresh()}return r.prototype.inProgress=function(){return this._inProgress},r.prototype.refresh=function(){this.dispose();var t=this._wijgrid._lgGetFreezingMode();if(t!=="none"&&this._wijgrid._lgGetScrollMode()!=="none"){this._$outerDiv=this._wijgrid.mOuterDiv.find("."+e.grid.wijgrid.CSS.fixedView),this._superPanel=this._wijgrid._view()._getSuperPanel(),this._staticOffsetH=this._wijgrid._getStaticOffsetIndex(!1),this._staticOffsetV=this._wijgrid._getStaticOffsetIndex(!0),this._staticColumnIndex=this._wijgrid._getStaticIndex(!1),this._staticRowIndex=this._wijgrid._getStaticIndex(!0),this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds();var n=e.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw")),r=e.grid.bounds(this._$outerDiv);(t==="both"||t==="columns")&&(this._wijgrid._lgGetStaticColumnsAlignment()!=="right"||this._staticColumnIndex>=0)&&this._createVBar(this._visibleBounds,n,r),(t==="both"||t==="rows")&&!this._wijgrid._serverSideVirtualScrolling()&&this._createHBar(this._visibleBounds,n,r)}},r.prototype.ensureVBarHeight=function(){if(this._$vBar){var t=e.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw"));this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds(),this._$vBar.height(this._visibleBounds.height+this._visibleBounds.top-t.top)}},r.prototype.dispose=function(){this._$hBar&&(this._$hBar.remove(),this._$hBar=null),this._$vBar&&(this._$vBar.remove(),this._$vBar=null),this._$proxy&&(this._$proxy.remove(),this._$proxy=null),this._$outerDiv=null,this._superPanel=null,this._detachDocEvents()},r.prototype._createVBar=function(t,r,i){var s=this._wijgrid._lgGetStaticColumnsAlignment()!=="right",o=s?r.width+r.left:r.left-2,u=this,a=e.grid.wijgrid.CSS,f=this._wijgrid.options.wijCSS;o<=t.left+t.width&&(this._$vBar=n("<div><div></div></div>").addClass(a.freezingHandleV+" "+f.wijgridFreezingHandleV).addClass(s?"":"not-allowed").css({left:o-i.left,top:r.top-i.top,height:t.height+t.top-r.top}).bind("mousedown",function(e){e.data=!0,u._onBarMouseDown.apply(u,arguments)}).appendTo(this._$outerDiv),this._$vBar.find("div").addClass(a.freezingHandleContent+" "+f.header))},r.prototype._createHBar=function(t,r,i){var s=r.top+r.height,o=this._wijgrid._lgGetStaticColumnsAlignment()!=="right",u=this,a=e.grid.wijgrid.CSS,f=this._wijgrid.options.wijCSS;s<=t.top+t.height&&(this._$hBar=n("<div><div></div></div>").addClass(a.freezingHandleH+" "+f.wijgridFreezingHandleH).css({left:o?r.left-i.left:0,top:s-i.top,width:o?t.width+t.left-r.left:t.width}).bind("mousedown",function(e){e.data=!1,u._onBarMouseDown.apply(u,arguments)}).appendTo(this._$outerDiv),this._$hBar.find("div").addClass(a.freezingHandleContent+" "+f.header))},r.prototype._onBarMouseDown=function(t){if(this._wijgrid.options.disabled||this._wijgrid._lgGetStaticColumnsAlignment()==="right"&&t.data)return!1;var r=e.grid.wijgrid.CSS,i=this._wijgrid.options.wijCSS;this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds(),this._newStaticIndex=t.data?this._staticColumnIndex:this._staticRowIndex,this._$proxy=n('<div class="'+r.resizingHandle+" "+i.wijgridResizingHandle+" "+i.header+'"></div>').appendTo(document.body),this._attachDocEvents(t.data),this._inProgress=!0,t.stopPropagation()},r.prototype._onDocumentMouseMove=function(e){e.data&&this._superPanel.options.hScroller.scrollValue?this._superPanel.hScrollTo(0):!e.data&&this._superPanel.options.vScroller.scrollValue&&this._superPanel.vScrollTo(0),this._showPosition(e)},r.prototype._onDocumentMouseUp=function(e){try{this._$proxy&&this._$proxy.remove(),this._detachDocEvents(),e.data?this._newStaticIndex!==this._staticColumnIndex&&this._wijgrid.option("staticColumnIndex",this._newStaticIndex):this._newStaticIndex!==this._staticRowIndex&&this._wijgrid.option("staticRowIndex",this._newStaticIndex)}finally{this._$proxy=null,this._inProgress=!1}},r.prototype._attachDocEvents=function(e){if(!this._docEventsAttached)try{n.fn.disableSelection&&n(document.body).disableSelection(),this._wijgrid._view().toggleDOMSelection(!1),n(document).bind(this._docEventKey("mousemove"),e,n.proxy(this._onDocumentMouseMove,this)).bind(this._docEventKey("mouseup"),e,n.proxy(this._onDocumentMouseUp,this))}finally{this._docEventsAttached=!0}},r.prototype._detachDocEvents=function(){if(this._docEventsAttached)try{n.fn.enableSelection&&n(document.body).enableSelection(),this._wijgrid._view().toggleDOMSelection(!0),n(document).unbind("."+this._docEventsUID)}finally{this._docEventsAttached=!1}},r.prototype._docEventKey=function(t){return e.grid.stringFormat("{0}.{1}",t,this._docEventsUID)},r.prototype._showPosition=function(t){var n,r,i,s,o,u,a,f,l=this._wijgrid._lgGetStaticColumnsAlignment()!=="right";if(t.data){f=e.grid.bounds(this._$vBar);if(Math.abs(t.pageX-(f.left+f.width/2))<f.width){this._$proxy.hide();return}if(n=this._getFieldByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n.element),i=r.left+r.width/2,s=n.column.options._visLeavesIdx-this._staticOffsetV,o=Math.max(s-1,-1),u=t.pageX<i?o!==this._staticColumnIndex:s===this._staticColumnIndex,a=u?r.left:r.left+r.width;if(!e.grid.isOverAxis(a,this._visibleBounds.left-1,this._visibleBounds.width+3))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:a,top:r.top,width:3,height:this._visibleBounds.height+this._visibleBounds.top-r.top})}}else{f=e.grid.bounds(this._$hBar);if(Math.abs(t.pageY-(f.top+f.height/2))<f.height){this._$proxy.hide();return}var c;if(c=this._getRowByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(c),i=r.top+r.height/2,s=this._wijgrid._view().getAbsoluteRowIndex(c)-this._staticOffsetH,o=Math.max(s-1,-1),u=t.pageY<i?o!==this._staticRowIndex:s===this._staticRowIndex,a=u?r.top:r.top+r.height;if(!e.grid.isOverAxis(a,this._visibleBounds.top-1,this._visibleBounds.height+3))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:l?r.left:this._visibleBounds.left,top:a,width:l?this._visibleBounds.width+this._visibleBounds.left-r.left:this._visibleBounds.width,height:3})}}},r.prototype._getFieldByPos=function(r){var i=this._wijgrid.columns(),s=undefined;for(var o=0,u=i.length;o<u;o++){var a=i[o],f=a.options;if(f._isLeaf){var l=null,c;if(a.element)l=e.grid.bounds(c=a.element);else{s==undefined&&(s=this._wijgrid._rows().find(0,function(e){return(e.type&2)!==0}));if(s){var h=t.rowAccessor.getCell(s.$rows,f._visLeavesIdx);h&&(l=e.grid.bounds(c=n(h)))}}if(l&&e.grid.isOverAxis(r.x,l.left,l.width))return{column:a,element:c}}}return null},r.prototype._getRowByPos=function(t){var r=this._wijgrid._rows();for(var i=0,s=r.length();i<s;i++){var o=r.item(i)[0],u=e.grid.bounds(n(o));if(e.grid.isOverAxis(t.y,u.top,u.height))return o}return null},r}();t.uiFrozener=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function r(){}return r.generate=function(t,n,i){t=(t||"").toLowerCase();switch(t){case"append":r._processAppendMode(n,i);break;case"merge":r._processMergeMode(n,i);break;case"none":break;default:throw e.grid.stringFormat('Unsupported value: "{0}"',t)}},r._processAppendMode=function(t,i){var s={};e.grid.traverse(i,function(t){t._dynamic&&e.grid.validDataKey(t.dataKey)&&(s[t.dataKey]=!0)}),n.each(t,function(e,t){"name"in t&&!s[t.name]&&i.push(r._createAutoField(t))})},r._processMergeMode=function(t,i){var s=[];e.grid.traverse(i,function(n){if(n._isLeaf&&r._isBindableColumn(n)){var i=n.dataKey;e.grid.validDataKey(i)?t[i]!==undefined&&delete t[i]:i!==null&&s.push(n)}});if(s.length){var o=0;n.each(t,function(e,n){var r=s[o++];r&&(r.dataKey=n.name,delete t[e])})}n.each(t,function(e,t){i.push(r._createAutoField(t))})},r._createAutoField=function(t){return e.grid.createDynamicField({dataKey:t.name})},r._isBindableColumn=function(e){return!t.c1bandfield.test(e)&&!t.c1rowheaderfield.test(e)&&!t.c1buttonbasefield.test(e)&&!t.c1buttonfield.test(e)&&!t.c1commandbuttonfield.test(e)},r}();t.columnsGenerator=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=jQuery,n=function(){function n(e,t,n,r){this._timer=0,this._timeout=50,this._ignoreScrollEvents=!1,this._debounceScrolledEvent=!0,this.mScrollLeftPos=undefined,this.mScrollTopPos=undefined,this.mVertical=!1,this.mHorizontal=!1,this._wijgrid=e,this.mVertical=e._allowVVirtualScrolling(),this.mHorizontal=e._allowHVirtualScrolling(),this._$content=t,this._view=this._wijgrid._view();if(this.mVertical){this._N=this._wijgrid._renderableRowsCount(),this._rowOuterHeight=r,this._updateContentHeight();var i=this._wijgrid.mOuterDiv.height()+this._N*this._rowOuterHeight;this._view._splitAreas.sw.height(i)}}return n.prototype.scrollToColumn=function(e,t,n){this._debounceScrolledEvent=!1,this._completeListener=n,this._panelInst.hScrollTo(t,!1)},n.prototype.scrollToRow=function(e,t){this._debounceScrolledEvent=!1,this._completeListener=t,this._panelInst.vScrollTo(e*this._panelInst.options.vScroller.scrollSmallChange,!0)},n.prototype._updateContentHeight=function(){this._$content.height(this._rowOuterHeight*this._N)},n.prototype.attach=function(e){this._$scroller=e,this._panelInst=e.data("wijmo-wijsuperpanel"),this.mVertical&&(this._updateContentHeight(),this._updateVerticalScroller()),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelScrolled,this)),e.bind("wijsuperpanelscrolling.wijgrid",t.proxy(this._onSuperpanelScrolling,this)),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelPostScrolled,this))},n.prototype._updateVerticalScroller=function(){var e=Math.max(0,this._N-this._view.getVirtualPageSize(!1));this._setVerticalScrollerOptions(1,e)},n.prototype._setVerticalScrollerOptions=function(e,t){var n=this._panelInst.options.vScroller;n.scrollSmallChange=e,n.scrollLargeChange=e*4,t<=n.scrollLargeChange?n.scrollLargeChange=t:t+=n.scrollLargeChange-1,n.scrollMax=t,this._panelInst.option("vScroller",n);if(!this._view._isNativeSuperPanel()&&this._panelInst._scrollDrag!=undefined){var r=this._panelInst._fields(),i=r.vbarContainer,s=r.vbarDrag;this._panelInst._scrollDrag("v",i,s,!1)}},n.prototype._changeVisibleRowsCount=function(e){this._N=e,this._updateContentHeight(),this._updateVerticalScroller()},n.prototype.dispose=function(){this._$scroller.unbind(".wijgrid"),this._clearTimer()},n.prototype._clearTimer=function(){window.clearTimeout(this._timer),this._timer=0},n.prototype._onSuperpanelScrolling=function(e,t){if(this._ignoreScrollEvents||t.dir==="v"&&!this.mVertical||t.dir==="h"&&!this.mHorizontal)return;if(this._timer===-1)return!1},n.prototype._onSuperpanelScrolled=function(n,r){var i=this;if(this._ignoreScrollEvents||r.dir==="v"&&!this.mVertical||r.dir==="h"&&!this.mHorizontal)return;this._timer>0&&this._clearTimer(),this._timer!==-1&&(this._timer=window.setTimeout(function(){i._timer=-1;var n=!1,s=-r.afterPosition.left,o;if(r.dir==="h"){var o=new e.renderableColumnsCollection;i._view._getRenderableColumnsBounds(o,s),n=!i._wijgrid._renderableColumnsRange().equals(o)}else{var u=Math.floor(r.newValue/i._panelInst.options.vScroller.scrollSmallChange),a=i._view._bounds.start;u<0&&(u=0),u>=i._N&&(u=i._N-1)}u!==a||n?(i._debounceScrolledEvent=!0,r.dir==="v"&&i.mVertical?i._wijgrid._handleVerticalVirtualScrolling(u,null,t.proxy(i._verticalScrollingCompleted,i)):i._wijgrid._handleHorizontalVirtualScrolling(o,t.proxy(i._horizontalScrollingCompleted,i))):(i._debounceScrolledEvent=!0,i._log(),i._clearTimer())},this._debounceScrolledEvent?this._timeout:0))},n.prototype._verticalScrollingCompleted=function(e){this._wijgrid._trackScrollingIndex(e),this._log(),this._completeListener&&(this._completeListener(),this._completeListener=null),this._clearTimer()},n.prototype._horizontalScrollingCompleted=function(){this._log(),this._completeListener&&(this._completeListener(),this._completeListener=null),this._clearTimer()},n.prototype._onSuperpanelPostScrolled=function(){t.isFunction(this._postScrolled)&&this._postScrolled.apply(this,arguments)},n.prototype._log=function(){},n}();e.uiVirtualScroller=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=function(){function e(){this.mItems=[]}return e.prototype.add=function(e,t){var n,r;arguments.length===1?this.mItems.push(e):this.mItems.push({start:e,end:t})},e.prototype.item=function(e){return this.mItems[e]},e.prototype.clear=function(){this.mItems=[]},e.prototype.contains=function(e){e&&e.options&&(e=e.options._leavesIdx);if(e||e===0)for(var t=0;t<this.mItems.length;t++){var n=this.mItems[t];if(n.start>=0&&e>=n.start&&e<=n.end)return!0}return!1},e.prototype.equals=function(e){if(this===e)return!0;var t=this.length();if(!e||t!==e.length())return!1;var n=!0;for(var r=0;r<t&&n;r++){var i=this.item(r),s=e.item(r);n=i.start===s.start&&i.end===s.end}return n},e.prototype.length=function(){return this.mItems.length},e.prototype.forEachIndex=function(e){for(var t=0;t<this.mItems.length;t++){var n=this.mItems[t];if(n&&n.start>=0)for(var r=n.start;r<=n.end;r++)if(e(r)===!1)return}},e}();e.renderableColumnsCollection=t;var n=function(){function e(e){this._items=[],this._capacity=null,this._maxRowIndex=e}return e.prototype.add=function(e){this._capacity=null;var t=this._items.length,n;if(!t||(n=this._items[t-1]).end<e.start)t&&e.start-n.end===1?n.end=e.end:this._items.push(e);else{var r=this._binSearchByStartVal(e.start),i=this._binSearchByEndVal(e.end),s=r<0?~r:r,o=i<0?~i:i,u=r>=0||s>0&&e.start<=this._items[s-1].end,a=i>=0||o<t&&e.end<=this._items[o].end&&e.end>=this._items[o].start,f;u?a?r>=0?(this._items[o].start=this._items[s].start,(f=o-s)&&this._items.splice(s,f)):(this._items[o].start=this._items[s-1].start,(f=o-s+1)&&this._items.splice(s-1,f)):r>=0?(this._items[s].end=e.end,(f=o-s-1)&&this._items.splice(s,f)):(this._items[s-1].end=e.end,(f=o-s)&&this._items.splice(s,f)):a?(this._items[o].start=e.start,(f=o-s)&&this._items.splice(s,f)):this._items.splice(s,o-s,e)}},e.prototype.item=function(e){return this._items[e]},e.prototype.forEachIndex=function(e,t,n){if(e<0)return;var r=this._items.length,i=this._getIteratorStateFor(e),s=0,o=!0,u=!1;if(i){var a=i.j;for(var f=i.i;f<r&&!u;f++){var l=this._items[f];o||(a=l.start);for(a;a<=l.end&&!u;a++){if(++s>t&&t!==-1)return;u=n(a)===!1}o=!1}}},e.prototype.forEachIndexBackward=function(e,t,n){if(e<0)return;var r=this._items.length,i=this._getIteratorStateFor(e),s=0,o=!0,u=!1;if(i){var a=i.j;for(var f=i.i;f>=0&&!u;f--){var l=this._items[f];o||(a=l.end);for(a;a>=l.start&&!u;a--){if(++s>t&&t!==-1)return;u=n(a)===!1}o=!1}}},e.prototype._getIteratorStateFor=function(e){var t=this._items.length,n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1;var s=n-e;if(s>=0)return{i:r,j:i.end-s+1}}return null},e.prototype.getAbsIndex=function(e){for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t],i=r.end-r.start;if(e<=i)return r.start+e;e-=i+1}return-1},e.prototype.getRenderedIndex=function(e){var t=this.hasAbsIndex(e);if(t>=0){var n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1}return n+(e-this._items[t].start)}return-1},e.prototype.hasAbsIndex=function(e){if(this._items.length){var t=this._binSearchByStartVal(e);if(t>=0)return t;t=~t;if(t>0&&e<=this._items[t-1].end)return t-1}return-1},e.prototype.length=function(){return this._items.length},e.prototype.capacity=function(){if(this._capacity===null){var e=0;for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t];e+=r.end-r.start+1}this._capacity=e}return this._capacity},e.prototype.truncateByStart=function(e,t){var n=this._binSearchByStartVal(e),r=this._items.length;n<0?(n=~n,n<r?n>0&&this._items[n-1].end>=e?(this._items[n-1].start=e,this._items.splice(0,n-1)):(t&&(this._items[n].start=e),this._items.splice(0,n)):this._items=[]):this._items.splice(0,n)},e.prototype._binSearchByStartVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].start-e;if(i===0)return r;i<0?t=r+1:n=r-1}return~t},e.prototype._binSearchByEndVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].end-e;if(i<0)t=r+1;else{if(!i)return r;n=r-1}}return~t},e}();e.renderableRowsCollection=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=function(){function e(){}return e.build=function(e){if(e._hasDetail()){var t=e.mSketchTable;t.ensureNotLazy(),e._clearDetails();if(!e._isRoot()){var n=e._masterInfo(),r=n.master.details()[n.dataRowIndex];r._setDetails(e.details())}for(var i=0;i<t.count();i++){var o=t.row(i),u=this.buildDetailRow(e),a=new s(e,o.originalRowIndex);e.details().push(a),o.rowType|=256,a.isExpanded()||(o.extInfo.state|=2,u.extInfo.state|=1),t.insert(i+1,u),i++}}},e.buildDetailRow=function(e){var r=new t.SketchDetailRow(null);return n.each(e._virtualLeaves(),function(){r.add(t.HtmlCell.nbsp())}),r.add(new t.HtmlCell("",{colSpan:e._visibleLeaves().length-e._virtualLeaves().length})),r},e}();t.hierarchyBuilder=r;var i=function(){function r(){}return r.instantiateIn=function(e,i,s,o){var u=n("<table></table>");e.empty().append(u);var a=r._populateDetail(i),f={master:i,dataRowIndex:o},l={options:a,masterKey:s};return i._onDetailCreating(l),u.data(t.wijgrid.JQDATA_MASTER_INFO_KEY,f).wijgrid(l.options),u.wijgrid("instance")},r._populateDetail=function(t){var r,i=t.options.detail,s=e.grid.DataOptionPersister.persistAndClear(i);r=n.extend(!0,{},i),e.grid.DataOptionPersister.restore(i,s),e.grid.DataOptionPersister.restore(r,s),r._isDetail=!0,r.disabled=t.options.disabled;if(!!r.data&&!n.isArray(r.data)){if(typeof r.data.clone!="function")throw"Unsupported data source.";r.data=r.data.clone()}return r},r}();t.detailInstantiator=i;var s=function(){function n(e,t){this.mIsExpanded=undefined,this.mDetail=null,this.mOwner=e,this.mDataRowIndex=t}return n.prototype.details=function(){return this.mDetails||(this.mDetails=[]),this.mDetails},n.prototype.collapse=function(){var n=this.mOwner._view(),r=this._masterDataRow(),i=n.bodyRows().item(n._getRowInfo(r).sectionRowIndex+1);this._toggleDataRow(r,!1),this._toggleDetailRow(i,!1);var s=e.grid.wijgrid.CSS,o=t.rowObjToJQuery(i).find("."+s.detailContainerCell+":first > ."+s.cellContainer);o.empty(),this._setGrid(null),this.mDetails&&this.mDetails.splice(0,this.mDetails.length);var u=this.mOwner,a=[];do a.unshift(u);while(u=u._master());while(u=a.shift())u._setSizeWithoutDetails();this.mIsExpanded=!1},n.prototype.expand=function(){var n=this.mOwner._view(),r=this._masterDataRow(),s=n.bodyRows().item(n._getRowInfo(r).sectionRowIndex+1);this._toggleDataRow(r,!0),this._toggleDetailRow(s,!0);var o=e.grid.wijgrid.CSS,u=t.rowObjToJQuery(s).find("."+o.detailContainerCell+":first > ."+o.cellContainer);this.mOwner.mLoadingDetails++,i.instantiateIn(u,this.mOwner,this.masterKey(),this.mDataRowIndex),this.mIsExpanded=!0},n.prototype.isExpanded=function(){return this.mIsExpanded===undefined?this.mOwner.options.detail.startExpanded:this.mIsExpanded},n.prototype.grid=function(){return this.mDetail},n.prototype.masterKey=function(){var e={},t=this.mOwner._getDataItem(this.mDataRowIndex),n=this.mOwner.options.detail;for(var r=0;r<n.relation.length;r++){var i=n.relation[r];e[i.masterDataKey.toLowerCase()]=this.mOwner.mDataViewWrapper.getValue(t,i.masterDataKey)}return e},n.prototype._setDetails=function(e){this.mDetails=e},n.prototype._setGrid=function(e){this.mDetail=e},n.prototype._masterHierarchyNode=function(){if(this.mOwner){var e=this.mOwner._masterInfo();if(e.master)return e.master.details()[e.dataRowIndex]}return null},n.prototype._masterDataRowIndex=function(){return this.mDataRowIndex},n.prototype._masterDataRow=function(){var e=this,t=this.mOwner._rows().findRowObj(0,function(t){return t.dataRowIndex==e.mDataRowIndex});return t},n.prototype._toggleDataRow=function(e,t){var n=this.mOwner._view(),r=n._getRowInfo(e),i=this.mOwner.mSketchTable.row(r.sketchRowIndex);t?(i.extInfo.state&=-3,r._extInfo.state&=-3):(r._extInfo.state|=2,i.extInfo.state|=2),n._setRowInfo(r.$rows,r),this.mOwner.mRowStyleFormatter._masterFormatter(r)},n.prototype._toggleDetailRow=function(e,t){var n=this.mOwner._view(),r=n._getRowInfo(e),i=this.mOwner.mSketchTable.row(r.sketchRowIndex);t?(i.extInfo.state&=-2,r._extInfo.state&=-2):(r._extInfo.state|=1,i.extInfo.state|=1),n._setRowInfo(r.$rows,r),t?r.$rows.show():r.$rows.hide()},n}();t.hierarchyNode=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function r(n,r,i,s){function u(t){return s.parser=s.parser||e.defaultParsers[t],!s.parser&&n!=null&&e.errors.noParser(t),s.parser}var o=n;s=t.extend({nullString:"",format:""},s),r=r||n!=null&&typeof n,i=i||r;if(!i)return n;if(i=="string")return u(r),s.parser?s.parser.toStr(n,s.culture,s.format,s.nullString,!0):n;u(i);if(!s.parser)return n;n=s.parser.parse(n,s.culture,s.format,s.nullString,!0);if(isNaN(n)&&n!=null&&e.util.isNumeric(n)){if(s.ignoreError)return o;e.errors.cantConvert(i,o)}return n}function i(t){return function(){return n||e.util.logError(e.errors.noGlobalize.create().message),t.apply(this,arguments)}}var t=jQuery,n=Globalize;e.convert=r,e.defaultParsers={string:{parse:function(e,t,n,r,i){switch(e){case null:return null;case r:if(i)return null;case undefined:case"&nbsp":return"";default:return""+e}},toStr:function(e,t,n,r,i){return e===null&&i?r:""+e}},number:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:n.parseFloat(e,10,t)},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"n",t)}},currency:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:(o==="string"&&(e=e.replace(t.numberFormat.currency.symbol,"")),n.parseFloat(e,10,t))},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"c",t)}},datetime:{parse:function(e,t,r,i,s){var o;if(e instanceof Date)return e;if(!e||e==="&nbsp;"||e===i&&s)return null;o=/^\/Date\((\d+)\)\/$/.exec(e);if(o)return new Date(parseInt(o[1],10));var u=n.parseDate(e,r||"d",t);if(u==null||isNaN(u))u=Date.parse(e),u=isNaN(u)?NaN:new Date(u);return u},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"d",t)}},"boolean":{parse:function(e,n,r,i,s){var o=typeof e;if(o==="number")return e!=0;if(o==="boolean")return e;o==="string"&&(e=t.trim(e));if(!e||e==="&nbsp;"||e===i&&s)return null;switch(e.toLowerCase()){case"true":return!0;case"false":return!1}return NaN},toStr:function(e,t,n,r,i){return e===null&&i?r:e?"true":"false"}}},t.each(e.defaultParsers,function(e,t){t.parse=t.parse&&i(t.parse),t.toStr=t.toStr&&i(t.toStr)})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){(function(n){function r(r){function i(r){var s=[];if(r.length===0)return s;var o=n.Connective.AND;return e.util.each(r,function(r,u){if(r==0&&e.util.isString(u)){var a=u.toLowerCase();if(a==n.Connective.AND||a==n.Connective.OR){o=a;return}}if($.isArray(u)){u=i(u);if(!u)return;if(u[0]===o||u.length==2){u.shift(),s=s.concat(u);return}}else{var f=t.normalizeCondition(u);if(!f)return;f.property=u.property,u=f}s.push(u)}),s.length==0?null:(s.unshift(o),s)}return i(r)}function i(t){if(!$.isArray(t))return null;var i={isEmpty:!0,original:t,normalized:r(t),func:null};return i.normalized==null?i.func=function(e){return!0}:(i.isEmpty=!1,i.func=function(t){function r(i){var s=i[0]===n.Connective.AND,o=s?e.util.every:e.util.some;return o(i,function(n,i){if(i===0)return s;if($.isArray(n))return r(n);var o=e.util.getProperty(t,n.property);return n.op.apply(o,n.value)})}return r(i.normalized)}),i}function s(e){return i(e)||t.compile(e)}n.Connective={AND:"and",OR:"or"},n.compile=s})(t.extended||(t.extended={}));var n=t.extended})(e.filtering||(e.filtering={}));var t=e.filtering})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r=e.data,i=e.data.filtering.extended,s=function(){function e(e){this.real=e,this._updatingFilter=!1,this._overrideFilter(),this._makeMemberProxies()}return e.prototype._overrideFilter=function(){var e=this;this.filter=r.observable(this.real.filter()),this.filter.subscribe(function(t){e.real.filter()!==t&&!e._updatingFilter&&e.refresh({filter:t})}),this.real.filter.subscribe(function(t){t!==e._lastSetFilter&&e.filter(t)})},e.prototype.refresh=function(e,t){typeof t=="undefined"&&(t=!1),e=n.extend({},e);var r=e.filter;e.filter=this._coerceFilter(e.filter),this._lastSetFilter=e.filter,this._updatingFilter=!0;try{n.isFunction(e.filter)&&!n.isFunction(r)?this.filter(r):this.filter(e.filter)}finally{this._updatingFilter=!1}return this.real.refresh(e,t)},e.prototype._makeMemberProxies=function(){var e=this;r.util.each(this.real,function(t,r){if(!n.isFunction(r)||e[t]||t.charAt(0)==="_")return;e[t]=n.isFunction(r.subscribe)?r:function(){return r.apply(e.real,arguments)}})},e.create=function(t){return new e(t)},e.prototype._convertComplexPropertyFilterToExtendedFilterFormat=function(e){var t=[];return n.each(e,function(e,s){if(!n.isArray(s))s=[s];else{var o=r.util.isString(s[0])&&s[0].toLowerCase();if(o===i.Connective.AND||o===i.Connective.OR){t.push(s);return}}var u=[];n.each(s,function(t,n){var i=r.filtering.normalizeCondition(n);i&&(i.property=e,u.push(i))}),u.length>0&&t.push(u)}),t.length>0?t:null},e.prototype._coerceFilter=function(e){if(n.isArray(e))return i.compile(e).func;if(!n.isPlainObject(e))return e;e=n.extend(!0,{},e);var t={};n.each(e,function(i,s){n.isArray(s)||(s=[s]);if(t){var o=r.util.isString(s[0])&&s[0].toLowerCase();if(s.length==1||s.length==2&&(o==="and"||o==="or")){t[i]=s[s.length-1];return}}e[i]=s,t=null});if(t)return t;var s=this._convertComplexPropertyFilterToExtendedFilterFormat(e);return i.compile(s).func},e}();t.GridDataView=s;var o=function(e){function t(t){e.call(this,t),this.real=t}return __extends(t,e),t.create=function(e){return new t(e)},t.prototype._unsafeReplace=function(e,t){this.real.sourceArray[e]=t,this.real.local[e]=t},t.prototype._unsafeSplice=function(e,t,n){arguments.length===2?(this.real.sourceArray.splice(e,t),this.real.local.splice(e,t)):(this.real.sourceArray.splice(e,t,n),this.real.local.splice(e,t,n))},t.prototype._unsafePush=function(e){this.real.sourceArray.push(e),this.real.local.push(e)},t}(s);t.GridLocalDataDataView=o})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=function(t){function n(e){this.mObservableArray=e;var n=ko.utils.unwrapObservable(this.mObservableArray);t.call(this,n,null)}return __extends(n,t),n.validSource=function(e){return!!(ko&&ko.isObservable(e)&&$.isFunction(e.slice))},n.prototype.refresh=function(n,r){typeof r=="undefined"&&(r=!1),this.sourceArray=ko.utils.unwrapObservable(this.mObservableArray),this.mRefreshPlainValue=!0;var i=n&&n.pageSize!==undefined?n.pageSize:this.pageSize(),s=n&&n.pageIndex!==undefined?n.pageIndex:this.pageIndex();if(i>0&&s>0){var o=e.data.util.pageCount(this.sourceArray.length,i);s>=o&&(s=Math.max(0,o-1),n||(n={}),n.pageIndex=s)}return t.prototype.refresh.apply(this,[n,r])},n.prototype.getPlainSource=function(){return this.mRefreshPlainValue&&(this.mRefreshPlainValue=!1,this.mPlainArray=ko.toJS(this.sourceArray)),this.mPlainArray},n.prototype.dispose=function(){this.mObservableArray=null,this.mPlainArray=null,t.prototype.dispose.apply(this,arguments)},n.prototype.remove=function(e){var t=this._resolve(e,!1);return t?(this.mObservableArray.remove(t.item),!0):!1},n}(e.data.ArrayDataView);t.koDataView=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));