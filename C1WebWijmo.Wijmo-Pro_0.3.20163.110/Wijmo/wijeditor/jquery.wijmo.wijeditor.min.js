var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=jQuery,r="wijeditor",i=alert,s=window,o=document,u=parseInt,a=e.ribbon.wijribbonDataRender,f,l,c,h=[],p=null,d=!0,v=0,m=[],g=null,y="setButtonDisabled",b="setButtonsDisabled",w="setButtonChecked",E="setButtonsChecked",S="form",x="imagebutton",T="textarea",N="button",C="textbox",k="list",L="passwordfield",A="dropdownlist",O="hiddenfield",M="radio",_="checkbox",D="insertcol",P="insertrow",H="insertcell",B="splitcell",j="mergecell",F="deletecol",I="deleterow",q="deletecell",R="justifyleft",U="justifycenter",z="justifyright",W="justifyfull",X="borders",V="insertorderedlist",$="insertunorderedlist",J="outdent",K="indent",Q="backcolor",G="fontcolor",Y="bold",Z="italic",et="strikethrough",tt="underline",nt="subscript",rt="superscript",it="template",st="removeformat",ot="insertbreak",ut="insertparagraph",at="insertprintpagebreak",ft="inserthorizontalrule",lt="tablebutton",ct="inserttable",ht="edittable",pt="wysiwyg",dt="split",vt="code",mt="wordwrap",gt="fullscreen",yt="undo",bt="redo",wt="preview",Et="cleanup",St="cut",xt="copy",Tt="paste",Nt="selectall",Ct="media",kt="specialchar",Lt="datetime",At="find",Ot="inspect",Mt="save",_t="spelling",Dt="imagebrowser",Pt="link",Ht="xx-small",Bt="x-small",jt="small",Ft="medium",It="large",qt="x-large",Rt="xx-large",Ut="fontname",zt="fontsize",Wt="blockquote",Xt="insertcode",Vt="wijmo-wijribbon",$t=Vt+"-bigbutton",Jt=Vt+"-dropdownbutton",Kt=Vt+"-splitbutton",Qt=Vt+"-list",Gt=Vt+"-save",Yt=Vt+"-save16",Zt=Vt+"-undo",en=Vt+"-redo",tn=Vt+"-preview",nn=Vt+"-cleanup",rn=Vt+"-cut",sn=Vt+"-copy",on=Vt+"-paste",un=Vt+"-selectall",an=Vt+"-bgcolor",fn=Vt+"-color",ln=Vt+"-bold",cn=Vt+"-italic",hn=Vt+"-underline",pn=Vt+"-strike",dn=Vt+"-sub",vn=Vt+"-sup",mn=Vt+"-template",gn=Vt+"-removeformat",yn=Vt+"-justifyleft",bn=Vt+"-justifycenter",wn=Vt+"-justifyright",En=Vt+"-justifyfull",Sn=Vt+"-borders",xn=Vt+"-orderlist",Tn=Vt+"-unorderlist",Nn=Vt+"-outdent",Cn=Vt+"-indent",kn=Vt+"-inspect",Ln=Vt+"-find",An=Vt+"-table",On=Vt+"-inserttable",Mn=Vt+"-edittable",_n=Vt+"-insertcol",Dn=Vt+"-insertrow",Pn=Vt+"-insertcell",Hn=Vt+"-splitcell",Bn=Vt+"-mergecell",jn=Vt+"-deletecol",Fn=Vt+"-deleterow",In=Vt+"-deletecell",qn=Vt+"-insertbreak",Rn=Vt+"-insertparagraph",Un=Vt+"-insertprintpagebreak",zn=Vt+"-inserthr",Wn=Vt+"-form",Xn=Vt+"-textarea",Vn=Vt+"-textbox",$n=Vt+"-password",Jn=Vt+"-hiddenfield",Kn=Vt+"-imagebutton",Qn=Vt+"-button",Gn=Vt+"-listbox",Yn=Vt+"-dropdownlist",Zn=Vt+"-radio",er=Vt+"-checkbox",tr=Vt+"-link",nr=Vt+"-link16",rr=Vt+"-imagebrowser",ir=Vt+"-media",sr=Vt+"-specialchar",or=Vt+"-datetime",ur=Vt+"-blockquote",ar=Vt+"-insertcode",fr=Vt+"-modes",lr=Vt+"-designview",cr=Vt+"-sourceview",hr=Vt+"-splitview",pr=Vt+"-wordwrap",dr=Vt+"-fullscreen",vr="wijmo-wijeditor",mr=vr+"-container",gr=vr+"-header",yr=vr+"-content",br=vr+"-footer",wr=vr+"-pathselector",Er=vr+"-fullscreen",Sr=vr+"-dialog",xr=Sr+"-hr",Tr=Sr+"-buttons",Nr=Sr+"-button",Cr=Sr+"-text",kr=vr+"-imagedlg",Lr=kr+"-content",Ar=kr+"-fields",Or=kr+"-imagefield",Mr=kr+"-imagelist",_r=kr+"-preview",Dr=kr+"-imagesrc",Pr=kr+"-imagealt",Hr=kr+"-imagewidth",Br=kr+"-imageheight",jr=kr+"-css",Fr=kr+"-hideimagelist",Ir=vr+"-templatedlg",qr=Ir+"-toplabels",Rr=Ir+"-topleftlabel",Ur=Ir+"-toprightlabel",zr=Ir+"-content",Wr=Ir+"-templatelist",Xr=Ir+"-preview",Vr=Ir+"-templateinfo",$r=Ir+"-nameinfo",Jr=Ir+"-descriptioninfo",Kr=Ir+"-fields",Qr=Ir+"-name",Gr=Ir+"-description",Yr=Ir+"-buttons",Zr=Ir+"-delete",ei=Ir+"-save",ti=vr+"-linkdlg",ni=ti+"-address",ri=ti+"-linktype",ii=ti+"-anchor",si=ti+"-text",oi=ti+"-target",ui=ti+"-css",ai=ti+"-src",fi=ti+"-width",li=ti+"-height",ci=ti+"-imagecontainer",hi=ti+"-linkicontype",pi=vr+"-codedlg",di=pi+"-source",vi=pi+"-sourcelabel",mi=vr+"-taginsdlg",gi=mi+"-caption",yi=mi+"-taglabel",bi=mi+"-tagtext",wi=mi+"-filterempty",Ei=mi+"-attribs",Si=mi+"-attriblist",xi=mi+"-innerhtml",Ti=mi+"-css",Ni=vr+"-colordlg",Ci=Ni+"-picker",ki=Ni+"-color",Li=vr+"-tabledlg",Ai=Li+"-rows",Oi=Li+"-columns",Mi=Li+"-width",_i=Li+"-height",Di=Li+"-border",Pi=Li+"-cellpadding",Hi=Li+"-cellspacing",Bi=Li+"-csstext",ji=Li+"-bgcolor",Fi=vr+"-previewdlg",Ii=Fi+"-caption",qi=Fi+"-navigator",Ri=Fi+"-prev",Ui=Fi+"-next",zi=Fi+"-printall",Wi=Fi+"-printone",Xi=Fi+"-ok",Vi=Fi+"-printdocument",$i=Fi+"-previewiframe",Ji=vr+"-cleanupdlg",Ki=Ji+"-caption",Qi=Ji+"-document",Gi=Ji+"-actions",Yi=vr+"-finddlg",Zi=Yi+"-find",es=Yi+"-replace",ts=vr+"-mediadlg",ns=ts+"-type",rs=ts+"-src",is=ts+"-width",ss=ts+"-height",os=vr+"-specialchardlg",us=os+"-chars",as=os+"-preview",fs=os+"-content",ls=os+"-list",cs=os+"_label",hs=os+"-punctuation",ps=os+"-symbols",ds=os+"-diacritics",vs="wijmo-formatspan",ms="."+Tr+" input:first",gs="."+Tr+" input:last",ys="."+Tr+" input[value='OK']",bs="."+Tr+" input[engValue='Cancel']",ws=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],Es=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],Ss=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],xs={Form:{name:"form",tip:"Form",css:Wn},Image:{name:"imagebutton",tip:"Image Button",css:Kn},TextArea:{name:"textarea",tip:"TextArea",css:Xn},Button:{name:"button",tip:"Button",css:Qn},TextBox:{name:"textbox",tip:"TextBox",css:Vn},List:{name:"list",tip:"ListBox",css:Gn},PasswordField:{name:"passwordfield",tip:"Password Field",css:$n},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Yn},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Jn},Radio:{name:"radio",tip:"RadioButton",css:Zn},CheckBox:{name:"checkbox",tip:"CheckBox",css:er},InsertColumn:{name:"insertcol",tip:"Insert Column",css:_n},InsertRow:{name:"insertrow",tip:"Insert Row",css:Dn},InsertCell:{name:"insertcell",tip:"Insert Cell",css:Pn},SplitCell:{name:"splitcell",tip:"Split Cell",css:Hn},MergeCell:{name:"mergecell",tip:"Merge Cell",css:Bn},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:jn},DeleteRow:{name:"deleterow",tip:"Delete Row",css:Fn},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:In},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:yn,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:bn,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:wn,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:En,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:Sn},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:xn,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:Tn,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:Nn,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:Cn,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:an},ForeColor:{name:"fontcolor",tip:"Font Color",css:fn},Bold:{name:"bold",tip:"Bold",css:ln},Italic:{name:"italic",tip:"Italic",css:cn},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:pn},UnderLine:{name:"underline",tip:"Underline",css:hn},SubScript:{name:"subscript",tip:"Subscript",css:dn},SuperScript:{name:"superscript",tip:"Superscript",css:vn},Template:{name:"template",tip:"Template",css:mn},RemoveFormat:{name:"removeformat",tip:"RemoveFormat",css:gn},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:qn},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Rn},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:Un},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:zn},Table:{name:"tablebutton",tip:"Table",css:An},InsertTable:{name:"inserttable",tip:"Insert Table",css:On},EditTable:{name:"edittable",tip:"Edit Table",css:Mn},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:lr,grpname:"modes"},Split:{name:"split",tip:"Split View",css:hr,grpname:"modes"},Code:{name:"code",tip:"Source View",css:cr,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:pr},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:dr},Undo:{name:"undo",tip:"Undo",css:Zt},Redo:{name:"redo",tip:"Redo",css:en},Preview:{name:"preview",tip:"Preview",css:tn},Cleanup:{name:"cleanup",tip:"Clean up",css:nn},Cut:{name:"cut",tip:"Cut",css:rn},Copy:{name:"copy",tip:"Copy",css:sn},Paste:{name:"paste",tip:"Paste",css:on},SelectAll:{name:"selectall",tip:"Select All",css:un},Media:{name:"media",tip:"Media",css:ir},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:sr},InsertDate:{name:"datetime",tip:"Insert Date Time",css:or},Find:{name:"find",tip:"Find And Replace",css:Ln,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:kn,text:"Inspect"},Save:{name:"save",tip:"Save",css:Gt,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:rr},Link:{name:"link",tip:"Link",css:tr,text:"Link"},FontName:{name:"fontname",tip:"Font Name",text:"Font Name",css:Jt},FontSize:{name:"fontsize",tip:"Font Size",text:"Font Size",css:Jt},BlockQuote:{name:"blockquote",tip:"Block Quote",css:ur},InsertCode:{name:"insertcode",tip:"Insert Code",css:ar}},Ts={Actions:["Save","","Undo","Redo","","Preview","Cleanup","","Cut","Copy","Paste","SelectAll"],Font:["FontName","FontSize","","BackColor","ForeColor","","Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","","Template","","RemoveFormat"],Paragraph:["","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","","Border","","NumberedList","BulletedList","","Outdent","Indent"],Review:["Inspect","Find"]},Ns={Tables:["Table","","InsertColumn","InsertRow","InsertCell","","SplitCell","MergeCell","","DeleteColumn","DeleteRow","DeleteCell"],Breaks:["InsertBreak","InsertParagraph","InsertPrint","InsertHR"],Forms:["","Form","","TextArea","TextBox","PasswordField","HiddenField","","Image","Button","","List","DropDownList","Radio","CheckBox"],Special:["Link","InsertImage","Media","InsertSpecialChar","InsertDate"]},Cs=function(e){this.text=e,this.render=function(){return this.text}},ks=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.wijeditor=function(){this._curPageIdx=0,this.tRange=null,this.txtFoundInIE=!1,this.txtFoundInNoneIE=!1,this.rangeSelection=null},t.prototype._create=function(){var t=this,r=t.element.attr("id");window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));if(t.element.is("input"))return;t.wijeditor();if(!r||r==="")t.element.uniqueId(),r=t.element.attr("id");t.id_prefix="wijeditor-"+r+"-",t.$ribbon=undefined,t.$modes=undefined,t._isIE11=n.browser.msie&&n.browser.version&&parseFloat(n.browser.version)>=11,t._isEdge=navigator.userAgent.indexOf("Edge/")>0,t._editorify(),t._initElements(),s.setTimeout(function(){t._isDisabled()&&t._handleDisabledOption(!0,t.editor)},40),t._continueSavingInputTextForUndo=!1,t.element.attr("aria-label","wijeditor"),t.element.is(":hidden")&&t.editor.wijAddVisibilityObserver&&t.editor.wijAddVisibilityObserver(function(e){if(n.contains(t.editor[0],e.target))return;t.refresh(),t.editor.wijRemoveVisibilityObserver&&t.editor.wijRemoveVisibilityObserver()},"wijeditor"),e.prototype._create.call(this)},t.prototype._contextMenuWidgetName=function(){return"wijmenu"},t.prototype._createDropdownButton=function(e,t,r,i,s){var o=this,u=a.createElement("div",{title:e,"class":Jt}),f=a.createElement("ul");return u.add(a.createTextButton(e,t,r)),u.add(f),n.each(i,function(e,r){var i=a.createElement("li"),o=a.createTextRadioButton(r.tip,s,r.name,t,r.text);n.each(o,function(e,t){i.add(t)}),f.add(i)}),u},t.prototype._createSplitButton=function(e,t,r,i,s){var o=this,u=a.createElement("div",{title:e,"class":Kt}),f=a.createElement("ul");return u.add(a.createBigButton(e,t,r,i)),u.add(a.createElement("button",{"class":$t})),u.add(f),n.each(s,function(e,t){var n=a.createElement("li");n.add(a.createButton(t.tip,t.css,t.name,t.text)),f.add(n)}),u},t.prototype._createButtonByCommand=function(e){var t=this,n,r=xs[e],i,s,o,u,f;if(!r)return;f=r.name,i=f+"ButtonTip",s=f+"ButtonText",o=this.localizeString(i,r.tip),u=this.localizeString(s,r.text);switch(f){case Wt:case S:case x:case T:case N:case C:case k:case L:case A:case O:case M:case _:case D:case P:case H:case B:case j:case F:case I:case q:case st:case ot:case ut:case at:case gt:case yt:case bt:case St:case xt:case Tt:case Lt:case mt:case Q:case G:case wt:case Et:case Ct:case kt:case it:case Dt:case Xt:case ft:case Nt:n=a.createButton(o,r.css,f);break;case At:case Ot:n=a.createButton(o,r.css,f,u);break;case X:case nt:case rt:case Y:case Z:case tt:case et:n=a.createImageCheckButton(o,t.id_prefix,r.css,f);break;case pt:case dt:case vt:case R:case U:case z:case W:case J:case K:case V:case $:n=a.createImageRadioButton(o,t.id_prefix,r.css,f,r.grpname);break;case lt:n=t._createSplitButton(this.localizeString("tableButtonTip","Table"),An,lt,this.localizeString("tableButtonText","Table"),[{tip:this.localizeString("insertTableButtonTip","Insert Table"),css:On,name:ct,text:this.localizeString("insertTableButtonText","Insert")},{tip:this.localizeString("editTableButtonTip","Edit Table"),css:Mn,name:ht,text:this.localizeString("editTableButtonText","Edit")}]);break;case Mt:t.options.mode==="ribbon"?n=a.createBigButton(o,r.css,f,u):n=a.createButton(o,Yt,f);break;case Pt:t.options.mode==="ribbon"?n=a.createBigButton(o,r.css,f,u):n=a.createButton(o,nr,f);break;case Ut:n=t._createDropdownButton(o,Ut,u,t.options.fontNames||[],t.id_prefix);break;case zt:n=t._createDropdownButton(o,zt,u,t.options.fontSizes||[],t.id_prefix);break;case _t:}return n},t.prototype._createGroup=function(e,t){var n=this,r=a.createElement("li"),i=n.localizeString(e.toLowerCase()+"Group",e);return n._createGroupButtons(r,t),r.add(a.createElement("div",i,{displayname:e})),r},t.prototype._createGroupButtons=function(e,t){var r=this,i,s=e,o;n.each(t,function(t,u){u===""?(s=e,i=a.createRibbonList(),s.add(i),s=i):(o=r._createButtonByCommand(u),n.isArray(o)&&o.length>0?n.each(o,function(e,t){s.add(t)}):s.add(r._createButtonByCommand(u)))})},t.prototype._getDefaultRibbonMarkup=function(){var e=this,t=a.createElement("div"),r=a.createElement("ul"),i=a.createElement("li"),s=a.createElement("li"),o=a.createElement("div",{id:e.id_prefix+"format"}),u=a.createElement("div",{id:e.id_prefix+"insert"}),f=a.createElement("ul"),l=a.createElement("ul"),c=e.localizeString("formatTab","Format"),h=e.localizeString("insertTab","Insert");return t.add(r),t.add(o),t.add(u),r.add(i),r.add(s),i.add(a.createElement("a",c,{href:"#"+e.id_prefix+"format"})),s.add(a.createElement("a",h,{href:"#"+e.id_prefix+"insert"})),o.add(f),n.each(Ts,function(t,n){f.add(e._createGroup(t,n))}),u.add(l),n.each(Ns,function(t,n){l.add(e._createGroup(t,n))}),t.render()},t.prototype._resetModesBtnTip=function(e,t){var r=this.element.find(".wijeditor-footer"),i=n(r.find("."+e));i.length>0&&(t.tip=i.attr("title")||t.tip)},t.prototype._getRibbonModesMarkup=function(){var e=this,t=a.createDiv(fr),n=a.createRibbonList(),r=e.element.find(".wijeditor-footer");return r.length>0&&(e._resetModesBtnTip(lr,xs.Wysiwyg),e._resetModesBtnTip(hr,xs.Split),e._resetModesBtnTip(cr,xs.Code),e._resetModesBtnTip(pr,xs.Wordwrap),e._resetModesBtnTip(dr,xs.FullScreen),r.remove()),t.add(n),e._createGroupButtons(n,["Wysiwyg","Code","Split"]),e._createGroupButtons(t,["Wordwrap","FullScreen"]),t.render()},t.prototype._getSimpleToolBar=function(e){var t=this,r,i=a.createDiv("");return n.each(e,function(e,s){r=t._createButtonByCommand(s),r&&(n.inArray(s,ws)!==-1?n.each(r,function(e,t){i.add(t)}):i.add(r))}),i.render()},t.prototype._editorify=function(){var e=this,t=e.element,r=t.width(),i=t.height(),s=e.options,o=s.mode,u,a,f,l,c,h,p;e._oriStyle=t.attr("style"),e._oriContent=t.html(),e._oriEleWidth=r,e._oriEleHeight=i,t.is("textarea")?(o==="ribbon"?e.$ribbon=n(e._getDefaultRibbonMarkup()):o==="bbcode"?e.$ribbon=n(e._getSimpleToolBar(Ss)):s.simpleModeCommands&&s.simpleModeCommands.length!==0?(f=n.grep(s.simpleModeCommands,function(e,t){return e!=="Table"},undefined),e.$ribbon=n(e._getSimpleToolBar(f))):e.$ribbon=n(e._getSimpleToolBar(Es)),s.text&&t.val(s.text),e.sourceView=t,e.editor=t.wrap("<div></div>").parent(),e.editor.width(r).height(i)):(e.editor=t,e.$ribbon=t.children(":eq(0)"),h=t.children(":eq(1)"),h.is("textarea")?(s.text&&h.val(s.text),e.sourceView=h):(s.text?p=s.text:p=h.html(),h.remove(),e.sourceView=n("<textarea aria-label='textarea'></textarea>").val(p))),u=n("<div class='"+mr+"'></div>"),e.dialog=n("<div class ='"+vr+"'></div>"),e.subDialog=n("<div class ='"+vr+"'></div>"),e.editor.addClass(vr).addClass(e.options.wijCSS.widget).append(u).append(e.dialog).append(e.subDialog),e._createMenuMarkUp(e,s),e.$ribbon.wrap("<a href='javascript:void(null)'></a>").parent().appendTo("<div class='"+gr+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(u),a=n("<div class='"+yr+"'></div>").appendTo(u),e.designView=n("<iframe frameborder='0'></iframe>"),e.designView.wrap("<div></div>").parent().appendTo(a),e.sourceView.wrap("<div></div>").parent().appendTo(a),l=[e.$ribbon],e.$modes=n(e._getRibbonModesMarkup()),s.showFooter&&(c=n("<div class='"+br+" "+"ui-widget ui-widget-content ui-state-default'></div>"),u.append(c),c.append("<div class='"+wr+"'></div>"),e.$modes.appendTo(c),l.push(e.$modes)),n.each(l,function(t,n){n.wijribbon({compactMode:e.options.compactRibbonMode,click:function(t,n){e._ribbonCommand(n.commandName,n.name),e._trigger("commandButtonClick",t,n)}})})},t.prototype._createMenuMarkUp=function(e,t){t.customContextMenu&&(e.contextMenu=n("<ul><li _c1buttoncmd='cut'><a>"+this.localizeString("contextMenuCut","Cut")+"</a></li>"+"<li _c1buttoncmd='copy'><a>"+this.localizeString("contextMenuCopy","Copy")+"</a></li>"+"<li _c1buttoncmd='paste'><a>"+this.localizeString("contextMenuPaste","Paste")+"</a></li></ul>"),n("<a href='#'></a>").append(e.contextMenu).appendTo(e.editor))},t.prototype._handleDisabledOption=function(e,t){var r=this;e?(r.disabledDiv||(r.disabledDiv=r._createDisabledDiv(t)),n("body").focus(),r.disabledDiv.appendTo(r.editor)):r.disabledDiv&&(r.disabledDiv.remove(),r.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=e?e:t.element,i=r.outerWidth(),s=r.outerHeight();return n("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"relative","background-color":"lightgray",width:i,height:s,left:0,top:-s})},t.prototype._initElements=function(){var e=this,t=e.options,n=e.editor.height()-e._getHeader().outerHeight(!0)-e._getFooter().outerHeight(!0),r={};e._getContent().height(n).wijsplitter({showExpander:!1,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:!1},panel2:{scrollBars:"none",collapsed:!0}}),e.sourceView.css("width","").css("height",""),e._addHandlerToDesignView(),e._addDefaultFontStyleToDesignView(),e._createWijMenu(),(!t.showPathSelector||e.options.mode==="bbcode")&&e._getPathSelector().hide(),e._ribbonCommand(t.editorMode,null,!0),t.fullScreenMode&&e._setFullScreen(t.fullScreenMode),r[bt]=!0,r[yt]=!0,e.$ribbon.wijribbon(b,r),e._handleWinDocumentKeyDown()},t.prototype._handleWinDocumentKeyDown=function(){var e=this;n(document).bind("keydown."+e.widgetName+"."+e.id_prefix.replace(/-/g,""),function(t){if(e._isDisabled())return;switch(t.keyCode){case 27:e._escActionAssociated()}})},t.prototype._setOption=function(t,r){var i=this,s=i.options,o=s.mode,u=s.editorMode,a=s.compactRibbonMode,f=i.$ribbon.parent(),l=s.fullScreenMode,c=s.customContextMenu;e.prototype._setOption.call(this,t,r);if(t==="fullScreenMode")r!==l&&i._setFullScreen(r);else if(t==="showPathSelector")r?(i._getPathSelector().show(),i._refreshPathSelector()):i._getPathSelector().hide();else if(t==="editorMode"&&u!==r)i._ribbonCommand(r),i.$modes.data("wijmo-wijribbon")&&i.$modes.wijribbon(w,u,!1);else if(t==="fullScreenContainerSelector")i.options.fullScreenMode&&i._setFullScreen(!0);else if(t==="showFooter")r?n("."+br).is(":visible")||n("."+br).show():n("."+br).is(":visible")&&n("."+br).hide();else if(t==="commandButtonClick")s.commandButtonClick=r;else if(t==="text")i.setText(r);else if(t==="customContextMenu"){if(c===r)return;r?(i.contextMenu||i._createMenuMarkUp(i,s),i._createWijMenu()):(i.contextMenu[i._contextMenuWidgetName()]("destroy").remove(),i.contextMenu=undefined)}else t==="mode"&&r!==o||t==="compactRibbonMode"&&r!==a?(i._recreateRibbon(s.mode),i._ribbonCommand(s.editorMode)):t==="fontNames"||t==="fontSizes"?i._recreateRibbon(s.mode):t==="readOnly"&&i._updateContentEditable()},t.prototype._updateContentEditable=function(){var e=this,t=e._getDesignViewWindow().document;n.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(t,!e.options.readOnly),e.sourceView.attr("readonly",e.options.readOnly)},t.prototype._innerDisable=function(){e.prototype._innerDisable.call(this),this._handleDisabledOption(!0,this.editor)},t.prototype._innerEnable=function(){e.prototype._innerEnable.call(this),this._handleDisabledOption(!1,this.editor)},t.prototype._recreateRibbon=function(e){var t=this,r=t.$ribbon.parent();t.$ribbon.wijribbon("destroy"),t.$ribbon.remove(),e==="ribbon"?t.$ribbon=n(t._getDefaultRibbonMarkup()):e==="bbcode"?t.$ribbon=n(t._getSimpleToolBar(Ss)):t.$ribbon=n(t._getSimpleToolBar(Es)),r.append(t.$ribbon),t.$ribbon.wijribbon({compactMode:t.options.compactRibbonMode,click:function(e,n){t._ribbonCommand(n.commandName,n.name),t._trigger("commandButtonClick",e,n)}})},t.prototype._getHeader=function(){return n("."+gr,this.editor)},t.prototype._getContent=function(){return n("."+yr,this.editor)},t.prototype._getFooter=function(){return n("."+br,this.editor)},t.prototype._getPathSelector=function(){return n("."+wr,this.editor)},t.prototype._getModes=function(){return n("."+fr,this.editor)},t.prototype._getDesignView=function(){return this.designView},t.prototype._getDesignViewWindow=function(){var e=this.designView;return e&&e.length>0?e[0].contentWindow:null},t.prototype._getDesignViewDocument=function(){var e=this._getDesignViewWindow();return e?e.document:null},t.prototype._getDesignViewText=function(){var e=this._getDesignViewDocument();return e&&e.body&&e.body.innerHTML?e.body.innerHTML:""},t.prototype._setDesignViewText=function(e){var t=this,n=this._getDesignViewDocument();this.options.mode==="bbcode"&&(e=t._convertBBCodeToHtml(e)),n&&n.body&&(n.body.innerHTML=e),t.options.text=e},t.prototype._getDialog=function(){return this.dialog},t.prototype._getSubDialog=function(){return this.subDialog},t.prototype._initContentDocument=function(){var e=this,t=e.sourceView.val(),r=e._getDesignViewDocument(),i=e.options.tableVirtualBorderShowing,s=function(){e.designView.load(function(){try{e._addHandlerToDesignView(),e._addDefaultFontStyleToDesignView(),e._createWijMenu()}catch(t){}})};if(t!==""&&t===e._getDesignViewText())return;e.options.mode==="bbcode"&&(t=e._convertBBCodeToHtml(n.trim(t))),e.designView.unbind("load"),r.open(),r.write('<html style="width:100%;height:100%;'+(e.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle" '+' type="text/css" >table,td,tr{border: 1px #acacac dashed;}hr.pagebreak{visibility: visible!important;}'+'</style></head><body style="word-wrap:break-word">'+t+"</body></html>"),r.close(),i||(e._updateTableBorderShowing(i),e.$ribbon.wijribbon(w,X,!i)),e.element.attr("accesskey")&&(n(r.body).attr("accesskey",e.element.attr("accesskey")),e.element.removeAttr("accesskey")),m=[],m.push(t),v=0,s()},t.prototype._addHandlerToDesignView=function(){var e=this,t=e._getDesignViewWindow(),r=t.document;e._initContentDocument(),e._loadDesignView(),n.browser.msie&&n(r).unbind("beforedeactivate").bind("beforedeactivate",function(){e._saveSelectionForIE()})},t.prototype._loadDesignView=function(){var e=this,t=e._getDesignViewWindow(),r=t.document;e._updateContentEditable(),n.browser.msie&&e._setContentSpellCheck(r,!1),e.sourceView.unbind("blur."+e.widgetName).bind("blur."+e.widgetName,function(t){e._onSourceViewBlur(t)}),e.sourceView.unbind("keyup."+e.widgetName).bind("keyup."+e.widgetName,function(t){e._onSourceViewBlur(t)}),n.browser.mozilla?n(r).unbind("blur."+e.widgetName).bind("blur."+e.widgetName,function(t){e._onDesignViewBlur(t)}):n(t).blur(function(t){e._onDesignViewBlur(t)}),n(r).unbind("mouseup."+e.widgetName).bind("mouseup."+e.widgetName,function(t){e._onDesignViewMouseUp(t)}).unbind("keydown."+e.widgetName).bind("keydown."+e.widgetName,function(t){e._onDesignViewKeyDown(t)}).unbind("keyup."+e.widgetName).bind("keyup."+e.widgetName,function(t){e._onDesignViewKeyUp(t),e._onDesignViewBlur(t)})},t.prototype._addDefaultFontStyleToDesignView=function(){var e=this,t=e.options,r=e._getDesignViewDocument(),i=t.defaultFontName,s=t.defaultFontSize,o='<style type="text/css"> body {';if(!(i!==""&&i!==null||s!==""&&s!==null))return;i!==""&&i!==null&&(o+="font-family: "+i+";"),t.defaultFontSize!==""&&t.defaultFontSize!==null&&(o+=" font-size: "+s+";"),o+="}</style>",window.setTimeout(function(){n(o).appendTo(n("head",r))},200),e._setFontStyleButtonState(i,Ut),e._setFontStyleButtonState(s,zt)},t.prototype._setFontStyleButtonState=function(e,t){var r="";if(!e||e===null)return;n.each(this.$ribbon.wijribbon("getDropdownList",t),function(t,n){if(n.toUpperCase()===e.toUpperCase())return r=t,!1}),this.$ribbon.wijribbon(w,r,!0,t)},t.prototype._setDesignModeForFF=function(e){var t=e._getDesignViewDocument();t&&(t.designMode=e.options.readOnly?"off":"on")},t.prototype.destroy=function(){var e=this;e.element.html(e._oriContent),e.element.removeAttr("tabindex").removeAttr("aria-label"),e._oriStyle===undefined?e.element.removeAttr("style"):e.element.attr("style",e._oriStyle),e.dialog&&e.dialog.remove(),e.element.insertBefore(e.editor),e.element.unbind("."+e.widgetName),n(document).unbind("."+e.widgetName+"."+e.id_prefix.replace(/-/g,"")),e.element.removeUniqueId(),e.element.is("textarea")?e.editor.remove():e.editor.removeClass(e.options.wijCSS.widget).removeClass(vr),e._oriDocOverFlow&&n(document.documentElement).css({overflow:e._oriDocOverFlow}),n.Widget.prototype.destroy.call(e)},t.prototype.showEditorDialog=function(e){switch(e){case ct:case it:case Dt:case Ot:case At:case kt:case Ct:case Et:case Pt:case Q:case G:case Xt:this._ribbonCommand(e);break;default:i(this.localizeString("notFindCommandError","Cannot find the dialog with command name '")+e+"'!")}},t.prototype.executeEditorAction=function(e,t){this._ribbonCommand(e,t)},t.prototype._isFontSizeCustomized=function(){if(p!==null)return p;var e=this.$ribbon.wijribbon("getDropdownList",zt),t=[Ht,Bt,jt,Ft,It,qt,Rt];return p=!1,n.each(e,function(e,r){if(n.inArray(e,t)===-1)return p=!0,!1}),p},t.prototype._fontSizeCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=4,o="font-size",a=[];t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection());switch(e){case Ht:s=1;break;case Bt:s=2;break;case jt:s=3;break;case Ft:s=4;break;case It:s=5;break;case qt:s=6;break;case Rt:s=7}t._setIEFocus(),t._isFontSizeCustomized()?t._formatFontSpan(r,o,e):n.browser.msie&&u(n.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontSize",!1,s):r.execCommand("FontSize",!1,s),t.options.mode==="bbcode"&&!n.browser.msie&&t._convertFontStyleToStandTag(),t._addtoUndoBuffer()},t.prototype._fontNameCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=t.$ribbon.wijribbon("getDropdownList",Ut),o;t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection()),n.each(s,function(t,n){if(e===t)return o=n,!1}),t._setIEFocus(),r.execCommand("FontName",!1,o),t._addtoUndoBuffer()},t.prototype._formatFontSpan=function(e,t,r){var i=this,s=r,o="fontFamily",u=[],a;t!=="font-family"&&(s="c1-temp",o="fontSize",a=i._queryCommandValue(Ut),a!=="undefined"&&(s=a)),e.execCommand("FontName",!1,s),n("font[face='"+s+"']",e).length===0&&(s="c1-temp",e.execCommand("FontName",!1,s)),n.each(n("font[face='"+s+"']",e),function(e,s){var a=i._replaceFontWithSpan(n(s),"face",t,r),f,l;u.push(a),f=n("span."+vs,a);for(l=f.length-1;l>=0;l--)i._removeSpecifiedStyleSpan(n(f[l]),o,t);n.each(a,function(e,r){n.each(n(r).parents("span."+vs),function(e,s){var u=n(s);if(u.children().length>1)return!1;u.text()===n(r).text()&&i._removeSpecifiedStyleSpan(u,o,t)})})}),i._setSelection(u)},t.prototype._replaceFontWithSpan=function(e,t,n,r){e.wrap("<span class = '"+vs+"' style='"+n+":"+r+"'></span>");var i=e.parent();return e.attr(t)==="c1-temp"&&e.removeAttr(t),/<font\s*>/ig.test(i.html())&&(i.html(e.html()),e.remove()),i},t.prototype._removeSpecifiedStyleSpan=function(e,t,r){var i,s=!0;e[0].style[t]!==""&&e.css(r,""),i=e.attr("style"),i&&n.each(i.split(";"),function(e,t){var i=n.trim(t).toLowerCase();if(i!==""&&i.indexOf(r)!==-1)return s=!1,!1}),s&&e.replaceWith(e.html())},t.prototype._removeFormat=function(){var e=this,t=e._getDesignViewDocument(),r={};t.execCommand(st,!1,null),e._isFontSizeCustomized()&&n.browser.msie&&e._removeFormatForIE(t),e._addtoUndoBuffer(),r[Y]=!1,r[Z]=!1,r[et]=!1,r[tt]=!1,r[nt]=!1,r[rt]=!1,r[V]=!1,r[$]=!1,r[R]=!1,r[U]=!1,r[z]=!1,r[W]=!1,e.$ribbon.wijribbon(E,r)},t.prototype._removeFormatForIE=function(e){var t=this._getIESelectionRange(),r=this._getSelectedContent(),i=this._getSelectedContent(!0),s=0,o=e.getSelection(),u=this._isIE11?o&&o.anchorNode&&o.anchorNode.parentNode?n(o.anchorNode.parentNode):null:n(t.parentElement()),a=n(e.body),f="",l="",c="__c1temp",h="c1-temp",p="<span class='"+h+"'>"+c+"</span>",d,v,m,g,y,b,w;u.addClass("c1-app-parent"),this._isIE11?(t.deleteContents(),w=t.createContextualFragment(p),t.insertNode(w),t.collapse(!1)):t.pasteHTML(p),s=a.text().indexOf(c),d=n("span."+h,e),v=d,d.parentsUntil("body").each(function(e){if(n(this).is(".c1-app-parent"))return!1;v=n(this)}),d.html(r),m=n("span."+vs,d);for(y=m.length-1;y>=0;y--)g=n(m[y]),g.replaceWith(g.html());v.is("."+h)||v.after(d),n.each(v.parents("span."+vs),function(e,t){f+="</span>",l="<span class='"+vs+"' style = '"+n(t).attr("style")+"'>"+l}),r=d.html(),d.replaceWith(c),b=a.html().split(c),a.html(b[0]+f+r+l+b[1]),m=n("span."+vs,e);for(y=m.length-1;y>=0;y--)g=n(m[y]),g.text()===""&&g.replaceWith(g.html());n(".c1-app-parent",e).removeClass("c1-app-parent"),this._setSelection(null,s,i.length)},t.prototype._toggleFullScreen=function(){var e=this,t=e.options;t.fullScreenMode=!t.fullScreenMode,e._setFullScreen(t.fullScreenMode),e.$modes.wijribbon(w,gt,t.fullScreenMode),e.$modes.wijribbon("removeButtonHoverState",gt)},t.prototype._setFullScreen=function(e){var t=this,r=1,i=t._getHeader(),o=t._getFooter(),u=t._getContent(),a=t.options.fullScreenContainerSelector,h=n(a),p=t._getDesignViewText(),d,v,m;e?(h.length===0&&(h=n(s),a="body",t._oriDocOverFlow=n(document.documentElement).css("overflow"),n(document.documentElement).css({overflow:"hidden"}),n.browser.mozilla||window.scrollTo(0,0),n(s).bind("resize.wijeditor",function(){t._fullscreenOnWindowResize()})),d=h.width(),v=h.height()-2*r,f=t.editor.width(),l=t.editor.height(),c||(c=t.editor.parent()),t._replacedDiv||(t._replacedDiv=n("<div />")),t.editor.after(t._replacedDiv),n(a).append(t.editor),t.editor.css({width:d,height:v,position:""}).addClass(Er),t.$ribbon.wijribbon("updateRibbonSize")):(t._replacedDiv.after(t.editor).remove(),t.editor.css({width:f,height:l,position:"static"}).removeClass(Er),t.options.fullScreenContainerSelector||n(document.documentElement).css({overflow:t._oriDocOverFlow}),n(s).unbind("resize.wijeditor"),t.$ribbon.wijribbon("updateRibbonSize")),t.disabledDiv&&(e?t.disabledDiv.css({position:"fixed",width:"",height:"",left:0,top:0,right:0,bottom:0}):t.disabledDiv.css({position:"relative",width:t.editor.outerWidth(),height:t.editor.outerHeight(),left:0,top:-t.editor.outerHeight(),right:"",bottom:""})),m=t.editor.height()-i.outerHeight(!0)-o.outerHeight(!0),u.height(m).wijsplitter("refresh"),t.$modes.data("wijmo-wijribbon")&&t.$modes.wijribbon(w,gt,e)},t.prototype._createWijMenu=function(){var e=this,t=e._getDesignViewDocument();e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]({orientation:"vertical",trigger:e.designView,triggerEvent:"rtclick",showing:function(t,r){n.browser.msie&&e._saveSelectionForIE();var i=e.designView.offset(),s=n(n(e.designView)[0].contentWindow).scrollLeft(),o=n(n(e.designView)[0].contentWindow).scrollTop(),u=i.left+2-s,a=i.top-o;r.options.position={my:"left+"+u+" "+"top+"+a,at:"right top",of:t,collision:"none none"}},animation:{animated:"fade"},select:function(t,n){e._setIESelection(),e._contextMenuItemClick(t,n),e.contextMenu[e._contextMenuWidgetName()]("deactivate")}})},t.prototype._fullscreenOnWindowResize=function(){var e=this,t=e._getHeader(),r=e._getFooter(),i=e._getContent(),s,o=n(window).width(),u=n(window).height();e.editor.css({width:o,height:u}),s=e.editor.height()-t.height()-r.height(),i.height(s),i.data("wijmo-wijsplitter")&&i.wijsplitter("refresh")},t.prototype._saveText=function(e){},t.prototype._doSpellCheck=function(){},t.prototype._ribbonCommand=function(e,t,r){var i=this,s=i._isDisabled(),o=i._getDesignViewDocument(),u=i._getContent(),a,f=u.height()/2,l,c,h;if(n.inArray(e,[vt,At,gt,wt,dt,mt,pt])<0&&i.options.readOnly)return;if(t===Ut){i._fontNameCommand(e),i._onDesignViewBlur(null);return}if(t===zt){i._fontSizeCommand(e),i._onDesignViewBlur(null);return}!i.editor.hasClass("ui-helper-hidden-accessible")&&!s&&(r?setTimeout(function(){i._setIEFocus()},0):n.browser.msie&&i.focus());switch(e){case Wt:n.browser.msie?(o.execCommand("FormatBlock",!1,"<ADDRESS>"),i._isIE11&&o.getSelection?(a=o.getSelection(),a&&a.anchorNode&&(h=n(a.anchorNode).closest("address"))):(h=o.selection.createRange(),h=n(h.parentElement()).closest("address")),h.length&&(h.replaceWith("<blockquote>"+h.html()+"</blockquote>"),o.body.innerHTML=o.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>"),o.body.innerHTML=o.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>"),o.body.innerHTML=o.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,""))):o.execCommand("FormatBlock",!1,"<BLOCKQUOTE>"),i._addtoUndoBuffer(),i._setFocusNotIE();break;case S:l=i._generateUniqueName("form"),i.insertHTML('<form id="'+l+'" name="'+l+'" method="post">'+l+"</form>"),i._setFocusNotIE();break;case x:l=i._generateUniqueName("image"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="image"'+' value="'+l+'"/>'),i._setFocusNotIE();break;case T:l=i._generateUniqueName("textarea"),i.insertHTML('<textarea id="'+l+'" name="'+l+'" rows="4" cols="48"></textarea>'),i._setFocusNotIE();break;case N:l=i._generateUniqueName("button"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="button"'+' value="'+l+'"/>'),i._setFocusNotIE();break;case C:l=i._generateUniqueName("textbox"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="text"'+' value="'+l+'"/>'),i._setFocusNotIE();break;case k:l=i._generateUniqueName("list"),i.insertHTML('<select id="'+l+'" name="'+l+'" style="width: 120px" size="8"></select>'),i._setFocusNotIE();break;case L:l=i._generateUniqueName("password"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="password" value="'+l+'"/>'),i._setFocusNotIE();break;case A:l=i._generateUniqueName("dropdown"),i.insertHTML('<select id="'+l+'" name="'+l+'"></select>'),i._setFocusNotIE();break;case O:l=i._generateUniqueName("hidden"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="hidden" value="'+l+'" />'),i._setFocusNotIE();break;case M:l=i._generateUniqueName("radiobox"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="radio"'+' value="'+l+'">'+'<label for="'+l+'">'+l+"</label></input>"),i._setFocusNotIE();break;case _:l=i._generateUniqueName("checkbox"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="checkbox"'+' value="'+l+'">'+'<label for="'+l+'">'+l+"</label></input>"),i._setFocusNotIE();break;case D:case P:case H:case B:case j:case F:case I:case q:i._tableAction(e);break;case X:i._toggleTableBorders();break;case nt:try{o.queryCommandState(rt)&&(o.execCommand(rt,!1,null),i.$ribbon.wijribbon(w,rt,!1))}catch(p){}o.execCommand(nt,!1,null),i._addtoUndoBuffer(),i._setFocusNotIE();break;case rt:try{o.queryCommandState(nt)&&(o.execCommand(nt,!1,null),i.$ribbon.wijribbon(w,nt,!1))}catch(d){}o.execCommand(rt,!1,null),i._addtoUndoBuffer(),i._setFocusNotIE();break;case st:i._removeFormat(),i._setFocusNotIE();break;case ot:i.insertHTML("<br/>"),i._setFocusNotIE();break;case ut:c=i._getSelectedContent();if(!c||c==="")c="&nbsp;";i.insertHTML("<p>"+c+"</p>"),i._setFocusNotIE();break;case at:i.insertHTML('<hr class="pagebreak" style="page-break-before:always;visibility:hidden" />'),i._setFocusNotIE();break;case gt:i._storeSelectionForIE(),i._toggleFullScreen();break;case yt:i._undoAction(),i._setFocusNotIE();break;case bt:i._redoAction(),i._setFocusNotIE();break;case St:i._execCut(),i._setFocusNotIE();break;case xt:i._execCopy();break;case Tt:i._execPaste();break;case Lt:i.insertDateAndTime(),i._setFocusNotIE();break;case pt:i.$modes.data("wijmo-wijribbon")&&i.$modes.wijribbon(y,mt,!0).wijribbon(w,pt,!0),i.$ribbon.wijribbon("option","disabled",!1),u.wijsplitter("option","panel2",{collapsed:!0}),i._restoreSelectionForIE();break;case dt:i.$modes.data("wijmo-wijribbon")&&i.$modes.wijribbon(y,mt,!0).wijribbon(w,dt,!0),i.$ribbon.wijribbon("option","disabled",!1),u.wijsplitter("option",{splitterDistance:f,panel1:{collapsed:!1},panel2:{collapsed:!1}}),i._restoreSelectionForIE();break;case vt:i.$modes.data("wijmo-wijribbon")&&i.$modes.wijribbon(y,mt,!1).wijribbon(w,vt,!0),i._storeSelectionForIE(),i.$ribbon.wijribbon("option","disabled",!0),u.wijsplitter("option","panel1",{collapsed:!0}),n.browser.msie&&!s&&i.sourceView.focus();break;case mt:u.wijsplitter("option","panel1").collapsed&&i._toggleWordWrap();break;case Q:i._saveSelectionForIE(),i._createDialog(this.localizeString("backColorDialogTitle","Set BackColor"),i._getDialogRes_BackColor(),i.initBackColorDialog);break;case G:i._saveSelectionForIE(),i._createDialog(this.localizeString("foreColorDialogTitle","Set ForeColor"),i._getDialogRes_ForeColor(),i.initForeColorDialog);break;case ct:i._saveSelectionForIE(),i._createDialog(this.localizeString("insertTableDialogTitle","Insert Table"),i._getDialogRes_Table(),i.initInsertTableDialog);break;case ht:i._getEditableTable()&&i._createDialog(this.localizeString("editTableDialogTitle","Edit Table"),i._getDialogRes_Table(),i.initEditTableDialog);break;case wt:i._createDialog(this.localizeString("previewDialogPreview","Preview"),i._getDialogRes_Preview(),i.initPreviewDialog);break;case Et:i._createDialog(this.localizeString("cleanUpDialogTitle","Clean up source HTML document"),i._getDialogRes_CleanUp(),i.initCleanUpDialog);break;case Ct:i._saveSelectionForIE(),i._createDialog(this.localizeString("mediaDialogTitle","Insert media"),i._getDialogRes_Media(),i.initMediaDialog);break;case kt:i._saveSelectionForIE(),i._createDialog(this.localizeString("specialCharacterDialogTitle","Insert special character"),i._getDialogRes_SpecialCharacter(),i.initSpecialCharacterDialog);break;case At:i._createDialog(this.localizeString("findAndReplaceDialogTitle","Find and replace"),i._getDialogRes_FindAndReplace(),i.initFindDialog);break;case Ot:g=i._getSelectedElement(),i._createDialog(this.localizeString("tagInspectorDialogTitle","Tag Inspector"),i._getDialogRes_TagInspector(),i.initTagInspectorDialog);break;case it:i._saveSelectionForIE(),i._createDialog(this.localizeString("templateDialogApplyTemplate","Apply Template"),i._getDialogRes_Template(),i.initTemplateDialog);break;case Dt:i._saveSelectionForIE(),i._createDialog(this.localizeString("imageEditorDialogImageBrowser","Image Browser"),i._getDialogRes_ImageBrowser(),i.initImageBrowserDialog);break;case Pt:i._storeSelectionForIE(),i._createDialog(this.localizeString("hyperLinkDialogInserthyperLink","Insert hyperLink"),i._getDialogRes_Link(),i.initHyperLinkDialog);break;case Xt:i._saveSelectionForIE(),i._createDialog(this.localizeString("insertCodeDialogInsertCode","Insert Code"),i._getDialogRes_Code(),i.initInsertCodeDialog);break;case R:case U:case z:case W:case J:case K:case Y:case Z:case tt:case V:case $:case et:case ft:case Nt:o.execCommand(e,!1,null),i.options.mode==="bbcode"&&!n.browser.msie&&i._convertStyleToStandTag(),i._addtoUndoBuffer(),i._setFocusNotIE();break;case Mt:i._saveText();break;case _t:i._doSpellCheck()}e!==gt&&o&&o.readyState==="complete"&&i._onDesignViewBlur(null)},t.prototype._createDialog=function(e,t,r){var i=this,s,o=i.dialog;o.html("").undelegate(i.widgetName).undelegate("."+i.widgetName).append(t),i.subDialog&&i.subDialog.html("").undelegate(i.widgetName).undelegate("."+i.widgetName),s={width:"auto",height:"auto",modal:!0,title:e,position:{my:"center",at:"center",of:window},resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},o.data("wijmo-wijdialog")?(o.wijdialog("reset"),o.wijdialog("option",{width:"auto",height:"auto",title:e})):n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){o.wijdialog(s)},0):o.wijdialog(s),i._adjustDialogLayoutForIE7(),r&&r.call(i),o.wijdialog("open")},t.prototype._adjustDialogLayoutForIE7=function(){var e=this.dialog;n.browser.msie&&(/^7\.[0-9]+/.test(n.browser.version)||document.documentMode===7)&&e.wijdialog("option","width",e.parent().width())},t.prototype._contextMenuItemClick=function(e,t,n){var r=this,i=t.item.element.attr("_c1buttoncmd");if(i!==xt&&r.options.readOnly)return;switch(i){case St:r._execCut();break;case xt:r._execCopy();break;case Tt:r.focus(),r._execPaste()}},t.prototype._execCut=function(){var e=this,t=e._getDesignViewDocument();if(!e._getSelectedContent())return;t.queryCommandSupported("Cut")&&t.queryCommandEnabled("Cut")?(t.execCommand("Cut",!1,null),e._addtoUndoBuffer()):(e._execCopy(!0),e._deleteSelectionContent(),e._addtoUndoBuffer())},t.prototype._execCopy=function(e){var t=this,n=t._getDesignViewDocument();if(!t._getSelectedContent())return;n.queryCommandSupported("Copy")&&n.queryCommandEnabled("Copy")?(n.execCommand("Copy",!1,null),t._addtoUndoBuffer()):t._copyToClipboard(t._getSelectedContent(),e)},t.prototype._execPaste=function(){var e=this,t,n=e._getDesignViewDocument();if(n.queryCommandSupported("Paste")&&n.queryCommandEnabled("Paste"))n.execCommand("Paste",!1,null),e._addtoUndoBuffer();else try{t=e._copyFromClipboard(),t&&t!==""&&e.insertHTML(t)}catch(r){}},t.prototype._getFontSizeCollection=function(){return{"10px":Ht,"13px":Bt,"16px":jt,"18px":Ft,"24px":It,"32px":qt,"48px":Rt,1:Ht,2:Bt,3:jt,4:Ft,5:It,6:qt,7:Rt}},t.prototype._updateButtonStates=function(e){var t=this,r=t._getDesignViewDocument(),i,s,o={},u=[Y,Z,et,tt,nt,rt,V,$,R,U,z,W],a,f=e.target,l=n(f);n.each(u,function(e,t){o[t]=r.queryCommandState(t)}),t.$ribbon.wijribbon(E,o),i=t._queryCommandValue(Ut)||"",n.each(t.$ribbon.wijribbon("getDropdownList",Ut),function(e,t){if(t.toUpperCase()===i.toUpperCase())return s=e,!1}),t.$ribbon.wijribbon(w,s,!0,Ut),t._isFontSizeCustomized()?(l.is("span")?s=f.style.fontSize:s="",s===""&&(a=l.parents("span."+vs),n.each(a,function(e,t){s=t.style.fontSize;if(s&&s!=="")return!1})),s===""&&(s=l.css("font-size"))):(i=t._queryCommandValue(zt)||"",i===""&&(i=l.css("font-size")),n.each(t._getFontSizeCollection(),function(e,t){if(e.toString()===i.toString())return s=t,!1})),t.$ribbon.wijribbon(w,s,!0,zt)},t.prototype._queryCommandValue=function(e){var t=this._getDesignViewDocument(),n;try{if(!t.queryCommandEnabled(e))return null}catch(r){return null}try{return n=t.queryCommandValue(e),e===Ut&&n&&(n=n.replace(/'/g,"")),n}catch(i){}return null},t.prototype._escActionAssociated=function(){var e=this,t=e._getDesignViewWindow();t&&t.document&&t.document.selection!==undefined&&t.document.selection.empty(),t&&t.getSelection!==undefined&&t.getSelection().removeAllRanges(),e._hideAllDropdownsMenus()},t.prototype._hideAllDropdownsMenus=function(){var e=this;e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]("hideAllMenus"),e.$ribbon.wijribbon("hideDropdown",Ut).wijribbon("hideDropdown",zt).wijribbon("hideDropdown",lt)},t.prototype._onDesignViewKeyDown=function(e){var t=this,n;t._setSaveBtnEnabled();try{if(e.ctrlKey)n=String.fromCharCode(e.keyCode).toLowerCase();else switch(e.keyCode){case 27:t._escActionAssociated();break;case 13:case 46:t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1;break;default:t._continueSavingInputTextForUndo=!0}}catch(r){}},t.prototype._onDesignViewKeyUp=function(e){var t=this,r;if(e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40||e.keyCode===33||e.keyCode===34||e.keyCode===35||e.keyCode===36)n.browser.msie&&n.browser.version==="6.0"?(t._keyTimeoutHandlerIE6&&(clearTimeout(t._keyTimeoutHandlerIE6),t._keyTimeoutHandlerIE6=null),t._keyTimeoutHandlerIE6=window.setTimeout(function(){t._updateButtonStates(e)},300)):t._updateButtonStates(e);if(e.ctrlKey){r=String.fromCharCode(e.keyCode).toLowerCase();switch(r){case"y":t._redoAction(),e.preventDefault(),e.stopPropagation();break;case"z":t._undoAction(),e.preventDefault(),e.stopPropagation();break;case"x":case"v":t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1}}},t.prototype._onDesignViewMouseUp=function(e){var t=this,r;if(e.button===2)return;t._updateButtonStates(e),t.options.showPathSelector&&t._refreshPathSelector(),t._hideAllDropdownsMenus(),t.editor.mouseup();if(n.browser.msie){r=n(e.target).closest("a");if(e.ctrlKey&&r.length>0)try{r.focus(),s.open(r[0].href,"_blank")}catch(i){}}},t.prototype._onDesignViewBlur=function(e){var t=this,r=t.options,i;i=t._getDesignViewText(),r.mode==="bbcode"&&(i=t._convertHtmlToBBCode(n.trim(i))),t.sourceView.val(i),t._onTextChange(e),r.text=i},t.prototype._onTextChange=function(e){var t=this;t._continueSavingInputTextForUndo&&(t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1),t._trigger("textChanged",e,{text:t.options.text})},t.prototype._onSourceViewBlur=function(e){var t=this,n;n=t.sourceView.val(),t.options.text!==n&&(t._setDesignViewText(n),t._onTextChange(e),t.options.text=n)},t.prototype._convertBBCodeToHtml=function(e){return e?(e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),n.browser.msie&&(e=e.replace(/&lt;p&gt;/gim,"<p>"),e=e.replace(/&lt;\/p&gt;/gim,"</p>")),e=e.replace(/(?:\r\n|\n|\r)/g,"<br>"),e=e.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>'),e=e.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>'),e=e.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>'),e=e.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>'),e=e.replace(/\[B\]/gim,"<b>"),e=e.replace(/\[\/B\]/gim,"</b>"),e=e.replace(/\[I\]/gim,"<i>"),e=e.replace(/\[\/I\]/gim,"</i>"),e=e.replace(/\[S\]/gim,"<strike>"),e=e.replace(/\[\/S\]/gim,"</strike>"),e=e.replace(/\[U\]/gim,"<u>"),e=e.replace(/\[\/U\]/gim,"</u>"),e=e.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>'),e=e.replace(/\[BLOCK\]/gim,"<blockquote>"),e=e.replace(/\[\/BLOCK\]/gim,"</blockquote>"),e=e.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>"),e=e.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>"),e=e.replace(/\[\*\]/gim,"</li><li>"),e=e.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">'),e=e.replace(/\[\/size\]/gim,"</font>"),e=e.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">'),e=e.replace(/\[\/color\]/gim,"</font>"),e):""},t.prototype._replaceComplexHtml=function(e){var t,r,i,s,o=n("<div/>").html(e);t=n("img",o),n.each(t,function(){i="[IMG height="+n(this).height()+" width="+n(this).width()+"]"+n(this).attr("src").toString()+"[/IMG]",n(this).replaceWith(i)}),r=n("font",o);for(s=r.length-1;s>=0;s--)n(r[s]).attr("color")&&n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"]"+"[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size][/Color]":n(n(r[s])).attr("color")&&!n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"] "+n(n(r[s])).html()+"[/Color]":n(n(r[s])).attr("size")&&!n(n(r[s])).attr("color")&&(i="[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size]"),n(n(r[s])).replaceWith(i);return o.html()},t.prototype._convertHtmlToBBCode=function(e){var t=this;if(e==="")return;return e=t._replaceComplexHtml(e),e=e.replace(/<br(?=[ \/>]).*?>/gim,"\r\n"),n.browser.msie&&(e=e.replace(/<p>/gim,"&lt;p&gt;"),e=e.replace(/<\/p>/gim,"&lt;/p&gt;")),e=e.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]"),e=e.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]"),e=e.replace(/<(?:b|strong)>/gim,"[B]"),e=e.replace(/<\/(?:b|strong)>/gim,"[/B]"),e=e.replace(/<(?:i|em)>/gim,"[I]"),e=e.replace(/<\/(?:i|em)>/gim,"[/I]"),e=e.replace(/<(?:strike|s)>/gim,"[S]"),e=e.replace(/<\/(?:strike|s)>/gim,"[/S]"),e=e.replace(/<u>/gim,"[U]"),e=e.replace(/<\/u>/gim,"[/U]"),e=e.replace(/<blockquote.*?\>/gim,"[BLOCK]"),e=e.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]"),e=e.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]"),e=e.replace(/<\/(?:ol)>/gim,"[/LIST]"),e=e.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]"),e=e.replace(/<\/(?:ul)>/gim,"[/LIST]"),e=e.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1"),e=e.replace(/&nbsp;/gi," "),e=e.replace(/(<[^>]+>)/gm,""),e},t.prototype._convertFontStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o=n("[style*='color: ']",r);o.length!==0&&(i=o,s="<font color='"+e._getWebColorFromRgb(o.css("color"))+"'></font>"),i&&n.each(i,function(e){n(this).is("span")?n(this).replaceWith(n(s).html(n(this).html())):n(this).is("font")&&n(this).attr("size")&&n(this).removeAttr("style").html(n(s).html())})},t.prototype._convertStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o,u=n("[style*='font-weight: bold;']",r),a=n("[style*='font-style: italic;']",r),f=n("[style*='text-decoration: line-through;']",r),l=n("[style*='text-decoration: underline;']",r);u.length!==0?(i=u,s="<b></b>",o="font-weight"):a.length!==0?(i=a,s="<i></i>",o="font-style"):f.length!==0?(i=f,s="<strike></strikes>",o="text-decoration"):l.length!==0&&(i=l,s="<u></u>",o="text-decoration"),i&&n.each(i,function(e){n(this).is("span")&&this.style.fontSize===""?n(this).replaceWith(n(s).html(n(this).html())):n(this).removeAttr("style").html(n(s).html())})},t.prototype._getWebColorFromRgb=function(e){var t=this,n;return e.indexOf("rgb(")===0&&(n=e.substring(4,e.length-1).split(","),e=t._convertToWebColor(u(n[0]),u(n[1]),u(n[2]))),e},t.prototype._updateList=function(e,t){var r;n("option",t).remove();for(r in e)e[r]&&t.append("<option>"+r+"</option>")},t.prototype._triggerEvent=function(e,t){var n=this,r=n.options[e];return r&&typeof r=="function"?r.call(n,t):r},t.prototype._closeDialog=function(){this.dialog.wijdialog("close"),this.rangeSelection=null,this.focus()},t.prototype._onTemplateList=function(e){return this._triggerEvent("templateList",e)},t.prototype.updateTemplateList=function(e,t){var r=this,i=t||n("select",r.dialog);r._updateList(e,i),r._templateList=e},t.prototype.initTemplateDialog=function(){var e=this,t=e.dialog,r=n("select",t),i=e._onTemplateList();t.delegate("select","change."+e.widgetName,function(){e.templateListOnChanged()}).delegate("."+Zr,"click."+e.widgetName,function(){e.deleteTemplate()}).delegate("."+ei,"click."+e.widgetName,function(){e.saveTemplate()}).delegate(ms,"click."+e.widgetName,function(){e.applyTemplate()}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()});if(!i){i=e._templateList;if(!i)return}e.updateTemplateList(i,r)},t.prototype.templateListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=n("iframe",t),s=e._templateList,o;if(!s)return;o=s[r],o.src&&i.attr("src",o.src+"?d="+(new Date).getMilliseconds().toString()),o.text&&i.length>0&&i[0].contentWindow.document.write(o.text),r&&(n("."+$r,t).html(r),n("."+Qr,t).val(r)),o.desc&&(n("."+Jr,t).html(o.desc),n("."+Gr,t).val(o.desc))},t.prototype._onSaveTemplate=function(e){this._triggerEvent("saveTemplate",e)},t.prototype.saveTemplate=function(){var e=this,t=e.dialog,r=n("."+Qr,t).val(),s=n("."+Gr,t).val(),o=e._templateList,u=this._getDesignViewText();if(n.trim(r)===""){i(this.localizeString("errorMessageTemplateNameError","Please input a template name!"));return}o||(e._templateList=[],o=e._templateList),o[r]||n("select",t).append("<option>"+r+"</option>"),o[r]={desc:s,text:u},e._onSaveTemplate({name:r,desc:s,text:u})},t.prototype._onDeleteTemplate=function(e){this._triggerEvent("deleteTemplate",e)},t.prototype.deleteTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=e._templateList;if(n.trim(s)===""){i(this.localizeString("errorMessageTemplateFileError","Please select a template file."));return}n("option:selected",r).remove(),n("iframe",t).attr("src","about:blank"),n("."+$r,t).empty(),n("."+Qr,t).val(""),n("."+Jr,t).empty(),n("."+Gr,t).val(""),delete o[s],e._onDeleteTemplate(s)},t.prototype.applyTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=n("iframe",t)[0],u=n("."+Qr,t).val(),a=o.contentWindow.document.body.innerHTML;if(n.trim(u)===""||n.trim(s)===""){i(this.localizeString("errorMessageValidTemplateFileError","Please select a valid template file."));return}e._setDesignViewText(a),e._addtoUndoBuffer(),e._setSaveBtnEnabled(),e._closeDialog()},t.prototype._onImageList=function(){var e=this,t=e.options.imageList;return t&&typeof t=="function"?t.call(e):t},t.prototype.updateImageList=function(e,t){var r=this,i=r.dialog,s=t||n("select",i),o=n("."+Or,i);r._updateList(e,s),r._imgList=e;if(!e){o.addClass(Fr);return}o.removeClass(Fr)},t.prototype.initImageBrowserDialog=function(){var e=this,t=e.dialog,r=e._onImageList();n("img",t).hide(),t.delegate("select","change."+e.widgetName,function(){e.imageListOnChanged()}).delegate(ms,"click."+e.widgetName,function(t){e.submitInsertImageDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}),n("."+Dr+" input",t).bind("change."+e.widgetName,function(){e.imageUrlChanged(this)});if(!r){r=e._imgList;if(!r){n("."+Or,t).addClass(Fr);return}}e.updateImageList(r,n("select",t))},t.prototype.imageUrlChanged=function(e){var t=this,r=t.dialog;n("img",this.dialog).attr("src",n(e).val()+"?"+(new Date).getTime()).show().bind("load",function(){n("."+Hr+" input",r).val(n("img",r).width().toString()),n("."+Br+" input",r).val(n("img",r).height().toString())})},t.prototype.imageListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=e._imgList,o;if(!i)return;o=i[r],n("img",t).prop("src",o).show(),n("."+Dr+" input",t).prop("value",o),s.setTimeout(function(){n("."+Hr+" input",t).val(n("img",t).width().toString()),n("."+Br+" input",t).val(n("img",t).height().toString())},200)},t.prototype.submitInsertImageDialog=function(){var e=this,t,r=e.dialog,s=n("."+Dr+" input",r).val(),o=n("."+Pr+" input",r).val(),u=n("."+Hr+" input",r).val(),a=n("."+Br+" input",r).val(),f=n("."+jr+" input",r).val();if(n.trim(s)===""){i(this.localizeString("errorMessageSelectImageError","Please select a image."));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageImageWidthError","Please input a number for 'Image width' textbox."));return}if(!e._isNumeric(a)){i(this.localizeString("errorMessageImageHeightError","Please input a number for 'Image height' textbox."));return}e.focus(),n.browser.msie?(t='<img src="'+s+'" alt="'+o+'" style="width:'+u+"px;height:"+a+"px",e.options.mode!=="bbcode"&&f!==null&&f!==undefined&&f.length>0&&(t+=";"+f)):(t='<img src="'+s+'" alt="'+o+'" width="'+u+'" height="'+a,e.options.mode!=="bbcode"&&(t+='" style="'+f)),t+='"/>',e.insertHTML(t),e._closeDialog()},t.prototype.initHyperLinkDialog=function(){var e=this,t=e.dialog,r=e.getLinkHrefField(),i=n("."+ci,t),o,u,a,f=n("."+si+" input",t),l=n("."+ni+" input",t);t.one("wijdialogclose",function(){e._restoreSelectionForIE()}),t.delegate(ms,"click."+e.widgetName,function(t){e.submitHyperLinkDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+ii,"change."+e.widgetName,function(){e.anchorListOnChanged(this)}).delegate("."+ri+">div","click."+e.widgetName,function(){e.radioListOnChanged()}).delegate("."+hi+">div","click."+e.widgetName,function(){e.linkIconTypeOnChanged()}).delegate("."+ai+" input","change."+e.widgetName,function(){e.tempImg=n('<img src="'+n("."+ai+" input",t).val()+'">').appendTo("body"),s.setTimeout(function(){n("."+fi+" input",t).val(e.tempImg.width().toString()),n("."+li+" input",t).val(e.tempImg.height().toString()),e.tempImg.remove(),e.tempImg=undefined},200)});try{l.val(r),u=e._getLinkInnerHTML()}catch(c){}u&&u.substring(0,3)==="<img"?(o=!0,a=n(u)):o=!1,o?(i.show(),f.hide(),n("."+ai+" input",t).val(a.attr("src")),n("."+fi+" input",t).val(a.attr("width")),n("."+li+" input",t).val(a.attr("heigth"))):(f.show(),i.hide(),f.val(u)),n("."+ui+" input",t).val(e._getLinkCssField()),n("."+oi+" select",t).val(e._getLinkTarget()),n("#radAnchor",t).prop("checked",!0),n("#radLinkTypeIsText",t).prop("checked",!0),r.length>6&&(r.substring(0,4)==="http"?n("#radUrl",t).prop("checked",!0):r.substring(0,6)==="mailto"?n("#radMail",t).prop("checked",!0):r.substring(0,1)==="#"?n("#radAnchor",t).prop("checked",!0):n("#radFile",t).prop("checked",!0)),l.focus(),a=undefined},t.prototype._getLinkInnerHTML=function(){var e=this,t,r;e.focus(),t=e._getInspectElement(),e._hyperlinkTextStyle="";try{r=e._getHyperLinkElement(t);if(r&&r.tagName==="A")return t.innerHTML!==r.innerHTML&&(e._hyperlinkTextStyle=r.innerHTML.replace(t.innerHTML,"{0}")),n(t).text()}catch(i){}return""},t.prototype.getLinkHrefField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{t=e._getHyperLinkElement(t);if(t&&t.tagName==="A")return e.fixAbsoluteUrlsIfNeeded(t.href||"")}catch(n){}return""},t.prototype._getLinkTarget=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{t=e._getHyperLinkElement(t);if(t&&t.tagName==="A")return t.target||""}catch(n){}return""},t.prototype._getLinkCssField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{t=e._getHyperLinkElement(t);if(t&&t.tagName==="A")return t.style.cssText||""}catch(n){}return""},t.prototype.submitHyperLinkDialog=function(){var e=this,t=e.dialog,r=n("#radUrl",t),s=n("#radAnchor",t),o=n("#radMail",t),u=n("."+ni+" input",t),a=n("."+si+" input",t),f=n("."+ui+" input",t),l=n("."+oi+" select",t),c=u.val(),h=a.val(),p=l.val(),d=n("#radLinkTypeIsImage",t),v=d.prop("checked"),m=n("."+ai+" input",t).val(),g=n("."+fi+" input",t).val(),y=n("."+li+" input",t).val(),b=f.val();if(c===""){i(this.localizeString("errorMessageAddressError","Please input address!"));return}if(h===""&&!v){i(this.localizeString("errorMessageDisplayTextError","Please input display text!"));return}if(m===""&&v){i(this.localizeString("errorMessageHyperLinkImageUrlError","Please input image url!"));return}if(!e._isNumeric(g)&&v){i(this.localizeString("errorMessageHyperLinkImageWidthError","Please input correct image width!"));return}if(!e._isNumeric(y)&&v){i(this.localizeString("errorMessageHyperLinkImageHeightError","Please input correct image height!"));return}if(r.prop("checked")&&!e._isUrl(c)){i(this.localizeString("errorMessageHyperLinkUrl","Please input correct url!"));return}if(s.prop("checked")&&!e._isAnchor(c)){i(this.localizeString("errorMessageHyperLinkAnchor","Please input correct anchor!"));return}if(o.prop("checked")&&!e._isEmail(c)){i(this.localizeString("errorMessageHyperLinkEmail","Please input correct email!"));return}v&&(h='<img src="'+m+'" width="'+g+'" height="'+y,h+='"/>'),e._closeDialog(),e._editLink(h,c,b,p)},t.prototype._editLink=function(e,t,n,r){var i=this,s="",o;i.focus(),o=i._getInspectElement();try{o=i._getHyperLinkElement(o);if(o&&o.tagName==="A"){o.innerHTML=i._hyperlinkTextStyle&&i._hyperlinkTextStyle!==""?i._hyperlinkTextStyle.replace("{0}",e):e,o.href=t,o.target=r,n!==o.style.cssText&&(o.style.cssText=n),i._addtoUndoBuffer(),i._setSaveBtnEnabled();return}}catch(u){}s='<a href="'+t+'" target="'+r+'"',n!==""&&(s+=' style="'+n+'"'),s+=">"+e+"</a>",i.insertHTML(s)},t.prototype.anchorListOnChanged=function(e){var t=this,r=t.dialog,i=n(e).val();i!==""&&(n("."+ni+" input",r).val(i),n("#radAnchor",r).attr("checked","checked"))},t.prototype.radioListOnChanged=function(){var e=this,t=e.dialog,r=n("."+ii,t),i=n("."+ni+" input",t);i.val(""),n("#radUrl",t).is(":checked")?r.hide():n("#radAnchor",t).is(":checked")?r.show():n("#radMail",t).is(":checked")?(r.hide(),i.val(this.localizeString("insertHyperLinkMailTo","mailto:"))):n("#radFile",t).is(":checked")&&r.hide()},t.prototype.linkIconTypeOnChanged=function(){var e=this,t=e.dialog,r=n("."+ci,t),i=n("."+si,t);n("#radLinkTypeIsText",t).is(":checked")?(i.show(),r.hide()):n("#radLinkTypeIsImage",t).is(":checked")&&(i.hide(),r.show())},t.prototype._getDialogRes_Code=function(){var e=this,t=a.createDiv(ti);return t.add(a.createElement("div",this.localizeString("insertCodeDialogEnterSourceCode","Enter source code:"),{"class":vi})),t.add(a.createElement("textarea","",{"class":di})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype.initInsertCodeDialog=function(){var e=this,t=e.dialog;t.delegate(ms,"click."+e.widgetName,function(t){e.submitCodeDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCodeDialog=function(){var e=this,t=e.dialog,r=n("."+di,t),i=r.val();if(i==="")return;i=i.replace(/</g,"&lt;"),i=i.replace(/>/g,"&gt;"),i="<pre>"+i+"</pre>",e._setIESelection(),e.insertHTML(i),e._closeDialog()},t.prototype.initTagInspectorDialog=function(){var e=this,t=e.dialog,r=n("."+xi);t.delegate(ms,"click."+e.widgetName,function(t){e.submitTagInspectorDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("#displayNoEmpty","click."+e.widgetName,function(){e.tagInspectorDialogSwitchAttList(this)}),e._laySelectedElementAttributes(n("."+Si,t),n("."+bi,t)),n("."+Ti+" input",t).val(e._getSelectedElementStyle()),e._selectedElementCanHaveChildren()?(r.show(),n("textarea",r).val(e._getSelectedElementInnerHTML())):r.hide()},t.prototype.submitTagInspectorDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i=n("."+Si,t),s=n("."+Ti+" input").val(),o=n("."+xi+" textarea").val();try{n.each(n("input:checkbox",i),function(e,t){var i,s,o=n(t);o.is(":checked")&&(i=o.siblings("span").text(),i=i.substring(0,i.length-1),s=o.siblings("input:text").val(),n(r).attr(i,s))}),n.trim(s)!==""&&(r.style.cssText=s),e._selectedElementCanHaveChildren()&&n(r).html(o)}catch(u){}e._closeDialog(),e._addtoUndoBuffer(),e._setSaveBtnEnabled()},t.prototype.tagInspectorDialogSwitchAttList=function(e){var t=n("."+Si,this.dialog),r=!e.checked;n.each(n("input:text",t),function(e,t){n(t).val()===""&&n(t).parent("li")[r?"show":"hide"]()})},t.prototype._laySelectedElementAttributes=function(e,t){var r=this,i=r._getInspectElement(),s,o,u,a=this.localizeString("tagInspectorDialogSave","Save"),f="";if(!i)return;t.html(i.tagName),s=r._getDictionaryDeclare(),o=i.tagName.toLowerCase(),u=s[o];switch(o){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":f+="<ul class='ui-helper-reset'>",n.each(u,function(e,t){var n=i.getAttribute(t)||"";f+="<li><span class='"+Cr+"'>",f+=t+":</span>",f+="<input type='text' aria-label='text' value='"+n+"'/>",f+="<input type='checkbox' id='save"+e+"'/>",f+="<label for='save"+e+"'>"+a+"</label></li>"})}e.html(f)},t.prototype._getSelectedElementStyle=function(){var e=this._getInspectElement();return e&&e.style?e.style.cssText||"":""},t.prototype._getSelectedElementInnerHTML=function(){var e=this._getInspectElement();return e?e.innerHTML:""},t.prototype._selectedElementCanHaveChildren=function(){return!n(this._getInspectElement()).is("input,hr,br,img")},t.prototype.initBackColorDialog=function(){this._initColorDialog("BackColor")},t.prototype.initForeColorDialog=function(){this._initColorDialog("ForeColor")},t.prototype._initColorDialog=function(e){var t=this,r=t.dialog,i=t._getDesignViewDocument(),s=i.queryCommandValue(e),o,a,f;r.delegate(ms,"click."+t.widgetName,function(n){t.submitColorDialog(e),t._onDesignViewBlur(n)}).delegate(gs,"click."+t.widgetName,function(){t._closeDialog()});if(s){f=s.toString(),n.browser.mozilla&&f==="transparent"&&(f="#ffffff");if(n.browser.msie||!isNaN(f))o=u(f),f="rgb("+(o&255)+", "+((o&65280)>>8)+", "+((o&16711680)>>16)+")";f.indexOf("rgb(")===0?(a=f.substring(4,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))):f.indexOf("rgba(")===0&&(a=f.substring(5,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))),n("."+ki+" input",r).attr("value",f)}n("."+Ci,r).wijeditorcolorcanvas("."+ki+" input",f)},t.prototype.submitColorDialog=function(e){var t=this,r=n("."+ki+" input",t.dialog);t.setColor(e,r.val()),t._closeDialog()},t.prototype.setColor=function(e,t){var r=this,i,s=r._getDesignViewDocument(),o=r._getDesignViewWindow(),u;r._setIESelection(),n.browser.mozilla&&e==="BackColor"?(u=o.getSelection(),r.insertHTML('<span style="background-color:'+t+';">'+u+"</span>")):(s.execCommand(e,!1,t),n.browser.msie&&(i=r._getHtmlTextInIE(s),i.indexOf("<U>")>=0&&i.indexOf("</U>")>=0&&(s.execCommand("Underline",!1,!1),s.execCommand("Underline")),i.indexOf("<STRIKE>")>=0&&i.indexOf("</STRIKE>")>=0&&(s.execCommand("StrikeThrough",!1,!1),s.execCommand("StrikeThrough"))),r.options.mode==="bbcode"&&!n.browser.msie&&r._convertFontStyleToStandTag()),r._addtoUndoBuffer(),r._setSaveBtnEnabled()},t.prototype.initInsertTableDialog=function(){var e=this,t=e.dialog;t.delegate(ms,"click."+e.widgetName,function(t){e.submitInsertTableDialog(),e._onDesignViewBlur(t)}).delegate(bs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+ji+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this,t)})},t.prototype.submitInsertTableDialog=function(){var e=this,t=e._getValuesFromTableDialog();if(!t)return;e._insertTable(t),e._closeDialog()},t.prototype._insertTable=function(e){var t=this,r="",i,s;if(!e)return!1;t.focus(),r+='<table width="'+e.width+'" height="'+e.height+'" cellspacing="'+e.cspacing+'" cellpadding="'+e.cpadding+'" border="'+e.border+'" bgcolor="'+e.bgcolor+'" style="'+e.css+'">';for(i=0;i<e.rows;i++){r+="<tr>";for(s=0;s<e.cols;s++)r+="<td>Cell "+(i+1)+"-"+(s+1)+"</td>";r+="</tr>"}r+="</table>";if(n.browser.mozilla||n.browser.msie&&u(n.browser.version)>=9||this._isEdge)r+="<br />";t.insertHTML(r)},t.prototype.initEditTableDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i,s;t.delegate(ms,"click."+e.widgetName,function(t){e.submitEditTableDialog(),e._onDesignViewBlur(t)}).delegate(bs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+ji+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this,t)});if(!r)return;try{i=r.rows,i.length>0?s=i[0].cells.length:s=0,i=i.length}catch(o){}n("."+Ai+" input",t).val(i),n("."+Oi+" input",t).val(s),n("."+Mi+" input",t).val(r.getAttribute("width")),n("."+_i+" input",t).val(r.getAttribute("height")),n("."+Di+" input",t).val(r.getAttribute("border")),n("."+Pi+" input",t).val(r.getAttribute("cellPadding")),n("."+Hi+" input",t).val(r.getAttribute("cellSpacing")),n("."+ji+" input",t).val(r.getAttribute("bgcolor")||"#ffffff"),n("."+Bi+" input",t).val(r.style.cssText)},t.prototype.submitEditTableDialog=function(){var e=this,t=e._getInspectElement(),r=n(t),i=e._getValuesFromTableDialog(),s=i&&u(i.rows),o=i&&u(i.cols),a,f;if(!i)return;if(t){r.attr("width",i.width),r.attr("height",i.height),r.attr("bgcolor",i.bgcolor),r.attr("border",i.border),r.attr("cellSpacing",i.cspacing),r.attr("cellPadding",i.cpadding),t.style.cssText=i.css;if(!s||isNaN(s))return;if(!o||isNaN(o))return;while(t.rows.length>s)t.deleteRow(0);while(t.rows.length<s){a=t.insertRow(0);while(a.cells.length<o)f=a.insertCell(0),f.innerHTML="&nbsp;"}n.each(t.rows,function(e,t){while(t.cells.length>o)t.deleteCell(0);while(t.cells.length<o)f=t.insertCell(0),f.innerHTML="&nbsp;"})}e._closeDialog()},t.prototype._getValuesFromTableDialog=function(){var e=this,t=e.dialog,r=n("."+Ai+" input",t).val(),s=n("."+Oi+" input",t).val(),o=n("."+Mi+" input",t).val(),a=n("."+_i+" input",t).val(),f=n("."+Di+" input",t).val(),l=n("."+Pi+" input",t).val(),c=n("."+Hi+" input",t).val(),h=n("."+Bi+" input",t).val(),p=n("."+ji+" input",t).val();return e._isNumeric(r)?e._isNumeric(s)?e._isNumeric(o)?e._isNumeric(a)?e._isNumeric(f)?e._isNumeric(l)?e._isNumeric(c)?{rows:r,cols:s,width:u(o),height:u(a),border:f,cpadding:l,cspacing:c,css:h,bgcolor:p}:(i(this.localizeString("tableDialogCellSpacingError","Please input a number for 'Cell Spacing' textbox.")),!1):(i(this.localizeString("tableDialogCellPaddingError","Please input a number for 'Cell Padding' textbox.")),!1):(i(this.localizeString("tableDialogBorderError","Please input a number for 'Border thickness' textbox.")),!1):(i(this.localizeString("errorMessageTableHeightError","Please input a number for 'Table Height' textbox.")),!1):(i(this.localizeString("errorMessageTableWidthError","Please input a number for 'Table Width ' textbox.")),!1):(i(this.localizeString("errorMessageColumnsError","Please input a number for 'Columns' textbox.")),!1):(i(this.localizeString("errorMessageRowsError","Please input a number for 'Rows' textbox.")),!1)},t.prototype.showTableColorDialog=function(e,t){var r=this,i,s=r.subDialog,o=n(e).prev().val(),a=r._getDialogRes_Color();i={width:"auto",height:"auto",modal:!0,title:r.localizeString("backColorDialogTitle","Set BackColor"),position:{my:"center",at:"center",of:window},resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}},close:function(){t.focus()}},s.empty().append(a),n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){s.wijdialog(i)},0):s.wijdialog(i),s.delegate(ys,"click."+r.widgetName,function(){r.submitTableColorDialog()}).delegate(bs,"click."+r.widgetName,function(){r.closeSubDialog()}),o!==""&&n("."+ki+" input",s).val(o),n("."+Ci,s).wijeditorcolorcanvas("."+ki+" input",o),s.wijdialog("open")},t.prototype.submitTableColorDialog=function(){var e=this,t=e.subDialog,r=e.dialog,i=n("."+ki+" input",t).val();n("."+ji+" input:text",r).val(i),e.closeSubDialog()},t.prototype.closeSubDialog=function(){this.subDialog.wijdialog("close")},t.prototype._getEditableTable=function(){var e=this,t,r,s;r=e._getSelectedElement();if(!r)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;s=n(r);if(s.is("td,tr,tbody,th"))r=s.parents("table:first")[0];else if(!s.is("table")){t=s.find("table:only-child");if(!n.browser.msie||!t.length)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;r=t[0]}return g=r,!0},t.prototype.initPreviewDialog=function(){var e=this,t=e.dialog;e._setPreviewContent(0),t.one("wijdialogclose",function(){e._curPageIdx=0}),t.delegate("#rad640_480","click."+e.widgetName,function(){e._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+e.widgetName,function(){e._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+e.widgetName,function(){e._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+e.widgetName,function(){e._splitPreviewPages(this.checked)}).delegate("."+zi,"click."+e.widgetName,function(){e._printPreviewPage(!0)}).delegate("."+Wi,"click."+e.widgetName,function(){e._printPreviewPage(!1)}).delegate("."+Xi,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Ri,"click."+e.widgetName,function(){e._navigatePreviewPage(!1)}).delegate("."+Ui,"click."+e.widgetName,function(){e._navigatePreviewPage(!0)})},t.prototype._setPreviewContent=function(e){var t=this,r=t.dialog,i=n("iframe",r),s=n("."+qi+" span",r),o=i[0].contentWindow.document;o.open(),e===-1?(o.write(t._getPreviewAllPageContent()),s.html("1 / 1")):(o.write(t._getPreviewPageContent(e)),s.html(e+1+" / "+t._getPreviewPageCount())),o.close()},t.prototype._setPreviewDialogSize=function(e,t){var r=this,i=r.dialog,s=n("iframe",i),o=i.wijdialog("option","width"),u=i.wijdialog("option","height");o==="auto"?o=i.parent(".wijmo-wijdialog").width()-s.width():o-=s.width(),u==="auto"?u=i.parent(".wijmo-wijdialog").height()-s.height():u-=s.height(),s.css("width",e).css("height",t),i.wijdialog("option",{width:e+o,height:t+u})},t.prototype._getPreviewPageCount=function(){return this._getPreviewPages().length},t.prototype._getPreviewPageContent=function(e){var t=this._getPreviewPages();return t.length>e?t[e]:null},t.prototype._getPreviewAllPageContent=function(){return this._getDesignViewText()},t.prototype._getPreviewPages=function(){var e=this._getPreviewAllPageContent(),t=new RegExp("<(HR|hr)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>","g"),n=e.replace(t,"!-~U^n#i@q,P|.a=g~e+br!");return n.split("!-~U^n#i@q,P|.a=g~e+br!")},t.prototype._splitPreviewPages=function(e){var t=this,r=t.dialog,i=n("."+Vi,r),s=n("."+qi,r);e?(t._setPreviewContent(0),s.show(),i.hide()):(t._setPreviewContent(-1),s.hide(),i.show()),t._curPageIdx=0},t.prototype._navigatePreviewPage=function(e){var t=this,r=n("#chkSplit",t.dialog),i=t._curPageIdx,s=t._getPreviewPageCount();r.is(":checked")&&(e?(i++,i<s?t._setPreviewContent(i):i=s-1):(i--,i>=0?t._setPreviewContent(i):i=0),t._curPageIdx=i)},t.prototype._printPreviewPage=function(e){var t=this,r=t.dialog,i=n("#chkSplit",r),s=n("iframe",r)[0].contentWindow;e&&(i.removeAttr("checked"),t._setPreviewContent(-1)),s.focus(),s.print()},t.prototype.initCleanUpDialog=function(){var e=this,t=e.dialog;n("textarea",t).val(e.sourceView.val()),t.delegate(ms,"click."+e.widgetName,function(t){e.submitCleanUpDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCleanUpDialog=function(){var e=this,t=e.dialog,r=e.sourceView,i=r.val(),s;n("#replaceSpans",t).is(":checked")&&(s=new RegExp("<\\/?SPAN[^>]*>","g"),i=i.replace(s,"")),n("#replaceClass",t).is(":checked")&&(s=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3")),n("#replaceStyle",t).is(":checked")&&(s=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g"),i=i.replace(s,"<$1$3"),s=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3"),s=new RegExp("<\\\\?\\?xml[^>]*>","g"),i=i.replace(s,""),s=new RegExp("<\\/?\\w+:[^>]*>","g"),i=i.replace(s,"")),n("#replaceNbsp",t).is(":checked")&&(s=new RegExp("&nbsp;","g"),i=i.replace(s," ")),n("#transformPtoDiv",t).is(":checked")&&(s=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g"),i=i.replace(s,"<div$2</div>")),r.val(i),e._setDesignViewText(i),e._addtoUndoBuffer(),e._closeDialog()},t.prototype.initFindDialog=function(){var e=this,t=e.dialog;e.tRange&&(e.tRange=null),t.delegate(ms,"click."+e.widgetName,function(){e.submitFindAction()}).delegate(gs,"click."+e.widgetName,function(t){if(e.options.readOnly)return;e.submitReplaceAction(),e._onDesignViewBlur(t)})},t.prototype.submitFindAction=function(){var e=this,t=n("textarea:first",e.dialog).val();if(n.trim(t)==="")return;e._findAndReplaceString(t)},t.prototype.submitReplaceAction=function(){var e=this,t=e.dialog,r=n("textarea:first",t).val(),s=n("textarea:last",t).val();if(n.trim(r)==="")return;if(n.trim(s)===""){i(this.localizeString("errorMessageReplaceStringError","please input replace string!"));return}e._findAndReplaceString(r,s)},t.prototype._findAndReplaceString=function(e,t){var r=this,s=r._getDesignViewWindow(),o=0,u=!1,a,f=t&&t!==e;if(r._isEdge)return;t||(t=e);if(n.browser.msie)r.tRange&&(r.txtFoundInIE&&f?(o=r.tRange.findText(e),o&&(r.tRange.pasteHTML(t),r.tRange.collapse(!1),u=!0,r.txtFoundInIE=!1)):(r.tRange.collapse(!1),o=r.tRange.findText(e),o&&r.tRange.select())),!u&&(!r.tRange||!o)&&(r.tRange=s.document.body.createTextRange(),o=r.tRange.findText(e),o&&(r.tRange.select(),f&&(r.tRange.pasteHTML(t),u=!0)));else{if(r.txtFoundInNoneIE&&f)r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1;else{a=s.getSelection(),a.rangeCount>0&&a.collapseToEnd(),o=s.find(e);if(!o){o=s.find(e,0,1);while(s.find(e,0,1))continue}}r.txtFoundInNoneIE=r.txtFoundInNoneIE||o>0,r.txtFoundInNoneIE&&f&&(r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1)}!o&&!u?(i('"'+e+'"'+this.localizeString("errorMessageFindTextError"," String Not Found!")),r.tRange=null,r.txtFoundInNoneIE=!1,r.txtFoundInIE=!1):r.txtFoundInIE=!0},t.prototype._replaceSelectionForNoneIE=function(e){var t=this._getDesignViewDocument();t.execCommand("inserttext",!1,e)},t.prototype.initMediaDialog=function(){var e=this,t=e.dialog;t.delegate(ms,"click."+e.widgetName,function(t){e.submitMediaDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitMediaDialog=function(){var e=this,t=e.dialog,r=n("select",t).val(),s=n("."+rs+" input",t).val(),o=n("."+is+" input",t).val(),u=n("."+ss+" input",t).val();if(s===""){i(this.localizeString("errorMessageUrlEmptyError","URL is empty!"));return}if(!e._isUrl(s)){i(this.localizeString("errorMessageUrlCorrectError","please input correct URL!"));return}if(!e._isNumeric(o)){i(this.localizeString("errorMessageMediaWidthError","please input width of the media!"));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageMediaHeightError","please input height of the media!"));return}e._insertMedia(r,s,o,u),e._closeDialog()},t.prototype._insertMedia=function(e,t,n,r){var i=this,s="";i._setIESelection();switch(e){case"video":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'" '+'type=audio/x-pn-realaudio-plugin console="Clip1" '+'controls="IMAGEWINDOW,ControlPanel,StatusBar" '+'autostart="true"></embed>';break;case"flash":s+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+n+'" height="'+r+'">',s+='<param name="movie" value="'+t+'">',s+='<param name="wmode" value="opaque">',s+='<param name="quality" value="high">',s+='<embed src="'+t+'" quality="high" '+'pluginspage="http://www.macromedia.com/go/getflashplayer" '+'type="application/x-shockwave-flash" '+'width="'+n+'" height="'+r+'"></embed>',s+="</object>";break;case"applet":s+='<applet code="'+t+'" width="'+n+'" '+'height="'+r+'"></applet>';break;case"other":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'"></embed>'}i.insertHTML(s)},t.prototype.initSpecialCharacterDialog=function(){var e=this,t=e.dialog,r=n("."+fs+" span",t);t.delegate("label","click."+e.widgetName,function(t){e.submitSpecialCharacterDialog(this),e._onDesignViewBlur(t)}).delegate(ms,"click."+e.widgetName,function(){e._closeDialog()}).delegate("label","mouseover."+e.widgetName,function(){r.html(n(this).html())}).delegate("label","mouseout."+e.widgetName,function(){r.empty()})},t.prototype.submitSpecialCharacterDialog=function(e){var t=this;t._setIESelection(),t.insertHTML(n(e).html()),t._closeDialog()},t.prototype._setSaveBtnEnabled=function(){this.$ribbon.wijribbon(y,Mt,!1)},t.prototype._undoAction=function(){var e=this._getDesignViewDocument().body,t={};v--,v<=0&&(v=0),e.innerHTML=m[v],v?this.$ribbon.wijribbon(y,bt,!1):(t[yt]=!0,t[bt]=!1,this.$ribbon.wijribbon(b,t))},t.prototype._redoAction=function(){var e=this._getDesignViewDocument().body,t=m.length,n={};v++,v>=t-1&&(v=t-1),e.innerHTML=m[v],v===t-1?(n[yt]=!1,n[bt]=!0,this.$ribbon.wijribbon(b,n)):this.$ribbon.wijribbon(y,yt,!1)},t.prototype._addtoUndoBuffer=function(){var e=m.length-1-v,t;for(t=0;t<e;t++)m.pop();v++,m.push(this._getDesignViewText()),this.$ribbon.wijribbon(y,yt,!1)},t.prototype._deleteSelectionContent=function(){var e=this._getDesignViewWindow(),t,r,i,s="rangeCount";if(n.browser.msie)t=e.document.selection,t.type.toLowerCase()!=="none"&&t.clear();else{t=e.getSelection();for(r=0;r<t[s];r++)i=t.getRangeAt(r),i.deleteContents()}},t.prototype._refreshPathSelector=function(){var e=this,t=e._getParentElement(e._getDesignViewWindow()),r,i=e._getPathSelector(),s=n(t).parents(),o=s.length,u="wijmo-wijeditor-label ui-state-default ui-corner-all",a,f,l,c=n(".wijmo-wijeditor-footer",e.editor).outerWidth(!0),h=n(".wijmo-wijribbon-modes",e.editor).outerWidth(!0),p,d="";if(!t)return;r=t.tagName?t.tagName.toLowerCase():"",i.empty(),i.append("<label class='"+u+"'>&lt;"+s[o-1].tagName.toLowerCase()+"&gt;</label>"),p=n(".wijmo-wijeditor-pathselector>.wijmo-wijeditor-label",e.editor).outerWidth(!0),f=Math.floor((c-h)/p),l=Math.floor((c-h)/(p*2));if(o<=f)for(a=o-2;a>=0;a--)s[a]&&(d+="<label class='"+u+"'> &lt;"+s[a].tagName.toLowerCase()+"&gt;</label>");else{for(a=o-2;a>=o-l+1;a--)s[a]&&(d+="<label class='"+u+"'> &lt;"+s[a].tagName.toLowerCase()+"&gt;</label>");d+="<label class='"+u+"'>&lt;.......&gt;</label>";for(a=l-2;a>=0;a--)s[a]&&(d+="<label class='"+u+"'> &lt;"+s[a].tagName.toLowerCase()+"&gt;</label>")}d+="<label class='"+u+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+r+"&gt;</label>",i.append(d)},t.prototype._toggleTableBorders=function(){var e=this.options.tableVirtualBorderShowing;this._updateTableBorderShowing(!e),this.options.tableVirtualBorderShowing=!e},t.prototype._updateTableBorderShowing=function(e){var t=this._getDesignViewDocument(),r=n("#__wijStyle",t);n.browser.safari||this._isEdge?e?r.html("table,td,tr{border: 1px #acacac dashed;}"):r.empty():r.prop("disabled",!e)},t.prototype._tableAction=function(e){var t=this,r=t._getParentElement(t._getDesignViewWindow()),s=n(r).closest("td"),o,u,a,f,l,c,h,p,d,v,m=0;t._setSaveBtnEnabled();if(s.length===0&&e!==j)return!1;e!==j&&(o=s.parent(),u=o.closest("table"),a=s[0],f=o[0],l=u[0],c=f.rowIndex,h=a.cellIndex);try{switch(e){case P:p=f.cells.length,v=l.insertRow(c);for(m=0;m<p;m++)t._insertCell(v,m);break;case I:l.deleteRow(c);break;case D:d=l.rows.length;for(m=0;m<d;m++)t._insertCell(l.rows[m],h);break;case F:t._removeColumn(l,h);break;case H:t._insertCell(f,h+1);break;case q:p=f.cells.length,p===1?l.deleteRow(c):f.deleteCell(h);break;case B:t._splitCell(l,f,c,h);break;case j:t._mergeCell(t._getSelectedCells(r))}this._addtoUndoBuffer()}catch(g){return i(g.message),!1}return!0},t.prototype._removeColumn=function(e,t){var n=e.rows.length,r=0,i,s,o,u,a;while(r<n)i=e.rows[r],s=i.cells,o=s.length,u=t>o-1?o-1:t,a=s[u].colSpan,a>1&&o>1&&(u+1<o?s[u+1].colSpan+=a-1:s[u-1].colSpan+=a+1),o===1?(e.deleteRow(r),n=e.rows.length):(i.deleteCell(u),r++)},t.prototype._splitCell=function(e,t,n,r){var i=e.rows.length,s=0,o=0,u,a,f,l,c;while(s<=r)t.cells[s].colSpan>1&&(o+=t.cells[s].colSpan-1),s++;this._insertCell(t,r+1);if(t.cells[r].colSpan>1)t.cells[r].colSpan--;else for(f=0;f<i;f++){u=e.rows[f];if(f!==n){l=r,s=0,a=0;while(s<=l)u.cells[s].colSpan>1&&(a+=u.cells[s].colSpan-1,l-=a),s++;c=r+o-a,c<0&&(c=0),u.cells[c].colSpan++}}},t.prototype._mergeCell=function(e){var t=this,r=e.length,i=e[0].parentNode,s,o,u,a=e[r-1].parentNode,f=i.cells.length,l={},c,h=!0,p=[];if(r<2)return;if(f===1&&i!==a)for(var d=1;d<e.length;d++)e[0].innerHTML+=e[d].innerHTML,n(e[d].parentNode).remove();else if(f>1&&i===a){s=e[0].cellIndex,o=s+r;for(u=s+1;u<o;u++)i.cells[s].innerHTML+=i.cells[s+1].innerHTML,i.cells[s].colSpan++,i.deleteCell(s+1)}else f>1&&i!==a&&(n.each(e,function(t,n){c=e[t].parentNode.rowIndex,l[c]||(l[c]=[]),l[c].push(n)}),n.each(l,function(e,t){if(t.length!==f)return h=!1,!1}),h&&(n.each(l,function(e,n){p.push(n[0]),t._mergeCell(n)}),this._mergeCell(p)))},t.prototype._getSelectedCells=function(e){var t=this,r=this._getDesignViewWindow(),i=r.document,s=[],o,u,a,f,l,c,h,p,d;if(n.browser.msie)a=n(e).closest("tr")[0],u=t._getIESelectionRange(),o=a?a.cells:t._getPrepareTableCells(e),n.each(o,function(e,n){t._isIE11?t._checkSelectionIncludeNodeForIE11AndChrome(r,u,n)&&s.push(n):t._checkSelectionIncludeNodeExceptIE11(r,u,n)&&s.push(n)});else if(n.browser.mozilla){f=r.getSelection(),c=f.rangeCount;for(l=0;l<c;l++)u=f.getRangeAt(l),h=u.startContainer,p=h.nodeName.toLowerCase(),p==="td"||p==="th"?s.push(h):p==="tr"&&(d=u.startOffset,s.push(h.cells[d]))}else a=n(e).closest("tr")[0],f=r.getSelection(),f&&f.rangeCount>0&&(u=f.getRangeAt(0)),o=a?a.cells:t._getPrepareTableCells(e),n.each(o,function(e,n){t._checkSelectionIncludeNodeForIE11AndChrome(r,u,n)&&s.push(n)});return s},t.prototype._getPrepareTableCells=function(e){var t=n(e.parentElement),r;return r=t?t.children().children("tr").children("td"):[],r},t.prototype.insertDateAndTime=function(){var e=new Date;this.options.culture&&this.options.culture!==""?this.insertHTML(Globalize.format(e,"dddd ",Globalize.findClosestCulture(this.options.culture))+Globalize.format(e,"F",Globalize.findClosestCulture(this.options.culture))):this.insertHTML(e.toDateString()+" "+e.toTimeString())},t.prototype._toggleWordWrap=function(){var e=this,t=e.sourceView,r="wrap",i;d=!d,i=d?"soft":"off",t.attr(r,i),t[0].focus(),n.browser.mozilla&&(t.hide(),s.setTimeout(function(){t.show()},40))},t.prototype.insertHTML=function(e){var t=this,r=t._getDesignViewDocument(),i;try{n.browser.msie?(t._isIE11&&r.getSelection?i=t._getRangeForInsertHTML(r,e):(r.selection.type==="Control"&&r.selection.clear(),i=r.selection.createRange(),i.pasteHTML(e),i.collapse(!1),t.rangeSelection=null),t._setIESelection(i,!0)):r.execCommand("insertHTML",!1,e)}catch(s){if(n.browser.msie&&n.browser.version&&parseFloat(n.browser.version)>=9&&parseFloat(n.browser.version)<=10&&t.rangeSelection)try{i=t.rangeSelection,i.pasteHTML(e),i.collapse(!1),t._setIESelection(i,!0)}catch(s){}}t._addtoUndoBuffer(),t._setSaveBtnEnabled()},t.prototype._getRangeForInsertHTML=function(e,t){var n,r,i;return e.getSelection&&(n=e.getSelection(),this.rangeSelection?(r=this.rangeSelection,this.rangeSelection=null):n.getRangeAt&&n.rangeCount&&(r=n.getRangeAt(0)),r&&(r.deleteContents(),i=r.createContextualFragment(t),r.insertNode(i),r.collapse(!1))),r},t.prototype._setIEFocus=function(){var e=this._getDesignViewDocument();if(n.browser.msie)try{e.body.focus()}catch(t){}},t.prototype.focus=function(){var e=this._getDesignViewWindow(),t=e.document;n.browser.msie?this.rangeSelection?this._setIESelection():t.body?t.body.focus():t.onreadystatechange=function(){t.readyState==="complete"&&t.body.focus()}:e.focus()},t.prototype._setFocusNotIE=function(){var e=this,t,r;if(n.browser.msie)return;if(e._isEdge){e._setFocusForEdge();return}t=e._getDesignViewWindow();if(n.browser.mozilla){t.focus();return}r=t.document.body,r&&r.focus()},t.prototype._setFocusForEdge=function(){var e=this,t,r,i;if(!e._isEdge)return;t=n(e._getDesignViewWindow().document.body);if(!t.length)return;r=t.scrollTop(),i=t.scrollLeft(),t[0].focus(),t.scrollTop(r).scrollLeft(i)},t.prototype._createInputButton=function(e,t){var n={"class":e,type:"button",value:undefined};return t&&(n.value=t),a.createElement("input",n)},t.prototype._createTextField=function(e,t,n,r){var i=this,s=a.createDiv(t),o={type:"text",value:"","aria-label":e};return r&&(o.value=r),s.add(a.createSpan(Cr,e)),s.add(a.createElement("input",o)),n&&s.add(new Cs(n)),s},t.prototype._createTextAreaField=function(e,t,n,r){var i=a.createDiv(t);return i.add(a.createSpan(Cr,e)),i.add(a.createElement("textarea",n)),r&&i.add(new Cs(r)),i},t.prototype._createSeparator=function(){var e=this,t=a.createDiv(xr);return t.add(a.createElement("hr")),t},t.prototype._createOKCancelButtons=function(){var e=this,t=a.createDiv(Tr);return t.add(a.createElement("input",{type:"button","class":Nr,value:this.localizeString("dialogOK","OK")})),t.add(a.createElement("input",{type:"button","class":Nr,engValue:"Cancel",value:this.localizeString("dialogCancel","Cancel")})),t},t.prototype._getDialogRes_Template=function(){var e=this,t=a.createDiv(Ir),n=a.createDiv(qr),r=a.createDiv(zr),i=a.createDiv(Wr),s=a.createDiv(Xr),o=a.createDiv(Vr),u=a.createElement("div",this.localizeString("templateDialogName","Name :")),f=a.createElement("div",this.localizeString("templateDialogDescription","Description :")),l=a.createDiv(Kr),c=a.createDiv(Yr);return n.add(a.createElement("div",this.localizeString("templateDialogSelectTemplate","Select Template:"),{"class":Rr})),n.add(a.createElement("div",this.localizeString("templateDialogTemplatePreview","Template Preview:"),{"class":Ur})),t.add(n),i.add(a.createElement("select",{size:8,"aria-label":"Select Template"})),s.add(a.createElement("iframe",{frameborder:0})),r.add(i),r.add(s),t.add(r),u.add(a.createSpan($r)),f.add(a.createSpan(Jr)),o.add(u),o.add(f),t.add(o),l.add(a.createSpan(Cr,this.localizeString("templateDialogName","Name :"))),l.add(a.createTextBox(Qr,"","Name")),l.add(a.createSpan(Cr,this.localizeString("templateDialogDescription","Description :"))),l.add(a.createTextBox(Gr,"","Description")),t.add(l),c.add(e._createInputButton(Nr+" "+Zr,this.localizeString("templateDialogDeleteSelected","Delete selected"))),c.add(e._createInputButton(Nr+" "+ei,this.localizeString("templateDialogSaveCurrentPage","Save current page as template"))),t.add(c),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_ImageBrowser=function(){var e=this,t=a.createDiv(kr),n=a.createDiv(Lr),r=a.createDiv(Ar),i=a.createDiv(Or),s=a.createDiv(Mr),o=a.createDiv(_r);return r.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),Dr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageAltText","Image alt text:"),Pr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),Hr,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),Br,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogCssText","Css text:"),jr)),n.add(r),i.add(s),s.add(a.createElement("select",{size:8})),i.add(o),o.add(a.createElement("img",{src:"",alt:""})),n.add(i),n.add(e._createSeparator()),n.add(e._createOKCancelButtons()),t.add(n),t.render()},t.prototype._getDialogRes_link_address=function(){return this._createTextField(this.localizeString("hyperLinkDialogAddress","Address :"),ni)},t.prototype._getDialogRes_link_linkType_options=function(){return[{id:"radUrl",value:"url",text:this.localizeString("hyperLinkDialogUrl","url")},{id:"radAnchor",value:"anchor",checked:!0,text:this.localizeString("hyperLinkDialogAnchor","anchor")},{id:"radMail",value:"email",text:this.localizeString("hyperLinkDialogEmail","email")}]},t.prototype._getDialogRes_link_linkType=function(){var e=a.createDiv(ri+" ui-helper-clearfix"),t=a.createElement("div"),r=[],i;e.add(t),n.each(this._getDialogRes_link_linkType_options(),function(e,n){t.add(a.createRadio(n.id,"radioList",n.value)),t.add(a.createLabel(n.text,n.id))});for(i=1;i<8;i++)r.push("#anchor"+i.toString());return e.add(a.createSelect(ii,r)),e},t.prototype._getDialogRes_Link_linkIconType=function(){var e=a.createDiv(hi),t=a.createElement("div"),r=a.createSpan(Cr,this.localizeString("hyperLinkDialogIconType","Icon Type :")),i=[{id:"radLinkTypeIsText",value:"text",checked:!0,text:this.localizeString("hyperLinkDialogText","text")},{id:"radLinkTypeIsImage",value:"image",text:this.localizeString("hyperLinkDialogImage","image")}];return n.each(i,function(e,n){t.add(a.createRadio(n.id,"linkIconRadioList",n.value)),t.add(a.createLabel(n.text,n.id))}),e.add(t),t.add(r),e},t.prototype._getDialogRes_Link_text=function(){return this._createTextField(this.localizeString("hyperLinkDialogTextToDisplay","Text to display :"),si)},t.prototype._getDialogRes_Link_image=function(){var e=a.createDiv(ci);return e.add(this._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),ai)),e.add(this._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),fi,this.localizeString("dialogPixel","px"))),e.add(this._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),li,this.localizeString("dialogPixel","px"))),e},t.prototype._getDialogRes_link_target=function(){var e=a.createDiv(oi),t=a.createSpan(Cr,this.localizeString("hyperLinkDialogTarget","Target :")),n=[{text:"_blank",selected:!0},"_parent","_self","_top"],r=a.createSelect(oi,n);return e.add(t),e.add(r),e},t.prototype._getDialogRes_Link_Css=function(){return this._createTextField(this.localizeString("hyperLinkDialogCss","Css :"),ui)},t.prototype._getDialogRes_Link=function(){var e=this,t=a.createDiv(ti);return t.add(e._getDialogRes_link_address()),t.add(e._getDialogRes_link_linkType()),t.add(e._createSeparator()),t.add(e._getDialogRes_Link_linkIconType()),t.add(e._getDialogRes_Link_text()),t.add(e._getDialogRes_Link_image()),t.add(e._getDialogRes_link_target()),t.add(e._getDialogRes_Link_Css()),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_TagInspector=function(){var e=this,t=a.createDiv(mi),n=a.createDiv(gi),r=a.createDiv(wi),i=a.createDiv(Ei),s=a.createDiv(xi);return t.add(n),n.add(a.createSpan(yi,this.localizeString("tagInspectorDialogSelectedTag","Selected tag :"))),n.add(a.createSpan(bi,"")),t.add(r),r.add(a.createCheckbox("displayNoEmpty")),r.add(a.createLabel(this.localizeString("tagInspectorDialogDisplayNotEmptyAttributes","Display not empty attributes only"),"displayNoEmpty")),t.add(i),i.add(a.createSpan(Cr,this.localizeString("tagInspectorDialogAttributes","Attributes:"))),i.add(a.createDiv(Si)),t.add(s),s.add(a.createSpan(Cr,this.localizeString("tagInspectorDialogInnerHTML","Inner HTML:"))),s.add(a.createElement("textarea",{"aria-label":"Inner HTML"})),t.add(e._createTextField(this.localizeString("tagInspectorDialogCSSText","Css Text:"),Ti)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Color=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_ForeColor=function(){return this._getDialogRes_CommonColor("#000000")},t.prototype._getDialogRes_BackColor=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_CommonColor=function(e){var t=this,n=a.createDiv(Ni),r=a.createDiv(ki);return n.add(a.createDiv(Ci)),n.add(r),r.add(a.createSpan(Cr,this.localizeString("backColorDialogSelectedColor","Selected Color:"))),r.add(a.createElement("input",{type:"text",value:e,"aria-label":"Selected Color"})),n.add(t._createSeparator()),n.add(t._createOKCancelButtons()),n.render()},t.prototype._getDialogRes_Table=function(){var e=this,t=a.createDiv(Li),n=a.createDiv(ji);return t.add(e._createTextField(this.localizeString("tableDialogRows","Rows :"),Ai,"",3)),t.add(e._createTextField(this.localizeString("tableDialogColumns","Columns :"),Oi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogTableWidth","Table Width :"),Mi,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogTableHeight","Table Height :"),_i,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogBorder","Border thickness:"),Di)),t.add(e._createTextField(this.localizeString("tableDialogCellPadding","Cell Padding :"),Pi)),t.add(e._createTextField(this.localizeString("tableDialogCellSpacing","Cell Spacing :"),Hi)),t.add(e._createTextField(this.localizeString("tableDialogCssText","Css Text :"),Bi)),t.add(n),n.add(a.createSpan(Cr,this.localizeString("tableDialogBackgroundColor","Background Color:"))),n.add(a.createElement("input",{type:"text","aria-label":"Background Color"})),n.add(a.createElement("input",{type:"button",value:"..."})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Preview=function(){var e=this,t=a.createDiv(Fi),n=a.createDiv(Ii),r=a.createDiv(Tr),i=a.createDiv(qi),s=a.createDiv($i);return t.add(n),n.add(a.createSpan(Cr,this.localizeString("previewDialogPreviewSize","Preview Size:"))),n.add(a.createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"})),n.add(a.createLabel("640x480","rad640_480")),n.add(a.createElement("input",{id:"rad800_600",name:"preview",type:"radio"})),n.add(a.createLabel("800x600","rad800_600")),n.add(a.createElement("input",{id:"rad1024_768",name:"preview",type:"radio"})),n.add(a.createLabel("1024x768","rad1024_768")),n.add(a.createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"})),n.add(a.createLabel(this.localizeString("previewDialogSplit","Split pages"),"chkSplit")),t.add(e._createSeparator()),t.add(r),r.add(e._createInputButton(Nr+" "+zi,this.localizeString("previewDialogPrintAll","Print All"))),r.add(e._createInputButton(Nr+" "+Wi,this.localizeString("previewDialogPrintPage","Print Page"))),r.add(e._createInputButton(Nr+" "+Xi,this.localizeString("dialogOK","OK"))),t.add(e._createSeparator()),t.add(i),i.add(a.createElement("a",this.localizeString("previewDialogPrevPage","Prev page"),{"class":Ri,href:"#"})),i.add(a.createElement("span","1 / 1")),i.add(a.createElement("a",this.localizeString("previewDialogNextPage","Next page"),{"class":Ui,href:"#"})),t.add(a.createDiv(Vi)),t.add(s),s.add(a.createElement("iframe",{src:"about:blank"})),t.render()},t.prototype._getDialogRes_CleanUp=function(){var e=this,t=a.createDiv(Ji),r=a.createDiv(Ki),i=a.createDiv(Qi),s=a.createDiv(Gi),o=[{id:"replaceSpans",label:this.localizeString("cleanUpDialogStripSpanTag","Strip SPAN tag")},{id:"replaceClass",label:this.localizeString("cleanUpDialogStripClass","Strip CLASS tag")},{id:"replaceStyle",label:this.localizeString("cleanUpDialogStripStyle","Strip STYLE attribute")},{id:"replaceNbsp",label:this.localizeString("cleanUpDialogReplaceSymbol","Replace &amp;nbsp; symbol")},{id:"transformPtoDiv",label:this.localizeString("cleanUpDialogTransformParagraphToDIV","Transform Paragraph to DIV")}];return t.add(r),r.add(a.createSpan(Cr,this.localizeString("cleanUpDialogDocumentSource","Document source :"))),t.add(i),i.add(a.createElement("textarea",{readonly:"readonly","aria-label":"Document source"})),t.add(s),n.each(o,function(e,t){s.add(a.createCheckbox(t.id)),s.add(a.createLabel(t.label,t.id))}),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_FindAndReplace=function(){var e=this,t=a.createDiv(Yi),n=a.createDiv(Zi),r=a.createDiv(es),i=a.createDiv(Tr);return t.add(n),n.add(a.createSpan(Cr,this.localizeString("findAndReplaceDialogFind","Find:"))),n.add(a.createElement("textarea","text",{"aria-label":"Find"})),t.add(r),r.add(a.createSpan(Cr,this.localizeString("findAndReplaceDialogReplace","Replace:"))),r.add(a.createElement("textarea","",{"aria-label":"Replace"})),t.add(e._createSeparator()),t.add(i),i.add(e._createInputButton(Nr,this.localizeString("findAndReplaceDialogFindButton","Find"))),i.add(e._createInputButton(Nr,this.localizeString("findAndReplaceDialogReplaceButton","Replace"))),t.render()},t.prototype._getDialogRes_Media=function(){var e=this,t=a.createDiv(ts),n=a.createDiv(ns);return t.add(n),n.add(a.createSpan(Cr,this.localizeString("mediaDialogMediaType","Media Type :"))),n.add(a.createSelect("",["flash","video","applet","other"])),t.add(e._createTextField(this.localizeString("mediaDialogMediaUrl","Media Url :"),rs)),t.add(e._createTextField(this.localizeString("mediaDialogWidth","Width :"),is,this.localizeString("dialogPixel","px"),200)),t.add(e._createTextField(this.localizeString("mediaDialogHeight","Height :"),ss,this.localizeString("dialogPixel","px"),200)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_SpecialCharacter=function(){var e=this,t=a.createDiv(os),r=a.createDiv(us),i=a.createDiv(as),s=a.createDiv(fs),o=a.createDiv(ls),u=a.createDiv(cs,"Punctuation"),f=a.createDiv(hs),l=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],c=a.createDiv(cs,"Symbols"),h=a.createDiv(ps),p=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],d=a.createDiv(cs,"Diacritics"),v=a.createDiv(ds),m=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],g=a.createDiv(Tr);return t.add(r),r.add(i),i.add(s),s.add(a.createElement("span")),r.add(o),o.add(u),u.add(f),n.each(l,function(e,t){f.add(a.createLabel(t))}),o.add(c),c.add(h),n.each(p,function(e,t){h.add(a.createLabel(t))}),o.add(d),d.add(v),n.each(m,function(e,t){v.add(a.createLabel(t))}),t.add(e._createSeparator()),g.add(e._createInputButton(Nr,e.localizeString("dialogCancel","Cancel"))),t.add(g),t.render()},t.prototype._copyFromClipboard=function(){if(s.clipboardData)return s.clipboardData.getData("Text");i(this.localizeString("errorMessagePasteError","This function is not supported in current browser.  Plesse use (Ctrl + V)."))},t.prototype._copyToClipboard=function(e,t){var n=this,r=n._getDesignViewDocument();s.clipboardData&&e?s.clipboardData.setData("Text",e):t?i(n.localizeString("errorMessageCutError","This function is not supported in current browser. Plesse use (Ctrl + X).")):i(n.localizeString("errorMessageCopyError","This function is not supported in current browser. Plesse use (Ctrl + C)."))},t.prototype.fixAbsoluteUrlsIfNeeded=function(e){var t=this,n=o.URL,r=o.URL,i=o.URL,s=!1,u=r.length,a=e,f,l,c,h,p,d,v,m;for(v=u-1;v>0;v--){f=r.charAt(v),l=r.charAt(v-1);if(f==="/"||f==="\\"){if(f===l)break;i=r.substring(0,v)+f,s||(r=i,s=!0)}}return c=t._prepareLiteralRegexText(n+"?"),h=new RegExp(c,"g"),a=a.replace(h,"?"),p=t._prepareLiteralRegexText(r),h=new RegExp(p,"g"),a=a.replace(h,""),d=t._prepareLiteralRegexText(i),h=new RegExp(d,"g"),a=a.replace(h,"/"),m=a.indexOf("#"),m>-1&&(a=a.substr(m)),a},t.prototype._insertCell=function(e,t){var n=e.insertCell(t);return n.innerHTML="&nbsp;",n},t.prototype._getDictionaryDeclare=function(){var e={};return e.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"],e.b=["class","dir","id","lang","title"],e.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"],e.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"],e.code=["class","dir","id","lang","title"],e.div=["align","class","dir","id","lang","title"],e.em=["class","dir","id","lang","title"],e.font=["class","color","dir","face","id","lang","pointsize","size","title"],e.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"],e.hr=["align","class","color","id","noshade","size","title","width"],e.i=["class","dir","id","lang","title"],e.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"],e.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"],e.label=["accesskey","class","dir","for","id","lang","title"],e.li=["class","dir","id","lang","title","type","value"],e.ol=["class","compact","dir","id","lang","start","title","type"],e.option=["class","dir","disabled","id","label","lang","selected","title","value"],e.p=["align","class","dir","id","lang","title"],e.span=["class","dir","id","lang","title"],e.strong=["class","dir","id","lang","title"],e.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"],e.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"],e.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"],e.tbody=["align","bgColor","class","dir","id","lang","title","valign"],e.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"],e.u=["class","id","xml:lang"],e.ul=["class","compact","dir","id","lang","title","type"],e},t.prototype._generateUniqueName=function(e){var t=h[e];return t||(t=0),h[e]=++t,e+t},t.prototype._setContentEditable=function(e,t){var r="designMode",i="contentEditable";try{e.body[i]&&(e.body[i]=t.toString()),e[r]&&(!t&&e[r]!=="off"?e[r]="off":t&&e[r]!=="on"&&(n.browser.msie&&u(n.browser.version)>=9&&u(n.browser.version)<11||(e[r]="on"))),t&&!n.browser.msie&&e.execCommand("useCSS",!1,!0)}catch(s){}},t.prototype._setContentSpellCheck=function(e,t){var n="spellcheck";try{e.body[n]!==undefined&&(e.body[n]=t)}catch(r){}},t.prototype._formatString=function(e,t){var n=e.length,r;for(r=0;r<t-n;r++)e="0"+e;return e},t.prototype._convertToWebColor=function(e,t,n){var r=this,i,s,o,a;if(isNaN(e)||255-e<0)e=0;if(isNaN(t)||255-t<0)t=0;if(isNaN(n)||255-n<0)n=0;return i=r._formatString(u(e).toString(16),2),s=r._formatString(u(t).toString(16),2),o=r._formatString(u(n).toString(16),2),a="#"+i+s+o,a},t.prototype._prepareLiteralRegexText=function(e){var t=e;return t=t.replace(/\\/g,"\\\\"),t=t.replace(/\./g,"\\."),t=t.replace(/\?/g,"\\?"),t},t.prototype._isNumeric=function(e){return(new RegExp("^\\d+$")).test(e)},t.prototype._isEmail=function(e){return(new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+")).test(e)},t.prototype._isUrl=function(e){return(new RegExp("[a-zA-z]+://[^s]+")).test(e)},t.prototype._isAnchor=function(e){return(new RegExp("#[^s]+")).test(e)?!0:(new RegExp("[a-zA-z]+://[^s]+#[^s]+")).test(e)?!0:!1},t.prototype.refresh=function(){var e=this,t=e._getDesignViewDocument(),n=e.element,r=e._getHeader(),i=e._getFooter(),s=r.outerHeight(!0),o=i.outerHeight(!0),u=e._oriEleWidth,a=e._oriEleHeight,f=e._getContent(),l;e.editor.width(u).height(a),this.$ribbon.wijribbon("updateRibbonSize"),window.setTimeout(function(){e.editor.is(":visible")&&(s=r.outerHeight(!0),o=i.outerHeight(!0)),l=e.editor.height()-s-o,f.height(l),f.data("wijmo-wijsplitter")&&(e.options.editorMode==="split"?f.wijsplitter("option","splitterDistance",l/2):f.wijsplitter("refresh"))},0),e._updateContentEditable()},t.prototype.getText=function(){var e=this;return e._getDesignViewText()},t.prototype.setText=function(e){var t=this;e&&(t._setDesignViewText(e),t.sourceView.val(e))},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t.prototype._getParentElement=function(e){var t=this,n=t._getRange(e),r,i,s,o,u;if(!n)return null;if(n.commonAncestorContainer)return r=e.getSelection(),i=n.startContainer||r.baseNode,s=n.endContainer||r.extentNode,o=n.startOffset,o===null&&(o=r.baseOffset),u=n.endOffset,u===null&&(u=r.extentOffset),i===s&&u-o===1?r.anchorNode.childNodes[r.anchorOffset]:n.commonAncestorContainer.tagName?n.commonAncestorContainer:e.document===n.commonAncestorContainer&&r.baseNode?r.baseNode.parentNode:n.commonAncestorContainer.parentNode;return n.length?n.item(0):n.parentElement?n.parentElement():null},t.prototype._getRange=function(e){var t,n;if(e.document.selection&&!s.opera)return e.document.selection.createRange();if(e.getSelection)return t=e.getSelection(),!t||t.rangeCount<1?null:(t.getRangeAt?n=t.getRangeAt(0):n=e.document.createRange(),n)},t.prototype._getInspectElement=function(){return g||this._getSelectedElement()},t.prototype._getSelectedElement=function(){return this._getParentElement(this._getDesignViewWindow())},t.prototype._checkSelectionIncludeNodeForIE11AndChrome=function(e,t,n){var r=e.document,i;if(t){i=r.createRange(),i.selectNode(n);if(t.compareBoundaryPoints(Range.START_TO_END,i)<=0||t.compareBoundaryPoints(Range.END_TO_START,i)>=0)return!1}return!0},t.prototype._checkSelectionIncludeNodeExceptIE11=function(e,t,n){var r=e.document,i=r.selection.createRange(),s="compareEndPoints";if(t){i.moveToElementText(n);if(t.inRange(i)||t[s]("StartToStart",i)>=0&&t[s]("StartToEnd",i)<=0||t[s]("EndToStart",i)>=0&&t[s]("EndToEnd",i)<=0)return!0}return!1},t.prototype._getIESelectionRange=function(){var e=this,t=this._getDesignViewWindow(),n=t.document,r,i;return e._isIE11?(r=t.getSelection(),r&&r.rangeCount>0&&(i=r.getRangeAt(0))):i=n.selection.createRange(),i},t.prototype._setIESelection=function(e,t){var r;if(!n.browser.msie)return;!e&&!t&&(e=this.rangeSelection);if(e)try{r=this._getDesignViewDocument(),this._isIE11&&r.getSelection?r.getSelection().addRange(e):e.select()}catch(i){r.body.focus()}},t.prototype._getSelectedContent=function(e){var t=this._getDesignViewWindow(),r=t.document,i="",s="cloneContents",o,u,a;return r.selection?(o=r.selection.createRange(),e?o.text:o.htmlText):(o=t.getSelection().getRangeAt(0),o&&o[s]&&(u=o[s](),a=document.createElement("div"),a.appendChild(u),i=e?n(a).text():a.innerHTML,a=null),i||"")},t.prototype._getHtmlTextInIE=function(e){if(!n.browser.msie||!e)return"";var t="",r;return this._isIE11&&e.getSelection?(r=e.getSelection(),t=r.getRangeAt&&r.rangeCount?r.getRangeAt(0).toString():""):t=e.selection.createRange().htmlText,t},t.prototype._saveSelectionForIE=function(){var e=this._getDesignViewWindow().document,t,r,i;if(!n.browser.msie)return;if(this._isIE11&&e.getSelection){t=e.getSelection(),this.rangeSelection=t.getRangeAt&&t.rangeCount?t.getRangeAt(0):null;return}t=e.selection,i=t.createRange();if(n.browser.version&&parseFloat(n.browser.version)>=9&&parseFloat(n.browser.version)<=10&&i.parentElement){r=i.parentElement();if(r&&r.tagName=="INPUT"&&r.type=="hidden")return}this.rangeSelection=i},t.prototype._storeSelectionForIE=function(){var e=this._getDesignViewWindow().document,t,r,i,s;if(!n.browser.msie)return;e.selection?(t=e.selection.createRange(),t.getBookmark&&(this.bookmark=t.getBookmark())):e.getSelection&&e.getSelection().rangeCount&&(t=e.getSelection().getRangeAt(0),r=t.cloneRange(),r.selectNode(e.body),r.setEnd(t.startContainer,t.startOffset),i=r.toString().length,t.startContainer.nodeType===3?s=t.startContainer.nodeValue:s=t.startContainer.innerHTML,this.bookmark={startContainerText:s,start:i,end:i+t.toString().length})},t.prototype._restoreSelectionForIE=function(e){var t=this,r=this._getDesignViewWindow(),i=r.document,s=!1,o,u=0,a,f,l,c,h,p,d,v,m,g,y,b,w;if(!this.bookmark||!n.browser.msie)return;if(i.selection)e?o=setInterval(function(){u++,u>5||a?(f.select(),t.bookmark=null,clearInterval(o)):(f=i.body.createTextRange(),a=f.moveToBookmark(t.bookmark))},50):(f=i.body.createTextRange(),f.moveToBookmark(this.bookmark)&&f.select(),this.bookmark=null);else if(i.getSelection){l=this.bookmark.start,y=this.bookmark.end,c=this.bookmark.startContainerText,f=i.createRange(),f.setStart(i.body,0),h=[i.body],v=0;while(!p&&(d=h.pop()))if(d.nodeType==3)m=v+d.length,!g&&(s||d.nodeValue===c)&&l>=v&&l<=m&&(f.setStart(d,l-v),g=!0),g&&y>=v&&y<=m&&(f.setEnd(d,y-v),p=!0),v=m;else{d.innerHTML===c&&(s=!0),w=d.childNodes.length;while(w--)h.push(d.childNodes[w])}b=r.getSelection(),b.removeAllRanges(),b.addRange(f),this.rangeSelection=null,this.bookmark=null}},t.prototype._setSelection=function(e,t,r){var i=this._getDesignViewWindow(),s=i.document,o,u,a,f,l=0;try{window.getSelection?(f=i.getSelection(),o=s.createRange(),u=e[0][0],a=e[e.length-1][0],o.setStart(u,0),o.setEnd(a,a.childNodes.length),f.removeAllRanges(),f.addRange(o)):(o=s.selection.createRange(),e?(n.each(e,function(e,t){l+=t.text().length}),o.moveToElementText(e[0][0]),o.collapse(!0),o.moveEnd("character",l)):(o.moveStart("textedit",-1),o.collapse(!0),o.moveStart("character",t),o.moveEnd("character",r)),o.select())}catch(c){}},t.prototype._getHyperLinkElement=function(e){while(e&&e.tagName!=="A"){if(e.tagName==="BODY"||e.tagName==="HTML")break;e=e.parentElement}return e},t}(e.wijmoWidget);t.wijeditor=ks;var Ls=function(){function e(){this.initSelector=":jqmData(role='wijeditor')",this.fullScreenContainerSelector="",this.compactRibbonMode=!1,this.editorMode="wysiwyg",this.fullScreenMode=!1,this.fontSizes=[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],this.fontNames=[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],this.showPathSelector=!0,this.mode="ribbon",this.commandButtonClick=null,this.simpleModeCommands=null,this.showFooter=!0,this.customContextMenu=!0,this.text=null,this.textChanged=null,this.localization=null,this.readOnly=!1}return e}();ks.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new Ls),ks.prototype.options.tableVirtualBorderShowing=!0,n.wijmo.registerWidget("wijeditor",ks.prototype);var As=vr+"-colorcanvas",Os=vr+"-color",Ms=vr+"-wheel",_s=vr+"-overlay",Ds=vr+"-marker";n.fn.wijeditorcolorcanvas=function(e,t){var n=this.get(0);return n.wijeditorcolorcanvas||(n.wijeditorcolorcanvas=new Ps(n,e,t))};var Ps=function(){function e(e,t,r){var i=this,s="",a,f;f="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ",s+="<div class='"+As+"'>",s+="<div class='"+Os+"'></div>",s+="<div class='"+Ms+"'></div>",s+="<div class='"+_s+"'></div>",s+="<div class='h-marker "+Ds+"'></div>",s+="<div class='sl-marker "+Ds+"'></div></div>",n(e).html(s),a=n("."+As,e),i.wheel=n("."+Ms,e).get(0),i.radius=84,i.square=100,i.width=194,n.browser.msie&&parseInt(n.browser.version,10)<7&&n("*",a).each(function(){var e=this,t=e.currentStyle.backgroundImage;return t!=="none"&&(t=t.substring(5,t.length-2),n(e).css({backgroundImage:"none",filter:f+"src='"+t+"')"})),this}),i.linkTo=function(e){typeof i.callback=="object"&&n(i.callback).unbind("keyup",i.updateValue),i.color=null;if(typeof e=="function")i.callback=e;else if(typeof e=="object"||typeof e=="string")i.callback=n(e),i.callback.bind("keyup",i.updateValue),i.callback.get(0).value&&i.setColor(i.callback.get(0).value);return this},i.updateValue=function(e){var t=this;t.value&&t.value!==i.color&&i.setColor(t.value)},i.setColor=function(e){var t=i.unpack(e);return i.color!==e&&t&&(i.color=e,i.rgb=t,i.hsl=i.RGBToHSL(i.rgb),i.updateDisplay()),this},i.setHSL=function(e){return i.hsl=e,i.rgb=i.HSLToRGB(e),i.color=i.pack(i.rgb),i.updateDisplay(),this},i.widgetCoords=function(e){var t,r,s,o,u;return s=e.target||e.srcElement,o=i.wheel,u=i.absolutePosition(o),t=(e.pageX||0*(e.clientX+n("html").get(0).scrollLeft))-u.x,r=(e.pageY||0*(e.clientY+n("html").get(0).scrollTop))-u.y,{x:t-i.width/2,y:r-i.width/2}},i.mousedown=function(e){o.dragging||(n(o).bind("mousemove",i.mousemove).bind("mouseup",i.mouseup),o.dragging=!0);var t=i.widgetCoords(e);return i.circleDrag=Math.max(Math.abs(t.x),Math.abs(t.y))*2>i.square,i.mousemove(e),!1},i.mousemove=function(e){var t=i.widgetCoords(e),n,r,s;return i.circleDrag?(n=Math.atan2(t.x,-t.y)/6.28,n<0&&(n+=1),i.setHSL([n,i.hsl[1],i.hsl[2]])):(r=Math.max(0,Math.min(1,-(t.x/i.square)+.5)),s=Math.max(0,Math.min(1,-(t.y/i.square)+.5)),i.setHSL([i.hsl[0],r,s])),!1},i.mouseup=function(){n(o).unbind("mousemove",i.mousemove).unbind("mouseup",i.mouseup),o.dragging=!1},i.updateDisplay=function(){var e=i.hsl[0]*6.28,t;n(".h-marker",a).css({left:Math.round(Math.sin(e)*i.radius+i.width/2)+"px",top:Math.round(-Math.cos(e)*i.radius+i.width/2)+"px"}),n(".sl-marker",a).css({left:Math.round(i.square*(.5-i.hsl[1])+i.width/2)+"px",top:Math.round(i.square*(.5-i.hsl[2])+i.width/2)+"px"}),n("."+Os,a).css("backgroundColor",i.pack(i.HSLToRGB([i.hsl[0],1,.5]))),typeof i.callback=="object"?(n(i.callback).css({backgroundColor:i.color,color:i.hsl[2]>.5?"#000":"#fff"}),n(i.callback).each(function(){return t=this,t.value&&t.value!==i.color&&(t.value=i.color),this})):typeof i.callback=="function"&&i.callback.call(i,i.color)},i.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop},n;return e.offsetParent&&(n=i.absolutePosition(e.offsetParent),t.x+=n.x,t.y+=n.y),t},i.pack=function(e){var t=Math.round(e[0]*255),n,r;return n=Math.round(e[1]*255),r=Math.round(e[2]*255),"#"+(t<16?"0":"")+t.toString(16)+(n<16?"0":"")+n.toString(16)+(r<16?"0":"")+r.toString(16)},i.unpack=function(e){if(e.length===7)return[u("0x"+e.substring(1,3))/255,u("0x"+e.substring(3,5))/255,u("0x"+e.substring(5,7))/255];if(e.length===4)return[u("0x"+e.substring(1,2))/15,u("0x"+e.substring(2,3))/15,u("0x"+e.substring(3,4))/15]},i.HSLToRGB=function(e){var t,n,r,i,s,o=this;return r=e[0],i=e[1],s=e[2],n=s<=.5?s*(i+1):s+i-s*i,t=s*2-n,[o.hueToRGB(t,n,r+.33333),o.hueToRGB(t,n,r),o.hueToRGB(t,n,r-.33333)]},i.hueToRGB=function(e,t,n){return n=n<0?n+1:n>1?n-1:n,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(.66666-n)*6:e},i.RGBToHSL=function(e){var t,n,r,i,s,o,u,a,f;return u=e[0],a=e[1],f=e[2],t=Math.min(u,Math.min(a,f)),n=Math.max(u,Math.max(a,f)),r=n-t,o=(t+n)/2,s=0,o>0&&o<1&&(s=r/(o<.5?2*o:2-2*o)),i=0,r>0&&(n===u&&n!==a&&(i+=(a-f)/r),n===a&&n!==f&&(i+=2+(f-u)/r),n===f&&n!==u&&(i+=4+(u-a)/r),i/=6),[i,s,o]},n("*",a).mousedown(i.mousedown),i.setColor(r||"#000000"),t&&i.linkTo(t)}return e}();t._wijeditorcolorcanvas=Ps})(e.editor||(e.editor={}));var t=e.editor})(wijmo||(wijmo={}));